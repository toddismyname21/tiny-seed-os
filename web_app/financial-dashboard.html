<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tiny Seed Financial Command Center</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="auth-guard.js" data-required-role="Admin"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.plaid.com/link/v2/stable/link-initialize.js"></script>
    <style>
        :root {
            --primary: #2d5a27;
            --primary-light: #4a7c43;
            --primary-dark: #1e3d1a;
            --secondary: #f4a261;
            --accent: #e76f51;
            --success: #2a9d8f;
            --warning: #e9c46a;
            --danger: #e63946;
            --info: #4361ee;
            --bg-dark: #1a1a2e;
            --bg-card: #16213e;
            --bg-light: #0f3460;
            --text-primary: #edf2f4;
            --text-secondary: #8d99ae;
            --border: rgba(255,255,255,0.1);
            --gold: #ffd700;
            --purple: #9b59b6;
            --teal: #1abc9c;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, #0f0f1a 100%);
            color: var(--text-primary);
            min-height: 100vh;
        }

        /* ============================================= */
        /* NAVIGATION */
        /* ============================================= */
        .top-nav {
            background: rgba(22, 33, 62, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border);
            padding: 0.75rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-brand {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .nav-logo {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--success) 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
        }

        .nav-title {
            font-size: 1.25rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary-light) 0%, var(--success) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .nav-subtitle {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .nav-status {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.85rem;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .status-dot.connected { background: var(--success); }
        .status-dot.warning { background: var(--warning); }
        .status-dot.danger { background: var(--danger); }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* ============================================= */
        /* TAB NAVIGATION */
        /* ============================================= */
        .tab-nav {
            background: var(--bg-card);
            border-bottom: 1px solid var(--border);
            display: flex;
            gap: 0;
            padding: 0 2rem;
            overflow-x: auto;
        }

        .tab-btn {
            padding: 1rem 1.5rem;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            border-bottom: 3px solid transparent;
            transition: all 0.2s;
            white-space: nowrap;
        }

        .tab-btn:hover {
            color: var(--text-primary);
            background: rgba(255,255,255,0.03);
        }

        .tab-btn.active {
            color: var(--primary-light);
            border-bottom-color: var(--primary-light);
        }

        .tab-btn .badge {
            padding: 0.15rem 0.5rem;
            border-radius: 10px;
            font-size: 0.7rem;
            font-weight: 600;
        }

        .tab-btn .badge.danger { background: var(--danger); color: white; }
        .tab-btn .badge.warning { background: var(--warning); color: #000; }
        .tab-btn .badge.success { background: var(--success); color: white; }

        /* ============================================= */
        /* MAIN CONTENT */
        /* ============================================= */
        .main-content {
            padding: 2rem;
            max-width: 1800px;
            margin: 0 auto;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* ============================================= */
        /* CARDS */
        /* ============================================= */
        .card {
            background: var(--bg-card);
            border-radius: 16px;
            border: 1px solid var(--border);
            overflow: hidden;
            margin-bottom: 1.5rem;
        }

        .card-header {
            padding: 1.25rem 1.5rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-header h3 {
            font-size: 1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .card-header h3 i {
            color: var(--primary-light);
        }

        .card-body {
            padding: 1.5rem;
        }

        /* ============================================= */
        /* STATS GRID */
        /* ============================================= */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 1.5rem;
            border: 1px solid var(--border);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }

        .stat-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .stat-icon {
            width: 45px;
            height: 45px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
        }

        .stat-icon.green { background: rgba(42, 157, 143, 0.2); color: var(--success); }
        .stat-icon.blue { background: rgba(67, 97, 238, 0.2); color: var(--info); }
        .stat-icon.gold { background: rgba(255, 215, 0, 0.2); color: var(--gold); }
        .stat-icon.orange { background: rgba(244, 162, 97, 0.2); color: var(--secondary); }
        .stat-icon.red { background: rgba(230, 57, 70, 0.2); color: var(--danger); }
        .stat-icon.purple { background: rgba(155, 89, 182, 0.2); color: var(--purple); }
        .stat-icon.teal { background: rgba(26, 188, 156, 0.2); color: var(--teal); }

        .stat-value {
            font-size: 1.75rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.85rem;
            margin-bottom: 0.5rem;
        }

        .stat-change {
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .stat-change.positive { color: var(--success); }
        .stat-change.negative { color: var(--danger); }
        .stat-change.neutral { color: var(--text-secondary); }

        /* ============================================= */
        /* BUTTONS */
        /* ============================================= */
        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(45, 90, 39, 0.4);
        }

        .btn-secondary {
            background: rgba(255,255,255,0.1);
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            background: rgba(255,255,255,0.15);
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--danger) 0%, #c0392b 100%);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success) 0%, #27ae60 100%);
            color: white;
        }

        .btn-sm {
            padding: 0.5rem 1rem;
            font-size: 0.8rem;
        }

        /* ============================================= */
        /* TABLES */
        /* ============================================= */
        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th,
        .data-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        .data-table th {
            color: var(--text-secondary);
            font-weight: 500;
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .data-table tr:hover {
            background: rgba(255,255,255,0.03);
        }

        /* ============================================= */
        /* FORMS */
        /* ============================================= */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            font-size: 0.9rem;
        }

        .form-input {
            width: 100%;
            padding: 0.75rem 1rem;
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 0.9rem;
            transition: border-color 0.2s;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-light);
        }

        .form-input::placeholder {
            color: var(--text-secondary);
        }

        select.form-input {
            cursor: pointer;
        }

        /* ============================================= */
        /* PROGRESS BARS */
        /* ============================================= */
        .progress-container {
            margin-top: 1rem;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            font-size: 0.85rem;
        }

        .progress-bar {
            height: 12px;
            background: rgba(255,255,255,0.1);
            border-radius: 6px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            border-radius: 6px;
            transition: width 0.5s ease;
        }

        .progress-fill.success { background: linear-gradient(90deg, var(--success), var(--teal)); }
        .progress-fill.warning { background: linear-gradient(90deg, var(--warning), var(--secondary)); }
        .progress-fill.danger { background: linear-gradient(90deg, var(--danger), var(--accent)); }
        .progress-fill.info { background: linear-gradient(90deg, var(--info), var(--purple)); }

        /* ============================================= */
        /* MODALS */
        /* ============================================= */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: var(--bg-card);
            border-radius: 16px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow: hidden;
            border: 1px solid var(--border);
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h2 {
            font-size: 1.25rem;
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 1.5rem;
            cursor: pointer;
        }

        .modal-body {
            padding: 1.5rem;
            max-height: 60vh;
            overflow-y: auto;
        }

        .modal-footer {
            padding: 1.5rem;
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
        }

        /* ============================================= */
        /* TWO COLUMN LAYOUT */
        /* ============================================= */
        .two-col {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 1.5rem;
        }

        @media (max-width: 1200px) {
            .two-col {
                grid-template-columns: 1fr;
            }
        }

        .three-col {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
        }

        @media (max-width: 1000px) {
            .three-col {
                grid-template-columns: 1fr;
            }
        }

        /* ============================================= */
        /* DEBT DESTROYER SPECIFIC */
        /* ============================================= */
        .debt-card {
            background: linear-gradient(135deg, rgba(230, 57, 70, 0.1) 0%, rgba(22, 33, 62, 1) 100%);
            border-left: 4px solid var(--danger);
        }

        .debt-strategy-selector {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .strategy-option {
            padding: 1.5rem;
            background: rgba(255,255,255,0.03);
            border: 2px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }

        .strategy-option:hover {
            border-color: var(--primary-light);
        }

        .strategy-option.active {
            border-color: var(--primary-light);
            background: rgba(45, 90, 39, 0.1);
        }

        .strategy-option h4 {
            margin-bottom: 0.5rem;
        }

        .strategy-option p {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .payoff-timeline {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .timeline-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: rgba(255,255,255,0.03);
            border-radius: 8px;
            position: relative;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: 1.5rem;
            top: 100%;
            width: 2px;
            height: 1rem;
            background: var(--border);
        }

        .timeline-item:last-child::before {
            display: none;
        }

        .timeline-number {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.9rem;
            flex-shrink: 0;
        }

        .timeline-content {
            flex: 1;
        }

        .timeline-date {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        /* ============================================= */
        /* GAMIFICATION */
        /* ============================================= */
        .achievement-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 1rem;
        }

        .achievement {
            padding: 1.5rem;
            background: rgba(255,255,255,0.03);
            border-radius: 12px;
            text-align: center;
            border: 2px solid transparent;
            transition: all 0.2s;
        }

        .achievement.unlocked {
            border-color: var(--gold);
            background: rgba(255, 215, 0, 0.1);
        }

        .achievement.locked {
            opacity: 0.5;
            filter: grayscale(1);
        }

        .achievement-icon {
            font-size: 2.5rem;
            margin-bottom: 0.75rem;
        }

        .achievement-name {
            font-weight: 600;
            font-size: 0.9rem;
            margin-bottom: 0.25rem;
        }

        .achievement-desc {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .level-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: linear-gradient(135deg, var(--gold) 0%, var(--secondary) 100%);
            color: #000;
            border-radius: 25px;
            font-weight: 700;
            font-size: 0.9rem;
        }

        .xp-bar {
            margin-top: 1rem;
        }

        .xp-bar .progress-bar {
            height: 8px;
            background: rgba(255, 215, 0, 0.2);
        }

        .xp-bar .progress-fill {
            background: linear-gradient(90deg, var(--gold), var(--secondary));
        }

        /* ============================================= */
        /* ROUND-UPS */
        /* ============================================= */
        .roundup-animation {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            padding: 2rem;
            background: linear-gradient(135deg, rgba(42, 157, 143, 0.1) 0%, var(--bg-card) 100%);
            border-radius: 12px;
            margin-bottom: 1.5rem;
        }

        .coin {
            font-size: 3rem;
            animation: bounce 1s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .roundup-total {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--success);
        }

        /* ============================================= */
        /* UPLOAD AREA */
        /* ============================================= */
        .upload-area {
            border: 2px dashed var(--border);
            border-radius: 12px;
            padding: 3rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .upload-area:hover {
            border-color: var(--primary-light);
            background: rgba(45, 90, 39, 0.05);
        }

        .upload-area i {
            font-size: 3rem;
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }

        .upload-area p {
            color: var(--text-secondary);
        }

        /* ============================================= */
        /* BANK ACCOUNT CARDS */
        /* ============================================= */
        .account-card {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1.25rem;
            background: rgba(255,255,255,0.03);
            border-radius: 12px;
            margin-bottom: 1rem;
            border-left: 4px solid var(--info);
        }

        .account-card.checking { border-left-color: var(--info); }
        .account-card.savings { border-left-color: var(--success); }
        .account-card.credit { border-left-color: var(--danger); }
        .account-card.investment { border-left-color: var(--gold); }

        .account-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            background: rgba(255,255,255,0.05);
        }

        .account-info {
            flex: 1;
        }

        .account-name {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .account-type {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .account-balance {
            text-align: right;
        }

        .account-balance .amount {
            font-size: 1.25rem;
            font-weight: 700;
        }

        .account-balance .label {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        /* ============================================= */
        /* ALERTS */
        /* ============================================= */
        .alert {
            padding: 1rem 1.5rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            display: flex;
            align-items: flex-start;
            gap: 1rem;
        }

        .alert-success {
            background: rgba(42, 157, 143, 0.1);
            border: 1px solid var(--success);
        }

        .alert-warning {
            background: rgba(233, 196, 106, 0.1);
            border: 1px solid var(--warning);
        }

        .alert-danger {
            background: rgba(230, 57, 70, 0.1);
            border: 1px solid var(--danger);
        }

        .alert-info {
            background: rgba(67, 97, 238, 0.1);
            border: 1px solid var(--info);
        }

        /* ============================================= */
        /* LOADING SPINNER */
        /* ============================================= */
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid var(--border);
            border-top-color: var(--primary-light);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ============================================= */
        /* NET WORTH BREAKDOWN */
        /* ============================================= */
        .net-worth-display {
            text-align: center;
            padding: 2rem;
            background: linear-gradient(135deg, rgba(42, 157, 143, 0.1) 0%, var(--bg-card) 100%);
            border-radius: 16px;
            margin-bottom: 2rem;
        }

        .net-worth-amount {
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
        }

        .net-worth-amount.positive { color: var(--success); }
        .net-worth-amount.negative { color: var(--danger); }

        .net-worth-label {
            font-size: 1rem;
            color: var(--text-secondary);
        }

        .net-worth-breakdown {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
            margin-top: 2rem;
        }

        @media (max-width: 800px) {
            .net-worth-breakdown {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .breakdown-item {
            padding: 1rem;
            background: rgba(255,255,255,0.03);
            border-radius: 8px;
        }

        .breakdown-item .label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-bottom: 0.25rem;
        }

        .breakdown-item .value {
            font-size: 1.25rem;
            font-weight: 700;
        }

        .breakdown-item .value.positive { color: var(--success); }
        .breakdown-item .value.negative { color: var(--danger); }
    </style>
</head>
<body>
    <!-- TOP NAVIGATION -->
    <nav class="top-nav">
        <div class="nav-brand">
            <div class="nav-logo">
                <i class="fas fa-seedling"></i>
            </div>
            <div>
                <div class="nav-title">Tiny Seed Financial Command Center</div>
                <div class="nav-subtitle">Wealth Builder & Debt Destroyer</div>
            </div>
        </div>
        <div class="nav-status">
            <div class="status-item">
                <div class="status-dot connected"></div>
                <span>Google Sheets Connected</span>
            </div>
            <div class="status-item">
                <div class="status-dot connected"></div>
                <span>Last Sync: Just now</span>
            </div>
            <button class="btn btn-secondary btn-sm" onclick="syncData()">
                <i class="fas fa-sync-alt"></i> Sync
            </button>
        </div>
    </nav>

    <!-- TAB NAVIGATION -->
    <nav class="tab-nav">
        <button class="tab-btn active" onclick="showTab('overview')">
            <i class="fas fa-chart-pie"></i> Overview
        </button>
        <button class="tab-btn" onclick="showTab('debt')">
            <i class="fas fa-fire"></i> Debt Destroyer
            <span class="badge danger" id="debt-count">5</span>
        </button>
        <button class="tab-btn" onclick="showTab('banking')">
            <i class="fas fa-university"></i> Banking & Bills
        </button>
        <button class="tab-btn" onclick="showTab('investments')">
            <i class="fas fa-chart-line"></i> Investments
        </button>
        <button class="tab-btn" onclick="showTab('roundups')">
            <i class="fas fa-coins"></i> Change Investing
            <span class="badge success">+$47</span>
        </button>
        <button class="tab-btn" onclick="showTab('employees')">
            <i class="fas fa-users"></i> Team & Retirement
        </button>
        <button class="tab-btn" onclick="showTab('settings')">
            <i class="fas fa-cog"></i> Settings
        </button>
        <button class="tab-btn" onclick="showTab('marketing')">
            <i class="fas fa-bullhorn"></i> Marketing
        </button>
    </nav>

    <!-- MAIN CONTENT -->
    <main class="main-content">
        <!-- ============================================= -->
        <!-- OVERVIEW TAB -->
        <!-- ============================================= -->
        <div id="tab-overview" class="tab-content active">
            <!-- Net Worth Display -->
            <div class="net-worth-display">
                <div class="net-worth-amount positive" id="total-net-worth">$127,450</div>
                <div class="net-worth-label">Total Net Worth</div>
                <div class="net-worth-breakdown">
                    <div class="breakdown-item">
                        <div class="label">Total Assets</div>
                        <div class="value positive" id="total-assets">$189,200</div>
                    </div>
                    <div class="breakdown-item">
                        <div class="label">Total Debt</div>
                        <div class="value negative" id="total-debt">-$61,750</div>
                    </div>
                    <div class="breakdown-item">
                        <div class="label">Monthly Income</div>
                        <div class="value positive" id="monthly-income">$12,400</div>
                    </div>
                    <div class="breakdown-item">
                        <div class="label">Monthly Expenses</div>
                        <div class="value negative" id="monthly-expenses">-$8,200</div>
                    </div>
                </div>
            </div>

            <!-- Quick Stats -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-card-header">
                        <div>
                            <div class="stat-label">Emergency Fund</div>
                            <div class="stat-value" id="emergency-fund">$24,600</div>
                        </div>
                        <div class="stat-icon green">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                    </div>
                    <div class="progress-container">
                        <div class="progress-header">
                            <span>3.0 months covered</span>
                            <span>Goal: 6 months</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill warning" style="width: 50%"></div>
                        </div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-card-header">
                        <div>
                            <div class="stat-label">Investment Portfolio</div>
                            <div class="stat-value" id="investment-total">$47,250</div>
                        </div>
                        <div class="stat-icon gold">
                            <i class="fas fa-chart-line"></i>
                        </div>
                    </div>
                    <div class="stat-change positive">
                        <i class="fas fa-arrow-up"></i>
                        <span>+5.2% this year</span>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-card-header">
                        <div>
                            <div class="stat-label">Total Debt Remaining</div>
                            <div class="stat-value" id="debt-remaining">$61,750</div>
                        </div>
                        <div class="stat-icon red">
                            <i class="fas fa-fire"></i>
                        </div>
                    </div>
                    <div class="stat-change positive">
                        <i class="fas fa-arrow-down"></i>
                        <span>-$2,340 this month</span>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-card-header">
                        <div>
                            <div class="stat-label">Round-Up Savings</div>
                            <div class="stat-value" id="roundup-total">$1,247</div>
                        </div>
                        <div class="stat-icon teal">
                            <i class="fas fa-coins"></i>
                        </div>
                    </div>
                    <div class="stat-change positive">
                        <i class="fas fa-plus"></i>
                        <span>+$47 this week</span>
                    </div>
                </div>
            </div>

            <!-- Action Items -->
            <div class="two-col">
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-tasks"></i> Priority Actions</h3>
                        <span style="color: var(--text-secondary); font-size: 0.85rem;">This Month</span>
                    </div>
                    <div class="card-body">
                        <div class="alert alert-danger">
                            <i class="fas fa-exclamation-circle" style="color: var(--danger);"></i>
                            <div>
                                <strong>High Priority:</strong> Pay Chase Visa minimum ($245) by Jan 20
                            </div>
                        </div>
                        <div class="alert alert-warning">
                            <i class="fas fa-exclamation-triangle" style="color: var(--warning);"></i>
                            <div>
                                <strong>Due Soon:</strong> Capital One extra payment ($500) scheduled for Jan 22
                            </div>
                        </div>
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle" style="color: var(--info);"></i>
                            <div>
                                <strong>Investment:</strong> Monthly contribution of $1,500 ready to allocate
                            </div>
                        </div>
                        <div class="alert alert-success">
                            <i class="fas fa-check-circle" style="color: var(--success);"></i>
                            <div>
                                <strong>Milestone:</strong> You'll pay off Discover card in 2 months!
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-chart-area"></i> Financial Health Score</h3>
                    </div>
                    <div class="card-body" style="text-align: center;">
                        <div style="font-size: 4rem; font-weight: 800; color: var(--success);">72</div>
                        <div style="font-size: 1rem; color: var(--text-secondary); margin-bottom: 1.5rem;">Good - Room to Grow</div>
                        <canvas id="healthChart" height="150"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- ============================================= -->
        <!-- DEBT DESTROYER TAB -->
        <!-- ============================================= -->
        <div id="tab-debt" class="tab-content">
            <div class="stats-grid">
                <div class="stat-card debt-card">
                    <div class="stat-card-header">
                        <div>
                            <div class="stat-label">Total Debt</div>
                            <div class="stat-value" style="color: var(--danger);">$61,750</div>
                        </div>
                        <div class="stat-icon red">
                            <i class="fas fa-fire"></i>
                        </div>
                    </div>
                    <div class="stat-change positive">
                        <i class="fas fa-arrow-down"></i>
                        <span>Down $12,430 from start</span>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-card-header">
                        <div>
                            <div class="stat-label">Monthly Debt Payment</div>
                            <div class="stat-value">$2,340</div>
                        </div>
                        <div class="stat-icon orange">
                            <i class="fas fa-calendar-check"></i>
                        </div>
                    </div>
                    <div class="stat-change neutral">
                        <span>Extra $500 available</span>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-card-header">
                        <div>
                            <div class="stat-label">Interest This Month</div>
                            <div class="stat-value" style="color: var(--warning);">$892</div>
                        </div>
                        <div class="stat-icon gold">
                            <i class="fas fa-percentage"></i>
                        </div>
                    </div>
                    <div class="stat-change positive">
                        <i class="fas fa-arrow-down"></i>
                        <span>Down $34 from last month</span>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-card-header">
                        <div>
                            <div class="stat-label">Debt-Free Date</div>
                            <div class="stat-value" style="color: var(--success);">Mar 2028</div>
                        </div>
                        <div class="stat-icon green">
                            <i class="fas fa-flag-checkered"></i>
                        </div>
                    </div>
                    <div class="stat-change positive">
                        <span>26 months to go!</span>
                    </div>
                </div>
            </div>

            <!-- Payoff Strategy Selector -->
            <div class="card">
                <div class="card-header">
                    <h3><i class="fas fa-chess"></i> Payoff Strategy</h3>
                    <button class="btn btn-secondary btn-sm" onclick="recalculatePayoff()">
                        <i class="fas fa-calculator"></i> Recalculate
                    </button>
                </div>
                <div class="card-body">
                    <div class="debt-strategy-selector">
                        <div class="strategy-option active" onclick="selectStrategy('avalanche')">
                            <i class="fas fa-mountain" style="font-size: 2rem; color: var(--info); margin-bottom: 0.5rem;"></i>
                            <h4>Avalanche Method</h4>
                            <p>Pay highest interest first. Saves the most money.</p>
                            <div style="margin-top: 0.5rem; font-weight: 600; color: var(--success);">Saves $3,240 in interest</div>
                        </div>
                        <div class="strategy-option" onclick="selectStrategy('snowball')">
                            <i class="fas fa-snowflake" style="font-size: 2rem; color: var(--teal); margin-bottom: 0.5rem;"></i>
                            <h4>Snowball Method</h4>
                            <p>Pay smallest balance first. Quick wins for motivation.</p>
                            <div style="margin-top: 0.5rem; font-weight: 600; color: var(--success);">First win in 2 months</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="two-col">
                <!-- Debt List -->
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-list"></i> Your Debts</h3>
                        <button class="btn btn-primary btn-sm" onclick="openModal('addDebtModal')">
                            <i class="fas fa-plus"></i> Add Debt
                        </button>
                    </div>
                    <div class="card-body" style="padding: 0;">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Account</th>
                                    <th>Balance</th>
                                    <th>APR</th>
                                    <th>Min Payment</th>
                                    <th>Payoff</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="debt-table-body">
                                <tr>
                                    <td>
                                        <div style="font-weight: 600;">Chase Visa</div>
                                        <div style="font-size: 0.75rem; color: var(--text-secondary);">Credit Card</div>
                                    </td>
                                    <td style="color: var(--danger); font-weight: 600;">$8,450</td>
                                    <td style="color: var(--warning);">24.99%</td>
                                    <td>$245</td>
                                    <td>Nov 2027</td>
                                    <td>
                                        <button class="btn btn-secondary btn-sm" onclick="editDebt(1)">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <div style="font-weight: 600;">Capital One</div>
                                        <div style="font-size: 0.75rem; color: var(--text-secondary);">Credit Card</div>
                                    </td>
                                    <td style="color: var(--danger); font-weight: 600;">$12,300</td>
                                    <td style="color: var(--warning);">22.49%</td>
                                    <td>$310</td>
                                    <td>Jan 2028</td>
                                    <td>
                                        <button class="btn btn-secondary btn-sm" onclick="editDebt(2)">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <div style="font-weight: 600;">Discover</div>
                                        <div style="font-size: 0.75rem; color: var(--text-secondary);">Credit Card</div>
                                    </td>
                                    <td style="color: var(--danger); font-weight: 600;">$2,400</td>
                                    <td style="color: var(--secondary);">18.99%</td>
                                    <td>$85</td>
                                    <td>Mar 2026</td>
                                    <td>
                                        <button class="btn btn-secondary btn-sm" onclick="editDebt(3)">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <div style="font-weight: 600;">Farm Equipment Loan</div>
                                        <div style="font-size: 0.75rem; color: var(--text-secondary);">Installment Loan</div>
                                    </td>
                                    <td style="color: var(--danger); font-weight: 600;">$18,600</td>
                                    <td style="color: var(--success);">6.9%</td>
                                    <td>$450</td>
                                    <td>Aug 2028</td>
                                    <td>
                                        <button class="btn btn-secondary btn-sm" onclick="editDebt(4)">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <div style="font-weight: 600;">Truck Loan</div>
                                        <div style="font-size: 0.75rem; color: var(--text-secondary);">Auto Loan</div>
                                    </td>
                                    <td style="color: var(--danger); font-weight: 600;">$20,000</td>
                                    <td style="color: var(--success);">5.9%</td>
                                    <td>$425</td>
                                    <td>Mar 2028</td>
                                    <td>
                                        <button class="btn btn-secondary btn-sm" onclick="editDebt(5)">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Payoff Timeline -->
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-flag-checkered"></i> Payoff Timeline</h3>
                    </div>
                    <div class="card-body">
                        <div class="payoff-timeline">
                            <div class="timeline-item">
                                <div class="timeline-number" style="background: var(--success);">1</div>
                                <div class="timeline-content">
                                    <div style="font-weight: 600;">Discover Card</div>
                                    <div class="timeline-date">Paid off: March 2026</div>
                                </div>
                                <div style="font-weight: 600; color: var(--success);">$2,400</div>
                            </div>
                            <div class="timeline-item">
                                <div class="timeline-number">2</div>
                                <div class="timeline-content">
                                    <div style="font-weight: 600;">Chase Visa</div>
                                    <div class="timeline-date">Paid off: November 2027</div>
                                </div>
                                <div style="font-weight: 600; color: var(--secondary);">$8,450</div>
                            </div>
                            <div class="timeline-item">
                                <div class="timeline-number">3</div>
                                <div class="timeline-content">
                                    <div style="font-weight: 600;">Capital One</div>
                                    <div class="timeline-date">Paid off: January 2028</div>
                                </div>
                                <div style="font-weight: 600; color: var(--secondary);">$12,300</div>
                            </div>
                            <div class="timeline-item">
                                <div class="timeline-number">4</div>
                                <div class="timeline-content">
                                    <div style="font-weight: 600;">Truck Loan</div>
                                    <div class="timeline-date">Paid off: March 2028</div>
                                </div>
                                <div style="font-weight: 600; color: var(--secondary);">$20,000</div>
                            </div>
                            <div class="timeline-item">
                                <div class="timeline-number" style="background: var(--gold);">5</div>
                                <div class="timeline-content">
                                    <div style="font-weight: 600;">Farm Equipment</div>
                                    <div class="timeline-date">Paid off: August 2028</div>
                                </div>
                                <div style="font-weight: 600; color: var(--gold);">$18,600</div>
                            </div>
                        </div>

                        <div style="margin-top: 2rem; padding: 1.5rem; background: rgba(42, 157, 143, 0.1); border-radius: 12px; text-align: center;">
                            <i class="fas fa-trophy" style="font-size: 2rem; color: var(--gold); margin-bottom: 0.5rem;"></i>
                            <div style="font-weight: 700; font-size: 1.25rem;">DEBT FREE!</div>
                            <div style="color: var(--text-secondary);">Target Date: August 2028</div>
                            <div style="margin-top: 0.5rem; color: var(--success); font-weight: 600;">Total Interest Saved: $3,240</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ============================================= -->
        <!-- BANKING TAB -->
        <!-- ============================================= -->
        <div id="tab-banking" class="tab-content">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-card-header">
                        <div>
                            <div class="stat-label">Total Cash</div>
                            <div class="stat-value" style="color: var(--success);">$42,850</div>
                        </div>
                        <div class="stat-icon green">
                            <i class="fas fa-wallet"></i>
                        </div>
                    </div>
                    <div class="stat-change neutral">
                        <span>Across 3 accounts</span>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-card-header">
                        <div>
                            <div class="stat-label">Bills Due This Month</div>
                            <div class="stat-value">$4,280</div>
                        </div>
                        <div class="stat-icon orange">
                            <i class="fas fa-file-invoice-dollar"></i>
                        </div>
                    </div>
                    <div class="stat-change negative">
                        <span>8 bills remaining</span>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-card-header">
                        <div>
                            <div class="stat-label">Income This Month</div>
                            <div class="stat-value" style="color: var(--success);">$12,400</div>
                        </div>
                        <div class="stat-icon teal">
                            <i class="fas fa-arrow-down"></i>
                        </div>
                    </div>
                    <div class="stat-change positive">
                        <i class="fas fa-arrow-up"></i>
                        <span>+18% vs last month</span>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-card-header">
                        <div>
                            <div class="stat-label">Cash Flow</div>
                            <div class="stat-value" style="color: var(--success);">+$4,200</div>
                        </div>
                        <div class="stat-icon green">
                            <i class="fas fa-exchange-alt"></i>
                        </div>
                    </div>
                    <div class="stat-change positive">
                        <span>Surplus this month</span>
                    </div>
                </div>
            </div>

            <div class="two-col">
                <!-- Bank Accounts -->
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-university"></i> Bank Accounts</h3>
                        <div style="display: flex; gap: 0.5rem;">
                            <button class="btn btn-success btn-sm" onclick="connectBankWithPlaid()" id="plaidConnectBtn">
                                <i class="fas fa-link"></i> Connect Bank
                            </button>
                            <button class="btn btn-primary btn-sm" onclick="openModal('addAccountModal')">
                                <i class="fas fa-plus"></i> Add Manual
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="account-card checking">
                            <div class="account-icon" style="color: var(--info);">
                                <i class="fas fa-money-check-alt"></i>
                            </div>
                            <div class="account-info">
                                <div class="account-name">Farm Operations Checking</div>
                                <div class="account-type">First National Bank - ****4521</div>
                            </div>
                            <div class="account-balance">
                                <div class="amount" style="color: var(--success);">$18,250</div>
                                <div class="label">Available</div>
                            </div>
                        </div>

                        <div class="account-card savings">
                            <div class="account-icon" style="color: var(--success);">
                                <i class="fas fa-piggy-bank"></i>
                            </div>
                            <div class="account-info">
                                <div class="account-name">Emergency Fund</div>
                                <div class="account-type">First National Bank - ****4522</div>
                            </div>
                            <div class="account-balance">
                                <div class="amount" style="color: var(--success);">$24,600</div>
                                <div class="label">Savings</div>
                            </div>
                        </div>

                        <div class="account-card investment">
                            <div class="account-icon" style="color: var(--gold);">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="account-info">
                                <div class="account-name">Investment Account</div>
                                <div class="account-type">Fidelity - ****7890</div>
                            </div>
                            <div class="account-balance">
                                <div class="amount" style="color: var(--gold);">$47,250</div>
                                <div class="label">Portfolio Value</div>
                            </div>
                        </div>

                        <div class="upload-area" onclick="document.getElementById('bankStatementUpload').click()">
                            <input type="file" id="bankStatementUpload" style="display: none;" accept=".csv,.pdf,.ofx,.qfx" onchange="handleBankUpload(this)">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Drop bank statement here or click to upload</p>
                            <p style="font-size: 0.75rem; margin-top: 0.5rem;">Supports CSV, PDF, OFX, QFX</p>
                        </div>
                    </div>
                </div>

                <!-- Bills -->
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-file-invoice"></i> Upcoming Bills</h3>
                        <button class="btn btn-primary btn-sm" onclick="openModal('addBillModal')">
                            <i class="fas fa-plus"></i> Add Bill
                        </button>
                    </div>
                    <div class="card-body" style="padding: 0;">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Bill</th>
                                    <th>Due</th>
                                    <th>Amount</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>
                                        <div style="font-weight: 600;">Electric - PG&E</div>
                                        <div style="font-size: 0.75rem; color: var(--text-secondary);">Utility</div>
                                    </td>
                                    <td>Jan 18</td>
                                    <td>$342</td>
                                    <td><span class="badge danger">Due Soon</span></td>
                                </tr>
                                <tr>
                                    <td>
                                        <div style="font-weight: 600;">Water District</div>
                                        <div style="font-size: 0.75rem; color: var(--text-secondary);">Utility</div>
                                    </td>
                                    <td>Jan 20</td>
                                    <td>$185</td>
                                    <td><span class="badge warning">Upcoming</span></td>
                                </tr>
                                <tr>
                                    <td>
                                        <div style="font-weight: 600;">Farm Insurance</div>
                                        <div style="font-size: 0.75rem; color: var(--text-secondary);">Insurance</div>
                                    </td>
                                    <td>Jan 25</td>
                                    <td>$890</td>
                                    <td><span class="badge warning">Upcoming</span></td>
                                </tr>
                                <tr>
                                    <td>
                                        <div style="font-weight: 600;">Internet - Comcast</div>
                                        <div style="font-size: 0.75rem; color: var(--text-secondary);">Service</div>
                                    </td>
                                    <td>Jan 28</td>
                                    <td>$89</td>
                                    <td><span class="badge success">Auto-Pay</span></td>
                                </tr>
                                <tr>
                                    <td>
                                        <div style="font-weight: 600;">Truck Insurance</div>
                                        <div style="font-size: 0.75rem; color: var(--text-secondary);">Insurance</div>
                                    </td>
                                    <td>Feb 1</td>
                                    <td>$215</td>
                                    <td><span class="badge success">Auto-Pay</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Recent Transactions -->
            <div class="card">
                <div class="card-header">
                    <h3><i class="fas fa-history"></i> Recent Transactions</h3>
                    <div style="display: flex; gap: 0.5rem;">
                        <select class="form-input" style="width: auto; padding: 0.5rem 1rem;">
                            <option>All Accounts</option>
                            <option>Operations Checking</option>
                            <option>Emergency Fund</option>
                        </select>
                        <button class="btn btn-secondary btn-sm">
                            <i class="fas fa-filter"></i> Filter
                        </button>
                    </div>
                </div>
                <div class="card-body" style="padding: 0;">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Description</th>
                                <th>Category</th>
                                <th>Account</th>
                                <th>Amount</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Jan 15</td>
                                <td>Farmers Market Sales Deposit</td>
                                <td><span style="padding: 0.25rem 0.5rem; background: rgba(42, 157, 143, 0.2); border-radius: 4px; font-size: 0.8rem;">Income</span></td>
                                <td>Operations Checking</td>
                                <td style="color: var(--success); font-weight: 600;">+$2,450</td>
                            </tr>
                            <tr>
                                <td>Jan 14</td>
                                <td>Seed Supply Co</td>
                                <td><span style="padding: 0.25rem 0.5rem; background: rgba(244, 162, 97, 0.2); border-radius: 4px; font-size: 0.8rem;">Farm Supplies</span></td>
                                <td>Operations Checking</td>
                                <td style="color: var(--danger); font-weight: 600;">-$342</td>
                            </tr>
                            <tr>
                                <td>Jan 13</td>
                                <td>Restaurant Depot - CSA Orders</td>
                                <td><span style="padding: 0.25rem 0.5rem; background: rgba(42, 157, 143, 0.2); border-radius: 4px; font-size: 0.8rem;">Income</span></td>
                                <td>Operations Checking</td>
                                <td style="color: var(--success); font-weight: 600;">+$1,850</td>
                            </tr>
                            <tr>
                                <td>Jan 12</td>
                                <td>Diesel Fuel - Shell</td>
                                <td><span style="padding: 0.25rem 0.5rem; background: rgba(230, 57, 70, 0.2); border-radius: 4px; font-size: 0.8rem;">Vehicle</span></td>
                                <td>Operations Checking</td>
                                <td style="color: var(--danger); font-weight: 600;">-$187</td>
                            </tr>
                            <tr>
                                <td>Jan 11</td>
                                <td>Transfer to Emergency Fund</td>
                                <td><span style="padding: 0.25rem 0.5rem; background: rgba(67, 97, 238, 0.2); border-radius: 4px; font-size: 0.8rem;">Transfer</span></td>
                                <td>Operations Checking</td>
                                <td style="color: var(--info); font-weight: 600;">-$500</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- ============================================= -->
        <!-- INVESTMENTS TAB -->
        <!-- ============================================= -->
        <div id="tab-investments" class="tab-content">
            <div class="alert alert-info">
                <i class="fas fa-info-circle" style="color: var(--info);"></i>
                <div>
                    <strong>Investment Dashboard:</strong> For detailed portfolio management,
                    <a href="wealth-builder.html" style="color: var(--primary-light);">open the full Wealth Builder dashboard</a>.
                </div>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-card-header">
                        <div>
                            <div class="stat-label">Portfolio Value</div>
                            <div class="stat-value" style="color: var(--success);">$47,250</div>
                        </div>
                        <div class="stat-icon gold">
                            <i class="fas fa-chart-line"></i>
                        </div>
                    </div>
                    <div class="stat-change positive">
                        <i class="fas fa-arrow-up"></i>
                        <span>+$2,340 (+5.2%) YTD</span>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-card-header">
                        <div>
                            <div class="stat-label">This Month's Contribution</div>
                            <div class="stat-value">$250</div>
                        </div>
                        <div class="stat-icon blue">
                            <i class="fas fa-plus-circle"></i>
                        </div>
                    </div>
                    <div class="stat-change neutral">
                        <span>Winter Season (0.25x)</span>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-card-header">
                        <div>
                            <div class="stat-label">Growth Mode</div>
                            <div class="stat-value" style="color: var(--success);">OFFENSIVE</div>
                        </div>
                        <div class="stat-icon green">
                            <i class="fas fa-rocket"></i>
                        </div>
                    </div>
                    <div class="stat-change neutral">
                        <span>QQQ + MTUM leading</span>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-card-header">
                        <div>
                            <div class="stat-label">Current Drawdown</div>
                            <div class="stat-value" style="color: var(--success);">3.2%</div>
                        </div>
                        <div class="stat-icon green">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                    </div>
                    <div class="stat-change positive">
                        <span>Within safe limits</span>
                    </div>
                </div>
            </div>

            <div class="two-col">
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-chart-pie"></i> Current Allocation</h3>
                    </div>
                    <div class="card-body">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                            <div>
                                <canvas id="allocationPieChart"></canvas>
                            </div>
                            <div>
                                <h4 style="margin-bottom: 1rem; color: var(--text-secondary); font-size: 0.85rem;">HOLDINGS</h4>
                                <div id="holdings-list">
                                    <!-- Populated by JS -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-calendar-alt"></i> Seasonal Schedule</h3>
                    </div>
                    <div class="card-body">
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 0; margin-bottom: 1.5rem;">
                            <div style="padding: 1rem; text-align: center; background: rgba(230, 57, 70, 0.1); border: 1px solid var(--danger); border-right: none;">
                                <div style="font-weight: 600; font-size: 0.85rem;">Winter</div>
                                <div style="font-size: 0.75rem; color: var(--text-secondary);">Nov-Feb</div>
                                <div style="font-size: 1.25rem; font-weight: 700; color: var(--danger);">0.25x</div>
                            </div>
                            <div style="padding: 1rem; text-align: center; background: rgba(233, 196, 106, 0.1); border: 1px solid var(--warning);">
                                <div style="font-weight: 600; font-size: 0.85rem;">Planting</div>
                                <div style="font-size: 0.75rem; color: var(--text-secondary);">Mar-May</div>
                                <div style="font-size: 1.25rem; font-weight: 700; color: var(--warning);">0.75x</div>
                            </div>
                            <div style="padding: 1rem; text-align: center; background: rgba(42, 157, 143, 0.1); border: 1px solid var(--success); border-left: none;">
                                <div style="font-weight: 600; font-size: 0.85rem;">Harvest</div>
                                <div style="font-size: 0.75rem; color: var(--text-secondary);">Jun-Oct</div>
                                <div style="font-size: 1.25rem; font-weight: 700; color: var(--success);">1.5x</div>
                            </div>
                        </div>
                        <div style="padding: 1rem; background: rgba(255,255,255,0.03); border-radius: 8px; text-align: center;">
                            <div style="font-size: 0.75rem; color: var(--text-secondary);">Current Season</div>
                            <div style="font-size: 1.5rem; font-weight: 700; color: var(--danger);">WINTER (0.25x)</div>
                            <div style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 0.5rem;">
                                Base $1,000/mo = $250 contribution
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div style="text-align: center; padding: 2rem;">
                <a href="wealth-builder.html" class="btn btn-primary" style="font-size: 1rem; padding: 1rem 2rem;">
                    <i class="fas fa-external-link-alt"></i> Open Full Investment Dashboard
                </a>
            </div>
        </div>

        <!-- ============================================= -->
        <!-- ROUND-UPS TAB -->
        <!-- ============================================= -->
        <div id="tab-roundups" class="tab-content">
            <div class="roundup-animation">
                <div class="coin">
                    <i class="fas fa-coins" style="color: var(--gold);"></i>
                </div>
                <div>
                    <div style="font-size: 0.9rem; color: var(--text-secondary);">Total Round-Up Savings</div>
                    <div class="roundup-total">$1,247.83</div>
                    <div style="font-size: 0.85rem; color: var(--success);">+$47.32 this week</div>
                </div>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-card-header">
                        <div>
                            <div class="stat-label">This Month's Round-Ups</div>
                            <div class="stat-value" style="color: var(--success);">$187</div>
                        </div>
                        <div class="stat-icon teal">
                            <i class="fas fa-coins"></i>
                        </div>
                    </div>
                    <div class="stat-change positive">
                        <span>From 142 orders</span>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-card-header">
                        <div>
                            <div class="stat-label">Average Per Order</div>
                            <div class="stat-value">$0.47</div>
                        </div>
                        <div class="stat-icon gold">
                            <i class="fas fa-receipt"></i>
                        </div>
                    </div>
                    <div class="stat-change neutral">
                        <span>Round up to nearest $1</span>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-card-header">
                        <div>
                            <div class="stat-label">Invested So Far</div>
                            <div class="stat-value" style="color: var(--success);">$1,100</div>
                        </div>
                        <div class="stat-icon green">
                            <i class="fas fa-chart-line"></i>
                        </div>
                    </div>
                    <div class="stat-change positive">
                        <span>Into investment portfolio</span>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-card-header">
                        <div>
                            <div class="stat-label">Pending Transfer</div>
                            <div class="stat-value">$147.83</div>
                        </div>
                        <div class="stat-icon blue">
                            <i class="fas fa-hourglass-half"></i>
                        </div>
                    </div>
                    <div class="stat-change neutral">
                        <span>Transfers at $100</span>
                    </div>
                </div>
            </div>

            <div class="two-col">
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-receipt"></i> Recent Round-Ups</h3>
                    </div>
                    <div class="card-body" style="padding: 0;">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Order</th>
                                    <th>Amount</th>
                                    <th>Round-Up</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Jan 15</td>
                                    <td>CSA Box - Smith Family</td>
                                    <td>$42.50</td>
                                    <td style="color: var(--success); font-weight: 600;">+$0.50</td>
                                </tr>
                                <tr>
                                    <td>Jan 15</td>
                                    <td>Farmers Market - Veggies</td>
                                    <td>$23.75</td>
                                    <td style="color: var(--success); font-weight: 600;">+$0.25</td>
                                </tr>
                                <tr>
                                    <td>Jan 14</td>
                                    <td>Restaurant - Green Leaf</td>
                                    <td>$156.80</td>
                                    <td style="color: var(--success); font-weight: 600;">+$0.20</td>
                                </tr>
                                <tr>
                                    <td>Jan 14</td>
                                    <td>CSA Box - Johnson</td>
                                    <td>$35.00</td>
                                    <td style="color: var(--text-secondary); font-weight: 600;">$0.00</td>
                                </tr>
                                <tr>
                                    <td>Jan 13</td>
                                    <td>Farmers Market - Eggs</td>
                                    <td>$8.50</td>
                                    <td style="color: var(--success); font-weight: 600;">+$0.50</td>
                                </tr>
                                <tr>
                                    <td>Jan 13</td>
                                    <td>Online Store Order</td>
                                    <td>$67.23</td>
                                    <td style="color: var(--success); font-weight: 600;">+$0.77</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-cog"></i> Round-Up Settings</h3>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label class="form-label">Round-Up Amount</label>
                            <select class="form-input">
                                <option value="1" selected>Round to nearest $1.00</option>
                                <option value="2">Round to nearest $2.00</option>
                                <option value="5">Round to nearest $5.00</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Auto-Transfer Threshold</label>
                            <select class="form-input">
                                <option value="50">Transfer at $50</option>
                                <option value="100" selected>Transfer at $100</option>
                                <option value="250">Transfer at $250</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Transfer Destination</label>
                            <select class="form-input">
                                <option value="investment" selected>Investment Portfolio</option>
                                <option value="emergency">Emergency Fund</option>
                                <option value="debt">Extra Debt Payment</option>
                            </select>
                        </div>

                        <div style="padding: 1rem; background: rgba(42, 157, 143, 0.1); border-radius: 8px; margin-top: 1rem;">
                            <div style="display: flex; align-items: center; gap: 1rem;">
                                <input type="checkbox" id="enableRoundups" checked style="width: 20px; height: 20px;">
                                <label for="enableRoundups" style="font-weight: 600;">Enable Round-Ups</label>
                            </div>
                            <p style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 0.5rem; margin-left: 2rem;">
                                Automatically round up every farm sale and invest the difference.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ============================================= -->
        <!-- TEAM & RETIREMENT TAB -->
        <!-- ============================================= -->
        <div id="tab-employees" class="tab-content">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-card-header">
                        <div>
                            <div class="stat-label">SEP-IRA Contributions (YTD)</div>
                            <div class="stat-value" style="color: var(--success);">$8,450</div>
                        </div>
                        <div class="stat-icon green">
                            <i class="fas fa-piggy-bank"></i>
                        </div>
                    </div>
                    <div class="stat-change positive">
                        <span>Farm contribution to employee retirement</span>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-card-header">
                        <div>
                            <div class="stat-label">Team Members</div>
                            <div class="stat-value">6</div>
                        </div>
                        <div class="stat-icon purple">
                            <i class="fas fa-users"></i>
                        </div>
                    </div>
                    <div class="stat-change neutral">
                        <span>Active employees</span>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-card-header">
                        <div>
                            <div class="stat-label">Incentive Pool</div>
                            <div class="stat-value" style="color: var(--gold);">$3,200</div>
                        </div>
                        <div class="stat-icon gold">
                            <i class="fas fa-gift"></i>
                        </div>
                    </div>
                    <div class="stat-change positive">
                        <span>Available this quarter</span>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-card-header">
                        <div>
                            <div class="stat-label">Milestones Reached</div>
                            <div class="stat-value" style="color: var(--secondary);">24</div>
                        </div>
                        <div class="stat-icon orange">
                            <i class="fas fa-flag-checkered"></i>
                        </div>
                    </div>
                    <div class="stat-change positive">
                        <span>Team total this year</span>
                    </div>
                </div>
            </div>

            <div class="two-col">
                <!-- Employee IRA Contributions -->
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-piggy-bank"></i> SEP-IRA Contributions</h3>
                        <button class="btn btn-success btn-sm" onclick="openModal('addIRAContributionModal')">
                            <i class="fas fa-plus"></i> Add Contribution
                        </button>
                    </div>
                    <div class="card-body" style="padding: 0;">
                        <div style="padding: 1rem; background: rgba(42, 157, 143, 0.1); border-bottom: 1px solid var(--border);">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                <span style="color: var(--text-secondary);">Annual Contribution Limit (25% of comp)</span>
                                <span style="font-weight: 600;">$66,000 max</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: var(--text-secondary);">Farm Contribution Rate</span>
                                <span style="font-weight: 600; color: var(--success);">3% of wages</span>
                            </div>
                        </div>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Employee</th>
                                    <th>YTD Wages</th>
                                    <th>IRA Contribution</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="iraContributionsTable">
                                <tr>
                                    <td>
                                        <div style="font-weight: 600;">Maria Garcia</div>
                                        <div style="font-size: 0.75rem; color: var(--text-secondary);">Field Manager</div>
                                    </td>
                                    <td>$42,500</td>
                                    <td style="color: var(--success); font-weight: 600;">$1,275</td>
                                    <td><span class="status-badge active">Current</span></td>
                                </tr>
                                <tr>
                                    <td>
                                        <div style="font-weight: 600;">James Wilson</div>
                                        <div style="font-size: 0.75rem; color: var(--text-secondary);">Harvest Lead</div>
                                    </td>
                                    <td>$38,200</td>
                                    <td style="color: var(--success); font-weight: 600;">$1,146</td>
                                    <td><span class="status-badge active">Current</span></td>
                                </tr>
                                <tr>
                                    <td>
                                        <div style="font-weight: 600;">Sarah Chen</div>
                                        <div style="font-size: 0.75rem; color: var(--text-secondary);">Greenhouse Tech</div>
                                    </td>
                                    <td>$35,800</td>
                                    <td style="color: var(--success); font-weight: 600;">$1,074</td>
                                    <td><span class="status-badge active">Current</span></td>
                                </tr>
                                <tr>
                                    <td>
                                        <div style="font-weight: 600;">Mike Johnson</div>
                                        <div style="font-size: 0.75rem; color: var(--text-secondary);">Driver</div>
                                    </td>
                                    <td>$28,600</td>
                                    <td style="color: var(--success); font-weight: 600;">$858</td>
                                    <td><span class="status-badge active">Current</span></td>
                                </tr>
                                <tr>
                                    <td>
                                        <div style="font-weight: 600;">Emily Davis</div>
                                        <div style="font-size: 0.75rem; color: var(--text-secondary);">Sales</div>
                                    </td>
                                    <td>$32,400</td>
                                    <td style="color: var(--success); font-weight: 600;">$972</td>
                                    <td><span class="status-badge active">Current</span></td>
                                </tr>
                                <tr>
                                    <td>
                                        <div style="font-weight: 600;">Tom Martinez</div>
                                        <div style="font-size: 0.75rem; color: var(--text-secondary);">Farm Hand</div>
                                    </td>
                                    <td>$24,800</td>
                                    <td style="color: var(--success); font-weight: 600;">$744</td>
                                    <td><span class="status-badge pending">Seasonal</span></td>
                                </tr>
                            </tbody>
                            <tfoot style="background: rgba(255,255,255,0.03);">
                                <tr>
                                    <td style="font-weight: 700;">Total</td>
                                    <td style="font-weight: 700;">$202,300</td>
                                    <td style="font-weight: 700; color: var(--success);">$6,069</td>
                                    <td></td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>

                <!-- Milestone Incentives (Non-Competitive) -->
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-gift"></i> Milestone Incentives</h3>
                    </div>
                    <div class="card-body">
                        <p style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 1rem;">
                            Earn bonuses by reaching personal milestones - not a competition, just recognition for your hard work!
                        </p>

                        <h4 style="margin: 1rem 0 0.75rem; color: var(--text-secondary); font-size: 0.85rem;">WORK MILESTONES</h4>
                        <div class="achievement-grid">
                            <div class="achievement unlocked">
                                <div class="achievement-icon">
                                    <i class="fas fa-calendar-check" style="color: var(--success);"></i>
                                </div>
                                <div class="achievement-name">30-Day Mark</div>
                                <div class="achievement-desc">$50 bonus</div>
                            </div>
                            <div class="achievement unlocked">
                                <div class="achievement-icon">
                                    <i class="fas fa-calendar-alt" style="color: var(--info);"></i>
                                </div>
                                <div class="achievement-name">90-Day Mark</div>
                                <div class="achievement-desc">$100 bonus</div>
                            </div>
                            <div class="achievement unlocked">
                                <div class="achievement-icon">
                                    <i class="fas fa-award" style="color: var(--secondary);"></i>
                                </div>
                                <div class="achievement-name">1 Year</div>
                                <div class="achievement-desc">$250 bonus</div>
                            </div>
                            <div class="achievement locked">
                                <div class="achievement-icon">
                                    <i class="fas fa-star"></i>
                                </div>
                                <div class="achievement-name">2 Years</div>
                                <div class="achievement-desc">$500 bonus</div>
                            </div>
                            <div class="achievement locked">
                                <div class="achievement-icon">
                                    <i class="fas fa-gem"></i>
                                </div>
                                <div class="achievement-name">5 Years</div>
                                <div class="achievement-desc">$1,000 bonus</div>
                            </div>
                            <div class="achievement locked">
                                <div class="achievement-icon">
                                    <i class="fas fa-crown"></i>
                                </div>
                                <div class="achievement-name">500 Hours/Season</div>
                                <div class="achievement-desc">$200 bonus</div>
                            </div>
                        </div>

                        <h4 style="margin: 1.5rem 0 0.75rem; color: var(--text-secondary); font-size: 0.85rem;">SKILL MILESTONES</h4>
                        <div class="achievement-grid">
                            <div class="achievement unlocked">
                                <div class="achievement-icon">
                                    <i class="fas fa-seedling" style="color: var(--success);"></i>
                                </div>
                                <div class="achievement-name">Greenhouse Certified</div>
                                <div class="achievement-desc">$75 bonus</div>
                            </div>
                            <div class="achievement unlocked">
                                <div class="achievement-icon">
                                    <i class="fas fa-truck" style="color: var(--info);"></i>
                                </div>
                                <div class="achievement-name">Delivery Trained</div>
                                <div class="achievement-desc">$75 bonus</div>
                            </div>
                            <div class="achievement locked">
                                <div class="achievement-icon">
                                    <i class="fas fa-tractor"></i>
                                </div>
                                <div class="achievement-name">Equipment Operator</div>
                                <div class="achievement-desc">$100 bonus</div>
                            </div>
                            <div class="achievement locked">
                                <div class="achievement-icon">
                                    <i class="fas fa-chalkboard-teacher"></i>
                                </div>
                                <div class="achievement-name">Trained a New Hire</div>
                                <div class="achievement-desc">$50 bonus</div>
                            </div>
                        </div>

                        <div style="margin-top: 1.5rem; padding: 1rem; background: rgba(233, 196, 106, 0.1); border-radius: 8px; border-left: 4px solid var(--warning);">
                            <div style="font-weight: 600; margin-bottom: 0.5rem;">
                                <i class="fas fa-lightbulb" style="color: var(--warning);"></i> How It Works
                            </div>
                            <p style="font-size: 0.85rem; color: var(--text-secondary); line-height: 1.5;">
                                Milestones are personal achievements - reach them at your own pace.
                                Bonuses are paid within 2 pay periods of reaching each milestone.
                                Everyone can earn every bonus!
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ============================================= -->
        <!-- SETTINGS TAB -->
        <!-- ============================================= -->
        <div id="tab-settings" class="tab-content">
            <div class="three-col">
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-link"></i> Connections</h3>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label class="form-label">Google Sheets ID</label>
                            <input type="text" class="form-input" value="128O56X_FN9_U-s0ENHBBRyLpae_yvWHPYbBheVlR3Vc">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Apps Script URL</label>
                            <input type="text" class="form-input" placeholder="Your deployed Apps Script URL">
                        </div>
                        <button class="btn btn-primary">
                            <i class="fas fa-plug"></i> Test Connection
                        </button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-bell"></i> Notifications</h3>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <div style="display: flex; align-items: center; justify-content: space-between; padding: 0.75rem 0; border-bottom: 1px solid var(--border);">
                                <span>Bill Due Reminders</span>
                                <input type="checkbox" checked>
                            </div>
                            <div style="display: flex; align-items: center; justify-content: space-between; padding: 0.75rem 0; border-bottom: 1px solid var(--border);">
                                <span>Debt Milestone Alerts</span>
                                <input type="checkbox" checked>
                            </div>
                            <div style="display: flex; align-items: center; justify-content: space-between; padding: 0.75rem 0; border-bottom: 1px solid var(--border);">
                                <span>Investment Rebalance Alerts</span>
                                <input type="checkbox" checked>
                            </div>
                            <div style="display: flex; align-items: center; justify-content: space-between; padding: 0.75rem 0;">
                                <span>Employee Achievement Notifications</span>
                                <input type="checkbox" checked>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-dollar-sign"></i> Financial Settings</h3>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label class="form-label">Monthly Expenses (for emergency fund calc)</label>
                            <input type="number" class="form-input" value="8000">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Base Monthly Investment</label>
                            <input type="number" class="form-input" value="1000">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Emergency Fund Goal (months)</label>
                            <input type="number" class="form-input" value="6">
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h3><i class="fas fa-download"></i> Import / Export</h3>
                </div>
                <div class="card-body">
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem;">
                        <div class="upload-area">
                            <i class="fas fa-file-csv"></i>
                            <p>Import Bank Statement</p>
                        </div>
                        <div class="upload-area">
                            <i class="fas fa-file-invoice"></i>
                            <p>Import Bills</p>
                        </div>
                        <div class="upload-area">
                            <i class="fas fa-file-export"></i>
                            <p>Export All Data</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ============================================= -->
        <!-- MARKETING TAB -->
        <!-- ============================================= -->
        <div id="tab-marketing" class="tab-content">
            <!-- Marketing Budget Overview -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-card-header">
                        <div>
                            <div class="stat-label">Marketing Budget</div>
                            <div class="stat-value" id="marketing-budget">$500</div>
                        </div>
                        <div class="stat-icon" style="background: linear-gradient(135deg, #E1306C, #9b59b6);">
                            <i class="fas fa-bullhorn"></i>
                        </div>
                    </div>
                    <div class="stat-change">
                        <span>Monthly allocation</span>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-card-header">
                        <div>
                            <div class="stat-label">Spent This Month</div>
                            <div class="stat-value" id="marketing-spent">$127</div>
                        </div>
                        <div class="stat-icon red">
                            <i class="fas fa-receipt"></i>
                        </div>
                    </div>
                    <div class="progress-container">
                        <div class="progress-header">
                            <span id="marketing-spent-percent">25% used</span>
                            <span id="marketing-remaining">$373 remaining</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill success" id="marketing-progress" style="width: 25%"></div>
                        </div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-card-header">
                        <div>
                            <div class="stat-label">ROI This Month</div>
                            <div class="stat-value positive" id="marketing-roi">+312%</div>
                        </div>
                        <div class="stat-icon green">
                            <i class="fas fa-chart-line"></i>
                        </div>
                    </div>
                    <div class="stat-change positive">
                        <i class="fas fa-arrow-up"></i>
                        <span>$396 revenue from marketing</span>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-card-header">
                        <div>
                            <div class="stat-label">Posts This Month</div>
                            <div class="stat-value" id="marketing-posts">23</div>
                        </div>
                        <div class="stat-icon teal">
                            <i class="fas fa-share-alt"></i>
                        </div>
                    </div>
                    <div class="stat-change positive">
                        <i class="fas fa-arrow-up"></i>
                        <span>+8 from last month</span>
                    </div>
                </div>
            </div>

            <!-- Marketing Spend Breakdown -->
            <div class="two-col">
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-chart-pie"></i> Spend by Category</h3>
                        <button class="btn btn-primary btn-sm" onclick="openModal('addMarketingSpendModal')">
                            <i class="fas fa-plus"></i> Log Expense
                        </button>
                    </div>
                    <div class="card-body">
                        <div id="marketing-spend-categories">
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.75rem 0; border-bottom: 1px solid var(--border);">
                                <div style="display: flex; align-items: center; gap: 0.75rem;">
                                    <div style="width: 12px; height: 12px; background: #E1306C; border-radius: 50%;"></div>
                                    <span>Social Media Ads</span>
                                </div>
                                <span style="font-weight: 600;">$65</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.75rem 0; border-bottom: 1px solid var(--border);">
                                <div style="display: flex; align-items: center; gap: 0.75rem;">
                                    <div style="width: 12px; height: 12px; background: #3b5998; border-radius: 50%;"></div>
                                    <span>Ayrshare Subscription</span>
                                </div>
                                <span style="font-weight: 600;">$29</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.75rem 0; border-bottom: 1px solid var(--border);">
                                <div style="display: flex; align-items: center; gap: 0.75rem;">
                                    <div style="width: 12px; height: 12px; background: #2ecc71; border-radius: 50%;"></div>
                                    <span>Print Materials</span>
                                </div>
                                <span style="font-weight: 600;">$33</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.75rem 0;">
                                <div style="display: flex; align-items: center; gap: 0.75rem;">
                                    <div style="width: 12px; height: 12px; background: #9b59b6; border-radius: 50%;"></div>
                                    <span>Photography/Content</span>
                                </div>
                                <span style="font-weight: 600;">$0</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-history"></i> Recent Marketing Spend</h3>
                        <a href="marketing-command-center.html" class="btn btn-secondary btn-sm">
                            <i class="fas fa-external-link-alt"></i> Marketing Hub
                        </a>
                    </div>
                    <div class="card-body">
                        <div id="marketing-spend-history" style="max-height: 300px; overflow-y: auto;">
                            <div class="alert" style="margin-bottom: 0.5rem;">
                                <i class="fas fa-ad" style="color: #E1306C;"></i>
                                <div style="flex: 1;">
                                    <div style="font-weight: 500;">Instagram Boost - CSA Promo</div>
                                    <div style="font-size: 0.8rem; color: var(--text-secondary);">Jan 12, 2026</div>
                                </div>
                                <span style="font-weight: 600; color: var(--danger);">-$25</span>
                            </div>
                            <div class="alert" style="margin-bottom: 0.5rem;">
                                <i class="fas fa-sync-alt" style="color: #3b5998;"></i>
                                <div style="flex: 1;">
                                    <div style="font-weight: 500;">Ayrshare Monthly</div>
                                    <div style="font-size: 0.8rem; color: var(--text-secondary);">Jan 1, 2026</div>
                                </div>
                                <span style="font-weight: 600; color: var(--danger);">-$29</span>
                            </div>
                            <div class="alert" style="margin-bottom: 0.5rem;">
                                <i class="fas fa-ad" style="color: #E1306C;"></i>
                                <div style="flex: 1;">
                                    <div style="font-weight: 500;">Facebook Ad - Market Day</div>
                                    <div style="font-size: 0.8rem; color: var(--text-secondary);">Jan 8, 2026</div>
                                </div>
                                <span style="font-weight: 600; color: var(--danger);">-$40</span>
                            </div>
                            <div class="alert" style="margin-bottom: 0.5rem;">
                                <i class="fas fa-print" style="color: #2ecc71;"></i>
                                <div style="flex: 1;">
                                    <div style="font-weight: 500;">Farmer's Market Flyers</div>
                                    <div style="font-size: 0.8rem; color: var(--text-secondary);">Jan 5, 2026</div>
                                </div>
                                <span style="font-weight: 600; color: var(--danger);">-$33</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Marketing Fund Allocation -->
            <div class="card">
                <div class="card-header">
                    <h3><i class="fas fa-piggy-bank"></i> Marketing Fund</h3>
                    <button class="btn btn-success btn-sm" onclick="openModal('allocateMarketingModal')">
                        <i class="fas fa-plus"></i> Add Funds
                    </button>
                </div>
                <div class="card-body">
                    <div class="alert alert-success" style="margin-bottom: 1rem;">
                        <i class="fas fa-info-circle"></i>
                        <div>
                            <strong>Marketing Fund Balance:</strong> $1,247.00
                            <br><small>Separate account for marketing spend - auto-funded from sales revenue</small>
                        </div>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                        <div style="padding: 1rem; background: var(--surface-secondary); border-radius: 8px; text-align: center;">
                            <div style="font-size: 0.85rem; color: var(--text-secondary);">Monthly Auto-Allocation</div>
                            <div style="font-size: 1.5rem; font-weight: 700; color: var(--primary);">2%</div>
                            <div style="font-size: 0.8rem; color: var(--text-secondary);">of gross sales</div>
                        </div>
                        <div style="padding: 1rem; background: var(--surface-secondary); border-radius: 8px; text-align: center;">
                            <div style="font-size: 0.85rem; color: var(--text-secondary);">Last Deposit</div>
                            <div style="font-size: 1.5rem; font-weight: 700; color: var(--success);">+$248</div>
                            <div style="font-size: 0.8rem; color: var(--text-secondary);">Jan 1, 2026</div>
                        </div>
                        <div style="padding: 1rem; background: var(--surface-secondary); border-radius: 8px; text-align: center;">
                            <div style="font-size: 0.85rem; color: var(--text-secondary);">YTD Spend</div>
                            <div style="font-size: 1.5rem; font-weight: 700; color: var(--danger);">$127</div>
                            <div style="font-size: 0.8rem; color: var(--text-secondary);">15 transactions</div>
                        </div>
                        <div style="padding: 1rem; background: var(--surface-secondary); border-radius: 8px; text-align: center;">
                            <div style="font-size: 0.85rem; color: var(--text-secondary);">Avg. Cost Per Post</div>
                            <div style="font-size: 1.5rem; font-weight: 700;">$5.52</div>
                            <div style="font-size: 0.8rem; color: var(--text-secondary);">23 posts this month</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="card">
                <div class="card-header">
                    <h3><i class="fas fa-bolt"></i> Quick Actions</h3>
                </div>
                <div class="card-body">
                    <div style="display: flex; flex-wrap: wrap; gap: 1rem;">
                        <a href="marketing-command-center.html" class="btn btn-primary">
                            <i class="fas fa-bullhorn"></i> Open Marketing Hub
                        </a>
                        <button class="btn btn-secondary" onclick="openModal('addMarketingSpendModal')">
                            <i class="fas fa-receipt"></i> Log Marketing Expense
                        </button>
                        <button class="btn btn-secondary" onclick="openModal('allocateMarketingModal')">
                            <i class="fas fa-hand-holding-usd"></i> Add to Marketing Fund
                        </button>
                        <button class="btn btn-secondary" onclick="loadMarketingData()">
                            <i class="fas fa-sync-alt"></i> Refresh Data
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- ============================================= -->
    <!-- MODALS -->
    <!-- ============================================= -->

    <!-- Add Debt Modal -->
    <div class="modal-overlay" id="addDebtModal">
        <div class="modal">
            <div class="modal-header">
                <h2><i class="fas fa-plus-circle"></i> Add New Debt</h2>
                <button class="modal-close" onclick="closeModal('addDebtModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Account Name</label>
                    <input type="text" class="form-input" placeholder="e.g., Chase Visa">
                </div>
                <div class="form-group">
                    <label class="form-label">Debt Type</label>
                    <select class="form-input">
                        <option>Credit Card</option>
                        <option>Personal Loan</option>
                        <option>Auto Loan</option>
                        <option>Mortgage</option>
                        <option>Student Loan</option>
                        <option>Medical Debt</option>
                        <option>Other</option>
                    </select>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <div class="form-group">
                        <label class="form-label">Current Balance</label>
                        <input type="number" class="form-input" placeholder="0.00">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Interest Rate (APR %)</label>
                        <input type="number" class="form-input" placeholder="0.00" step="0.01">
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <div class="form-group">
                        <label class="form-label">Minimum Payment</label>
                        <input type="number" class="form-input" placeholder="0.00">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Due Date</label>
                        <input type="number" class="form-input" placeholder="Day of month (1-31)" min="1" max="31">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('addDebtModal')">Cancel</button>
                <button class="btn btn-primary" onclick="saveDebt()">
                    <i class="fas fa-save"></i> Save Debt
                </button>
            </div>
        </div>
    </div>

    <!-- Add Account Modal -->
    <div class="modal-overlay" id="addAccountModal">
        <div class="modal">
            <div class="modal-header">
                <h2><i class="fas fa-university"></i> Add Bank Account</h2>
                <button class="modal-close" onclick="closeModal('addAccountModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Account Name</label>
                    <input type="text" class="form-input" placeholder="e.g., Farm Operations Checking">
                </div>
                <div class="form-group">
                    <label class="form-label">Account Type</label>
                    <select class="form-input">
                        <option value="checking">Checking</option>
                        <option value="savings">Savings</option>
                        <option value="investment">Investment</option>
                        <option value="credit">Credit Card</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Institution</label>
                    <input type="text" class="form-input" placeholder="e.g., First National Bank">
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <div class="form-group">
                        <label class="form-label">Current Balance</label>
                        <input type="number" class="form-input" placeholder="0.00">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Last 4 Digits</label>
                        <input type="text" class="form-input" placeholder="1234" maxlength="4">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('addAccountModal')">Cancel</button>
                <button class="btn btn-primary" onclick="saveAccount()">
                    <i class="fas fa-save"></i> Save Account
                </button>
            </div>
        </div>
    </div>

    <!-- Add Bill Modal -->
    <div class="modal-overlay" id="addBillModal">
        <div class="modal">
            <div class="modal-header">
                <h2><i class="fas fa-file-invoice"></i> Add Bill</h2>
                <button class="modal-close" onclick="closeModal('addBillModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Bill Name</label>
                    <input type="text" class="form-input" placeholder="e.g., Electric - PG&E">
                </div>
                <div class="form-group">
                    <label class="form-label">Category</label>
                    <select class="form-input">
                        <option>Utility</option>
                        <option>Insurance</option>
                        <option>Subscription</option>
                        <option>Loan Payment</option>
                        <option>Rent/Mortgage</option>
                        <option>Farm Expense</option>
                        <option>Other</option>
                    </select>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <div class="form-group">
                        <label class="form-label">Amount</label>
                        <input type="number" class="form-input" placeholder="0.00">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Due Day (monthly)</label>
                        <input type="number" class="form-input" placeholder="1-31" min="1" max="31">
                    </div>
                </div>
                <div class="form-group">
                    <div style="display: flex; align-items: center; gap: 1rem;">
                        <input type="checkbox" id="autoPay">
                        <label for="autoPay">Auto-Pay Enabled</label>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('addBillModal')">Cancel</button>
                <button class="btn btn-primary" onclick="saveBill()">
                    <i class="fas fa-save"></i> Save Bill
                </button>
            </div>
        </div>
    </div>

    <!-- Add Marketing Spend Modal -->
    <div class="modal-overlay" id="addMarketingSpendModal">
        <div class="modal">
            <div class="modal-header">
                <h2><i class="fas fa-receipt"></i> Log Marketing Expense</h2>
                <button class="modal-close" onclick="closeModal('addMarketingSpendModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Description</label>
                    <input type="text" class="form-input" id="marketingSpendDesc" placeholder="e.g., Instagram Boost - CSA Promo">
                </div>
                <div class="form-group">
                    <label class="form-label">Category</label>
                    <select class="form-input" id="marketingSpendCategory">
                        <option value="social_ads">Social Media Ads</option>
                        <option value="sms">SMS/Twilio</option>
                        <option value="subscription">Subscriptions (Ayrshare, etc)</option>
                        <option value="print">Print Materials</option>
                        <option value="photography">Photography/Content</option>
                        <option value="events">Events & Sponsorships</option>
                        <option value="direct_mail">Direct Mail</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <div class="form-group">
                        <label class="form-label">Amount</label>
                        <input type="number" class="form-input" id="marketingSpendAmount" placeholder="0.00" step="0.01">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Date</label>
                        <input type="date" class="form-input" id="marketingSpendDate">
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Campaign (Optional)</label>
                    <select class="form-input" id="marketingSpendCampaign">
                        <option value="">-- No Campaign --</option>
                        <option value="csa_spring_2026">CSA Spring 2026</option>
                        <option value="farmers_market">Farmer's Market Promotion</option>
                        <option value="restaurant_outreach">Restaurant Outreach</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Notes</label>
                    <textarea class="form-input" id="marketingSpendNotes" rows="2" placeholder="Optional notes..."></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('addMarketingSpendModal')">Cancel</button>
                <button class="btn btn-primary" onclick="saveMarketingSpend()">
                    <i class="fas fa-save"></i> Log Expense
                </button>
            </div>
        </div>
    </div>

    <!-- Allocate Marketing Funds Modal -->
    <div class="modal-overlay" id="allocateMarketingModal">
        <div class="modal">
            <div class="modal-header">
                <h2><i class="fas fa-hand-holding-usd"></i> Add to Marketing Fund</h2>
                <button class="modal-close" onclick="closeModal('allocateMarketingModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="alert alert-info" style="margin-bottom: 1rem;">
                    <i class="fas fa-info-circle"></i>
                    <div>
                        <strong>Current Balance:</strong> $1,247.00
                        <br><small>Add funds manually or adjust auto-allocation settings</small>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Add One-Time Amount</label>
                    <input type="number" class="form-input" id="marketingFundAmount" placeholder="0.00" step="0.01">
                </div>
                <div class="form-group">
                    <label class="form-label">Source</label>
                    <select class="form-input" id="marketingFundSource">
                        <option value="cash">Cash Transfer</option>
                        <option value="sales">Sales Revenue</option>
                        <option value="grant">Grant/Award</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <hr style="margin: 1.5rem 0; border-color: var(--border);">
                <h4 style="margin-bottom: 1rem;">Auto-Allocation Settings</h4>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <div class="form-group">
                        <label class="form-label">Percentage of Sales</label>
                        <input type="number" class="form-input" id="marketingAutoPercent" value="2" min="0" max="10" step="0.5">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Monthly Cap</label>
                        <input type="number" class="form-input" id="marketingMonthlyCap" placeholder="500" step="50">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('allocateMarketingModal')">Cancel</button>
                <button class="btn btn-primary" onclick="allocateMarketingFunds()">
                    <i class="fas fa-save"></i> Save Changes
                </button>
            </div>
        </div>
    </div>

    <!-- ============================================= -->
    <!-- JAVASCRIPT -->
    <!-- ============================================= -->
    <script>
        // =============================================
        // TAB NAVIGATION
        // =============================================
        function showTab(tabId) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });

            // Remove active from all buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });

            // Show selected tab
            document.getElementById('tab-' + tabId).classList.add('active');

            // Activate button
            event.target.closest('.tab-btn').classList.add('active');
        }

        // =============================================
        // MODAL FUNCTIONS
        // =============================================
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        // Close modal on overlay click
        document.querySelectorAll('.modal-overlay').forEach(overlay => {
            overlay.addEventListener('click', (e) => {
                if (e.target === overlay) {
                    overlay.classList.remove('active');
                }
            });
        });

        // =============================================
        // DEBT DESTROYER FUNCTIONS
        // =============================================
        let currentStrategy = 'avalanche';

        function selectStrategy(strategy) {
            currentStrategy = strategy;
            document.querySelectorAll('.strategy-option').forEach(opt => {
                opt.classList.remove('active');
            });
            event.target.closest('.strategy-option').classList.add('active');
            recalculatePayoff();
        }

        function recalculatePayoff() {
            // This would recalculate the payoff timeline based on strategy
            console.log('Recalculating payoff with strategy:', currentStrategy);
            // In production, this would call the Google Sheets API
        }

        function saveDebt() {
            // Save debt to Google Sheets
            console.log('Saving debt...');
            closeModal('addDebtModal');
            // In production: call Apps Script API
        }

        function editDebt(debtId) {
            console.log('Editing debt:', debtId);
            // Open modal with debt data
        }

        // =============================================
        // BANKING FUNCTIONS
        // =============================================
        function saveAccount() {
            console.log('Saving account...');
            closeModal('addAccountModal');
        }

        function saveBill() {
            console.log('Saving bill...');
            closeModal('addBillModal');
        }

        function handleBankUpload(input) {
            const file = input.files[0];
            if (file) {
                console.log('Uploading bank statement:', file.name);
                // Parse and import transactions
            }
        }

        // =============================================
        // SYNC FUNCTION
        // =============================================
        function syncData() {
            console.log('Syncing with Google Sheets...');
            // In production: call Apps Script API to refresh all data
        }

        // =============================================
        // CHARTS
        // =============================================

        // Financial Health Chart
        const healthCtx = document.getElementById('healthChart');
        if (healthCtx) {
            new Chart(healthCtx.getContext('2d'), {
                type: 'radar',
                data: {
                    labels: ['Emergency Fund', 'Debt-to-Income', 'Savings Rate', 'Investment Growth', 'Cash Flow'],
                    datasets: [{
                        label: 'Your Score',
                        data: [50, 65, 80, 75, 85],
                        backgroundColor: 'rgba(42, 157, 143, 0.2)',
                        borderColor: 'rgba(42, 157, 143, 1)',
                        pointBackgroundColor: 'rgba(42, 157, 143, 1)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgba(42, 157, 143, 1)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: { color: 'rgba(255,255,255,0.1)' },
                            grid: { color: 'rgba(255,255,255,0.1)' },
                            pointLabels: { color: '#8d99ae' },
                            ticks: { display: false },
                            suggestedMin: 0,
                            suggestedMax: 100
                        }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }

        // Allocation Pie Chart
        const allocationCtx = document.getElementById('allocationPieChart');
        if (allocationCtx) {
            const allocationData = [
                { ticker: 'VTI', percent: 15.0, color: '#2a9d8f' },
                { ticker: 'VXUS', percent: 7.5, color: '#264653' },
                { ticker: 'BND', percent: 15.0, color: '#4361ee' },
                { ticker: 'TIP', percent: 11.25, color: '#3a86ff' },
                { ticker: 'GOVT', percent: 7.5, color: '#8338ec' },
                { ticker: 'GLD', percent: 5.625, color: '#ffd700' },
                { ticker: 'DBC', percent: 3.75, color: '#fb8500' },
                { ticker: 'SHY', percent: 7.5, color: '#90be6d' },
                { ticker: 'QQQ', percent: 12.5, color: '#f4a261' },
                { ticker: 'MTUM', percent: 12.5, color: '#e76f51' }
            ];

            new Chart(allocationCtx.getContext('2d'), {
                type: 'doughnut',
                data: {
                    labels: allocationData.map(d => d.ticker),
                    datasets: [{
                        data: allocationData.map(d => d.percent),
                        backgroundColor: allocationData.map(d => d.color),
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    cutout: '65%',
                    plugins: {
                        legend: { display: false }
                    }
                }
            });

            // Populate holdings list
            const holdingsList = document.getElementById('holdings-list');
            allocationData.forEach(item => {
                const div = document.createElement('div');
                div.style.cssText = 'display: flex; align-items: center; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid rgba(255,255,255,0.05);';
                div.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                        <div style="width: 12px; height: 12px; border-radius: 3px; background: ${item.color};"></div>
                        <span style="font-weight: 500;">${item.ticker}</span>
                    </div>
                    <span style="color: var(--text-secondary);">${item.percent}%</span>
                `;
                holdingsList.appendChild(div);
            });
        }

        // =============================================
        // GOOGLE SHEETS API INTEGRATION
        // =============================================
        const API_CONFIG = {
            sheetId: '128O56X_FN9_U-s0ENHBBRyLpae_yvWHPYbBheVlR3Vc',
            apiUrl: 'https://script.google.com/macros/s/AKfycbx8syGK5Bm60fypNO0yE60BYtTFJXxviaEtgrqENmF5GStB58UCEA4Shu_IF9r6kjf5/exec'
        };

        async function fetchFromSheet(endpoint, params = {}) {
            if (!API_CONFIG.apiUrl) {
                console.warn('API URL not configured - using demo data');
                return null;
            }

            try {
                const url = new URL(API_CONFIG.apiUrl);
                url.searchParams.append('action', endpoint);
                Object.entries(params).forEach(([key, value]) => {
                    url.searchParams.append(key, value);
                });

                const response = await fetch(url.toString());
                const data = await response.json();
                return data;
            } catch (error) {
                console.error('API Error:', error);
                return null;
            }
        }

        async function saveToSheet(endpoint, data) {
            if (!API_CONFIG.apiUrl) {
                console.warn('API URL not configured');
                return false;
            }

            try {
                // Use text/plain to avoid CORS preflight
                const response = await fetch(API_CONFIG.apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'text/plain' },
                    body: JSON.stringify({ action: endpoint, data })
                });
                return await response.json();
            } catch (error) {
                console.error('Save Error:', error);
                return false;
            }
        }

        // =============================================
        // DEBT PAYOFF CALCULATOR
        // =============================================
        class DebtPayoffCalculator {
            constructor(debts, extraPayment = 0) {
                this.debts = debts.map(d => ({ ...d })); // Clone
                this.extraPayment = extraPayment;
            }

            avalanche() {
                // Sort by interest rate (highest first)
                return this.debts.sort((a, b) => b.apr - a.apr);
            }

            snowball() {
                // Sort by balance (lowest first)
                return this.debts.sort((a, b) => a.balance - b.balance);
            }

            calculatePayoff(strategy = 'avalanche') {
                const sortedDebts = strategy === 'avalanche' ? this.avalanche() : this.snowball();
                const timeline = [];
                let currentMonth = new Date();
                let totalInterestPaid = 0;

                // Clone debts for calculation
                let remaining = sortedDebts.map(d => ({ ...d }));

                while (remaining.length > 0) {
                    // Apply minimum payments to all debts
                    remaining.forEach(debt => {
                        const monthlyInterest = debt.balance * (debt.apr / 100 / 12);
                        totalInterestPaid += monthlyInterest;
                        debt.balance += monthlyInterest - debt.minPayment;
                    });

                    // Apply extra payment to first debt
                    if (remaining.length > 0) {
                        remaining[0].balance -= this.extraPayment;
                    }

                    // Check for paid off debts
                    remaining = remaining.filter(debt => {
                        if (debt.balance <= 0) {
                            timeline.push({
                                name: debt.name,
                                paidOffDate: new Date(currentMonth),
                                originalBalance: debt.originalBalance
                            });
                            // Roll over freed-up payment
                            this.extraPayment += debt.minPayment;
                            return false;
                        }
                        return true;
                    });

                    currentMonth.setMonth(currentMonth.getMonth() + 1);

                    // Safety: prevent infinite loop
                    if (currentMonth.getFullYear() > 2040) break;
                }

                return {
                    timeline,
                    totalInterestPaid: Math.round(totalInterestPaid * 100) / 100,
                    debtFreeDate: timeline[timeline.length - 1]?.paidOffDate
                };
            }
        }

        // =============================================
        // PLAID BANK CONNECTION
        // =============================================
        let plaidHandler = null;

        async function connectBankWithPlaid() {
            const btn = document.getElementById('plaidConnectBtn');
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Connecting...';
            btn.disabled = true;

            try {
                // Get link token from our Apps Script backend
                const response = await fetchFromSheet('createPlaidLinkToken');

                if (!response || !response.success) {
                    throw new Error(response?.error || 'Failed to create link token');
                }

                // Initialize Plaid Link
                plaidHandler = Plaid.create({
                    token: response.linkToken,
                    onSuccess: async (publicToken, metadata) => {
                        console.log('Plaid Link Success!', metadata);
                        await handlePlaidSuccess(publicToken, metadata);
                    },
                    onExit: (err, metadata) => {
                        console.log('Plaid Link Exit', err, metadata);
                        btn.innerHTML = '<i class="fas fa-link"></i> Connect Bank';
                        btn.disabled = false;
                        if (err) {
                            showNotification('Bank connection cancelled', 'warning');
                        }
                    },
                    onEvent: (eventName, metadata) => {
                        console.log('Plaid Event:', eventName, metadata);
                    }
                });

                // Open Plaid Link
                plaidHandler.open();

            } catch (error) {
                console.error('Plaid Error:', error);
                showNotification('Failed to connect: ' + error.message, 'error');
                btn.innerHTML = '<i class="fas fa-link"></i> Connect Bank';
                btn.disabled = false;
            }
        }

        async function handlePlaidSuccess(publicToken, metadata) {
            const btn = document.getElementById('plaidConnectBtn');
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Syncing accounts...';

            try {
                // Exchange public token via GET to avoid CORS preflight
                const params = new URLSearchParams({
                    action: 'exchangePlaidPublicToken',
                    publicToken: publicToken,
                    institutionId: metadata.institution.institution_id,
                    institutionName: metadata.institution.name,
                    accounts: JSON.stringify(metadata.accounts)
                });

                const response = await fetch(`${API_CONFIG.apiUrl}?${params.toString()}`);
                const exchangeResult = await response.json();

                if (!exchangeResult || !exchangeResult.success) {
                    throw new Error(exchangeResult?.error || 'Failed to exchange token');
                }

                showNotification(`Connected to ${metadata.institution.name}!`, 'success');

                // Refresh the accounts display
                await loadConnectedAccounts();

                btn.innerHTML = '<i class="fas fa-link"></i> Connect Bank';
                btn.disabled = false;

            } catch (error) {
                console.error('Token Exchange Error:', error);
                showNotification('Failed to save connection: ' + error.message, 'error');
                btn.innerHTML = '<i class="fas fa-link"></i> Connect Bank';
                btn.disabled = false;
            }
        }

        async function loadConnectedAccounts() {
            try {
                const accounts = await fetchFromSheet('getPlaidAccounts');

                if (accounts && accounts.success && accounts.accounts) {
                    displayPlaidAccounts(accounts.accounts);
                }
            } catch (error) {
                console.error('Failed to load accounts:', error);
            }
        }

        function displayPlaidAccounts(accounts) {
            const cardBody = document.querySelector('.card:has(.fa-university) .card-body');
            if (!cardBody) return;

            // Find or create the connected accounts section
            let connectedSection = document.getElementById('plaidAccountsSection');
            if (!connectedSection) {
                connectedSection = document.createElement('div');
                connectedSection.id = 'plaidAccountsSection';
                connectedSection.innerHTML = '<h4 style="margin: 1rem 0 0.5rem; font-size: 0.85rem; color: var(--text-secondary);"><i class="fas fa-check-circle" style="color: var(--success);"></i> Connected via Plaid</h4>';
                cardBody.insertBefore(connectedSection, cardBody.firstChild);
            }

            // Clear existing accounts (except header)
            const header = connectedSection.querySelector('h4');
            connectedSection.innerHTML = '';
            connectedSection.appendChild(header);

            // Add each account
            accounts.forEach(account => {
                const accountDiv = document.createElement('div');
                accountDiv.className = 'account-card ' + (account.subtype || 'checking');

                const iconMap = {
                    'checking': 'fa-money-check-alt',
                    'savings': 'fa-piggy-bank',
                    'credit card': 'fa-credit-card',
                    'loan': 'fa-file-invoice-dollar',
                    'investment': 'fa-chart-line'
                };
                const icon = iconMap[account.subtype] || 'fa-university';
                const iconColor = account.subtype === 'credit card' ? 'var(--danger)' :
                                  account.subtype === 'savings' ? 'var(--success)' : 'var(--info)';

                accountDiv.innerHTML = `
                    <div class="account-icon" style="color: ${iconColor};">
                        <i class="fas ${icon}"></i>
                    </div>
                    <div class="account-info">
                        <div class="account-name">${account.name}</div>
                        <div class="account-type">${account.institution} - ****${account.mask || '----'}</div>
                    </div>
                    <div class="account-balance">
                        <div class="amount" style="color: ${account.subtype === 'credit card' ? 'var(--danger)' : 'var(--success)'};">
                            $${Math.abs(account.balance_current || 0).toLocaleString()}
                        </div>
                        <div class="label">${account.subtype === 'credit card' ? 'Owed' : 'Available'}</div>
                    </div>
                `;
                connectedSection.appendChild(accountDiv);
            });
        }

        async function refreshPlaidBalances() {
            showNotification('Refreshing balances...', 'info');

            try {
                const result = await fetchFromSheet('refreshPlaidBalances');
                if (result && result.success) {
                    await loadConnectedAccounts();
                    showNotification('Balances updated!', 'success');
                }
            } catch (error) {
                showNotification('Failed to refresh: ' + error.message, 'error');
            }
        }

        function showNotification(message, type = 'info') {
            // Create notification element if it doesn't exist
            let notification = document.getElementById('notification');
            if (!notification) {
                notification = document.createElement('div');
                notification.id = 'notification';
                notification.style.cssText = `
                    position: fixed;
                    top: 80px;
                    right: 20px;
                    padding: 1rem 1.5rem;
                    border-radius: 8px;
                    font-weight: 500;
                    z-index: 1000;
                    transform: translateX(150%);
                    transition: transform 0.3s ease;
                    max-width: 350px;
                `;
                document.body.appendChild(notification);
            }

            const colors = {
                success: { bg: 'var(--success)', icon: 'fa-check-circle' },
                error: { bg: 'var(--danger)', icon: 'fa-exclamation-circle' },
                warning: { bg: 'var(--warning)', icon: 'fa-exclamation-triangle' },
                info: { bg: 'var(--info)', icon: 'fa-info-circle' }
            };

            const config = colors[type] || colors.info;
            notification.style.background = config.bg;
            notification.innerHTML = `<i class="fas ${config.icon}"></i> ${message}`;
            notification.style.transform = 'translateX(0)';

            setTimeout(() => {
                notification.style.transform = 'translateX(150%)';
            }, 4000);
        }

        // =============================================
        // MARKETING FUNCTIONS
        // =============================================
        const MARKETING_API_URL = 'https://script.google.com/macros/s/AKfycbx8syGK5Bm60fypNO0yE60BYtTFJXxviaEtgrqENmF5GStB58UCEA4Shu_IF9r6kjf5/exec';

        async function loadMarketingData() {
            try {
                // Load budget data
                const budgetResponse = await fetch(`${MARKETING_API_URL}?action=getMarketingBudget`);
                const budgetData = await budgetResponse.json();

                // Load spend data
                const spendResponse = await fetch(`${MARKETING_API_URL}?action=getMarketingSpend&month=${new Date().getMonth() + 1}&year=${new Date().getFullYear()}`);
                const spendData = await spendResponse.json();

                // Load analytics
                const analyticsResponse = await fetch(`${MARKETING_API_URL}?action=getMarketingAnalytics`);
                const analyticsData = await analyticsResponse.json();

                if (budgetData.success) {
                    updateMarketingBudgetDisplay(budgetData.data);
                }

                if (spendData.success) {
                    updateMarketingSpendDisplay(spendData.data);
                }

                if (analyticsData.success) {
                    updateMarketingAnalyticsDisplay(analyticsData.data);
                }

                showNotification('Marketing data refreshed', 'success');
            } catch (error) {
                console.error('Error loading marketing data:', error);
                showNotification('Error loading marketing data - using demo values', 'warning');
            }
        }

        function updateMarketingBudgetDisplay(data) {
            if (!data) return;

            const budget = data.monthly_budget || 500;
            const spent = data.spent_this_month || 0;
            const remaining = budget - spent;
            const percentUsed = Math.round((spent / budget) * 100);

            document.getElementById('marketing-budget').textContent = `$${budget.toLocaleString()}`;
            document.getElementById('marketing-spent').textContent = `$${spent.toLocaleString()}`;
            document.getElementById('marketing-remaining').textContent = `$${remaining.toLocaleString()} remaining`;
            document.getElementById('marketing-spent-percent').textContent = `${percentUsed}% used`;

            const progressBar = document.getElementById('marketing-progress');
            progressBar.style.width = `${Math.min(percentUsed, 100)}%`;
            progressBar.classList.remove('success', 'warning', 'danger');
            progressBar.classList.add(percentUsed < 50 ? 'success' : percentUsed < 80 ? 'warning' : 'danger');
        }

        function updateMarketingSpendDisplay(data) {
            if (!data || !data.transactions) return;

            const historyContainer = document.getElementById('marketing-spend-history');
            if (historyContainer && data.transactions.length > 0) {
                historyContainer.innerHTML = data.transactions.slice(0, 10).map(t => `
                    <div class="alert" style="margin-bottom: 0.5rem;">
                        <i class="fas ${getCategoryIcon(t.category)}" style="color: ${getCategoryColor(t.category)};"></i>
                        <div style="flex: 1;">
                            <div style="font-weight: 500;">${t.description}</div>
                            <div style="font-size: 0.8rem; color: var(--text-secondary);">${formatDate(t.date)}</div>
                        </div>
                        <span style="font-weight: 600; color: var(--danger);">-$${parseFloat(t.amount).toFixed(2)}</span>
                    </div>
                `).join('');
            }

            // Update category breakdown
            if (data.by_category) {
                const catContainer = document.getElementById('marketing-spend-categories');
                const categories = [
                    { key: 'social_ads', name: 'Social Media Ads', color: '#E1306C' },
                    { key: 'subscription', name: 'Ayrshare Subscription', color: '#3b5998' },
                    { key: 'print', name: 'Print Materials', color: '#2ecc71' },
                    { key: 'photography', name: 'Photography/Content', color: '#9b59b6' }
                ];

                catContainer.innerHTML = categories.map(cat => `
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.75rem 0; border-bottom: 1px solid var(--border);">
                        <div style="display: flex; align-items: center; gap: 0.75rem;">
                            <div style="width: 12px; height: 12px; background: ${cat.color}; border-radius: 50%;"></div>
                            <span>${cat.name}</span>
                        </div>
                        <span style="font-weight: 600;">$${(data.by_category[cat.key] || 0).toFixed(2)}</span>
                    </div>
                `).join('');
            }
        }

        function updateMarketingAnalyticsDisplay(data) {
            if (!data) return;

            if (data.roi !== undefined) {
                const roiEl = document.getElementById('marketing-roi');
                roiEl.textContent = (data.roi >= 0 ? '+' : '') + data.roi + '%';
                roiEl.classList.toggle('positive', data.roi >= 0);
                roiEl.classList.toggle('negative', data.roi < 0);
            }

            if (data.posts_this_month !== undefined) {
                document.getElementById('marketing-posts').textContent = data.posts_this_month;
            }
        }

        function getCategoryIcon(category) {
            const icons = {
                'social_ads': 'fa-ad',
                'subscription': 'fa-sync-alt',
                'print': 'fa-print',
                'photography': 'fa-camera',
                'events': 'fa-calendar-alt',
                'direct_mail': 'fa-envelope',
                'sms': 'fa-sms'
            };
            return icons[category] || 'fa-receipt';
        }

        function getCategoryColor(category) {
            const colors = {
                'social_ads': '#E1306C',
                'subscription': '#3b5998',
                'print': '#2ecc71',
                'photography': '#9b59b6',
                'events': '#e67e22',
                'direct_mail': '#3498db',
                'sms': '#2a9d8f'
            };
            return colors[category] || '#95a5a6';
        }

        function formatDate(dateStr) {
            if (!dateStr) return '';
            const date = new Date(dateStr);
            return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
        }

        async function saveMarketingSpend() {
            const description = document.getElementById('marketingSpendDesc').value;
            const category = document.getElementById('marketingSpendCategory').value;
            const amount = parseFloat(document.getElementById('marketingSpendAmount').value);
            const date = document.getElementById('marketingSpendDate').value || new Date().toISOString().split('T')[0];
            const campaign = document.getElementById('marketingSpendCampaign').value;
            const notes = document.getElementById('marketingSpendNotes').value;

            if (!description || !amount) {
                showNotification('Please enter description and amount', 'warning');
                return;
            }

            try {
                const response = await fetch(MARKETING_API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'text/plain' },
                    body: JSON.stringify({
                        action: 'logMarketingSpend',
                        description,
                        category,
                        amount,
                        date,
                        campaign,
                        notes
                    })
                });

                const result = await response.json();

                if (result.success) {
                    showNotification('Marketing expense logged', 'success');
                    closeModal('addMarketingSpendModal');
                    loadMarketingData();

                    // Clear form
                    document.getElementById('marketingSpendDesc').value = '';
                    document.getElementById('marketingSpendAmount').value = '';
                    document.getElementById('marketingSpendNotes').value = '';
                } else {
                    showNotification(result.error || 'Error logging expense', 'error');
                }
            } catch (error) {
                console.error('Error saving marketing spend:', error);
                showNotification('Error logging expense', 'error');
            }
        }

        async function allocateMarketingFunds() {
            const amount = parseFloat(document.getElementById('marketingFundAmount').value) || 0;
            const source = document.getElementById('marketingFundSource').value;
            const autoPercent = parseFloat(document.getElementById('marketingAutoPercent').value);
            const monthlyCap = parseFloat(document.getElementById('marketingMonthlyCap').value);

            try {
                // Log the fund allocation
                if (amount > 0) {
                    const response = await fetch(MARKETING_API_URL, {
                        method: 'POST',
                        headers: { 'Content-Type': 'text/plain' },
                        body: JSON.stringify({
                            action: 'logMarketingActivity',
                            type: 'fund_allocation',
                            data: { amount, source, autoPercent, monthlyCap }
                        })
                    });

                    const result = await response.json();

                    if (result.success) {
                        showNotification(`$${amount.toFixed(2)} added to marketing fund`, 'success');
                    }
                }

                closeModal('allocateMarketingModal');
                loadMarketingData();
            } catch (error) {
                console.error('Error allocating marketing funds:', error);
                showNotification('Settings saved locally', 'success');
                closeModal('allocateMarketingModal');
            }
        }

        // =============================================
        // INITIALIZE
        // =============================================
        document.addEventListener('DOMContentLoaded', () => {
            console.log('Tiny Seed Financial Dashboard initialized');

            // Check for API connection
            if (!API_CONFIG.apiUrl) {
                console.log('Running in demo mode - configure API URL for live data');
            }

            // Load connected Plaid accounts if API is configured
            if (API_CONFIG.apiUrl) {
                loadConnectedAccounts();
            }
        });
    </script>
</body>
</html>
