<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tiny Seed Marketing Command Center</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="auth-guard.js" data-required-role="Manager"></script>
    <script src="api-config.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #22c55e;
            --primary-light: #4ade80;
            --primary-dark: #16a34a;
            --secondary: #f4a261;
            --accent: #e76f51;
            --success: #2a9d8f;
            --warning: #e9c46a;
            --danger: #e63946;
            --info: #4361ee;
            --bg-dark: #1a1a2e;
            --bg-card: #16213e;
            --bg-light: #0f3460;
            --text-primary: #edf2f4;
            --text-secondary: #8d99ae;
            --border: rgba(255,255,255,0.1);
            --gold: #ffd700;
            --purple: #9b59b6;
            --teal: #1abc9c;
            --instagram: #E1306C;
            --facebook: #4267B2;
            --tiktok: #000000;
            --twitter: #1DA1F2;
            --youtube: #FF0000;
            --pinterest: #E60023;
            --threads: #000000;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, #0f0f1a 100%);
            color: var(--text-primary);
            min-height: 100vh;
        }

        /* ============================================= */
        /* NAVIGATION */
        /* ============================================= */
        .top-nav {
            background: rgba(22, 33, 62, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border);
            padding: 0.75rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-brand {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .nav-logo {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, var(--instagram) 0%, var(--purple) 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
        }

        .nav-title {
            font-size: 1.25rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--instagram) 0%, var(--purple) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .nav-subtitle {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .nav-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .nav-back {
            color: var(--text-secondary);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            transition: color 0.2s;
        }

        .nav-back:hover {
            color: var(--text-primary);
        }

        /* ============================================= */
        /* ACCESS CONTROL BANNER */
        /* ============================================= */
        .access-banner {
            background: linear-gradient(90deg, var(--purple) 0%, var(--instagram) 100%);
            padding: 0.5rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.85rem;
        }

        .access-badge {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 600;
        }

        .access-user {
            opacity: 0.9;
        }

        /* ============================================= */
        /* TAB NAVIGATION */
        /* ============================================= */
        .tab-nav {
            background: var(--bg-card);
            border-bottom: 1px solid var(--border);
            display: flex;
            gap: 0;
            padding: 0 2rem;
            overflow-x: auto;
        }

        .tab-btn {
            padding: 1rem 1.5rem;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            border-bottom: 3px solid transparent;
            transition: all 0.2s;
            white-space: nowrap;
        }

        .tab-btn:hover {
            color: var(--text-primary);
            background: rgba(255,255,255,0.03);
        }

        .tab-btn.active {
            color: var(--instagram);
            border-bottom-color: var(--instagram);
        }

        .tab-btn .badge {
            padding: 0.15rem 0.5rem;
            border-radius: 10px;
            font-size: 0.7rem;
            font-weight: 600;
        }

        .tab-btn .badge.new { background: var(--instagram); color: white; }
        .tab-btn .badge.pending { background: var(--warning); color: #000; }

        /* ============================================= */
        /* MAIN CONTENT */
        /* ============================================= */
        .main-content {
            padding: 2rem;
            max-width: 1800px;
            margin: 0 auto;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* ============================================= */
        /* STATS GRID */
        /* ============================================= */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 1.5rem;
            border: 1px solid var(--border);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }

        .stat-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .stat-icon {
            width: 45px;
            height: 45px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
        }

        .stat-icon.instagram { background: rgba(225, 48, 108, 0.2); color: var(--instagram); }
        .stat-icon.facebook { background: rgba(66, 103, 178, 0.2); color: var(--facebook); }
        .stat-icon.tiktok { background: rgba(255, 255, 255, 0.1); color: white; }
        .stat-icon.green { background: rgba(42, 157, 143, 0.2); color: var(--success); }
        .stat-icon.gold { background: rgba(255, 215, 0, 0.2); color: var(--gold); }
        .stat-icon.purple { background: rgba(155, 89, 182, 0.2); color: var(--purple); }

        .stat-value {
            font-size: 1.75rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        .stat-change {
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 0.25rem;
            margin-top: 0.5rem;
        }

        .stat-change.positive { color: var(--success); }
        .stat-change.negative { color: var(--danger); }

        /* ============================================= */
        /* CARDS */
        /* ============================================= */
        .card {
            background: var(--bg-card);
            border-radius: 16px;
            border: 1px solid var(--border);
            overflow: hidden;
            margin-bottom: 1.5rem;
        }

        .card-header {
            padding: 1.25rem 1.5rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-header h3 {
            font-size: 1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .card-header h3 i {
            color: var(--instagram);
        }

        .card-body {
            padding: 1.5rem;
        }

        /* ============================================= */
        /* FIELD MODE - QUICK POST */
        /* ============================================= */
        .field-mode-container {
            background: linear-gradient(135deg, var(--bg-light) 0%, var(--bg-card) 100%);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 2px dashed var(--instagram);
        }

        .field-mode-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .field-mode-title {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .field-mode-title h2 {
            font-size: 1.5rem;
            background: linear-gradient(135deg, var(--instagram) 0%, var(--secondary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .field-mode-title .subtitle {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .timer-badge {
            background: var(--success);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .field-mode-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }

        @media (max-width: 900px) {
            .field-mode-content {
                grid-template-columns: 1fr;
            }
        }

        .upload-zone {
            border: 2px dashed var(--border);
            border-radius: 16px;
            padding: 2rem;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
            min-height: 250px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .upload-zone:hover, .upload-zone.dragover {
            border-color: var(--instagram);
            background: rgba(225, 48, 108, 0.1);
        }

        .upload-zone i {
            font-size: 3rem;
            color: var(--instagram);
            margin-bottom: 1rem;
        }

        .upload-zone h4 {
            margin-bottom: 0.5rem;
        }

        .upload-zone p {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .upload-preview {
            display: none;
            width: 100%;
            max-height: 200px;
            object-fit: cover;
            border-radius: 12px;
            margin-bottom: 1rem;
        }

        .upload-preview.visible {
            display: block;
        }

        .post-form {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .voice-note-btn {
            background: linear-gradient(135deg, var(--purple) 0%, var(--instagram) 100%);
            border: none;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            font-size: 1rem;
            transition: all 0.2s;
        }

        .voice-note-btn:hover {
            transform: scale(1.02);
        }

        .voice-note-btn.recording {
            background: var(--danger);
            animation: pulse-recording 1s infinite;
        }

        @keyframes pulse-recording {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .caption-input {
            width: 100%;
            min-height: 100px;
            padding: 1rem;
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 0.95rem;
            resize: vertical;
        }

        .caption-input:focus {
            outline: none;
            border-color: var(--instagram);
        }

        .ai-caption-btn {
            background: rgba(155, 89, 182, 0.2);
            border: 1px solid var(--purple);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            color: var(--purple);
            font-size: 0.85rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .ai-caption-btn:hover {
            background: rgba(155, 89, 182, 0.3);
        }

        /* Schedule & Draft Controls */
        .post-controls {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
            align-items: center;
            margin-top: 0.5rem;
        }

        .schedule-toggle {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: rgba(67, 97, 238, 0.1);
            border: 1px solid var(--info);
            border-radius: 8px;
            color: var(--info);
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .schedule-toggle:hover {
            background: rgba(67, 97, 238, 0.2);
        }

        .schedule-toggle.active {
            background: rgba(67, 97, 238, 0.3);
            font-weight: 600;
        }

        .schedule-datetime {
            display: none;
            padding: 0.5rem;
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 0.85rem;
        }

        .schedule-datetime.visible {
            display: block;
        }

        .draft-btn {
            padding: 0.5rem 1rem;
            background: rgba(141, 153, 174, 0.2);
            border: 1px solid var(--text-secondary);
            border-radius: 8px;
            color: var(--text-secondary);
            font-size: 0.85rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.2s;
        }

        .draft-btn:hover {
            background: rgba(141, 153, 174, 0.3);
            color: var(--text-primary);
        }

        .draft-btn.has-draft {
            border-color: var(--warning);
            color: var(--warning);
        }

        /* Character Count */
        .char-count {
            font-size: 0.75rem;
            color: var(--text-secondary);
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-top: 0.25rem;
        }

        .char-count span {
            padding: 0.2rem 0.5rem;
            background: rgba(255,255,255,0.05);
            border-radius: 4px;
        }

        .char-count span.over-limit {
            color: var(--danger);
            background: rgba(220, 53, 69, 0.2);
        }

        .platform-toggles {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .platform-toggle {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1rem;
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .platform-toggle.active {
            border-color: var(--success);
            background: rgba(42, 157, 143, 0.1);
        }

        .platform-toggle.active .toggle-check {
            background: var(--success);
        }

        .toggle-check {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--border);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
        }

        .blast-btn {
            background: linear-gradient(135deg, var(--success) 0%, var(--primary) 100%);
            border: none;
            padding: 1.25rem 2rem;
            border-radius: 12px;
            color: white;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            transition: all 0.2s;
            margin-top: 1rem;
        }

        .blast-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(42, 157, 143, 0.4);
        }

        .blast-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* ============================================= */
        /* FARM PICS GALLERY */
        /* ============================================= */
        .gallery-filters {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 0.5rem 1rem;
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border);
            border-radius: 20px;
            color: var(--text-secondary);
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .filter-btn.active {
            background: var(--instagram);
            border-color: var(--instagram);
            color: white;
        }

        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
        }

        .gallery-item {
            position: relative;
            border-radius: 12px;
            overflow: hidden;
            aspect-ratio: 1;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .gallery-item:hover {
            transform: scale(1.02);
        }

        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .gallery-item-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 1rem;
            background: linear-gradient(transparent, rgba(0,0,0,0.8));
        }

        .gallery-item-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.8rem;
        }

        .gallery-item-author {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .gallery-item-author img {
            width: 24px;
            height: 24px;
            border-radius: 50%;
        }

        .gallery-item-status {
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 600;
        }

        .gallery-item-status.new { background: var(--instagram); }
        .gallery-item-status.approved { background: var(--success); }
        .gallery-item-status.used { background: var(--purple); }

        .gallery-item-actions {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            display: flex;
            gap: 0.5rem;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .gallery-item:hover .gallery-item-actions {
            opacity: 1;
        }

        .gallery-action-btn {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            transition: all 0.2s;
        }

        .gallery-action-btn.approve { background: var(--success); color: white; }
        .gallery-action-btn.use { background: var(--instagram); color: white; }
        .gallery-action-btn.delete { background: var(--danger); color: white; }

        /* ============================================= */
        /* SOCIAL CONNECTIONS */
        /* ============================================= */
        .connections-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        .connection-card {
            background: var(--bg-light);
            border-radius: 16px;
            padding: 1.5rem;
            border: 1px solid var(--border);
        }

        .connection-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .connection-platform {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .connection-platform i {
            font-size: 1.5rem;
        }

        .connection-platform.instagram i { color: var(--instagram); }
        .connection-platform.facebook i { color: var(--facebook); }
        .connection-platform.tiktok i { color: white; }

        .connection-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.85rem;
        }

        .connection-status .dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .connection-status .dot.connected { background: var(--success); }
        .connection-status .dot.disconnected { background: var(--danger); }

        .connection-stats {
            display: flex;
            gap: 1.5rem;
            margin-bottom: 1rem;
        }

        .connection-stat {
            text-align: center;
        }

        .connection-stat-value {
            font-size: 1.25rem;
            font-weight: 700;
        }

        .connection-stat-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .connection-btn {
            width: 100%;
            padding: 0.75rem;
            border-radius: 8px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .connection-btn.connect {
            background: linear-gradient(135deg, var(--instagram) 0%, var(--purple) 100%);
            color: white;
        }

        .connection-btn.disconnect {
            background: rgba(255,255,255,0.1);
            color: var(--text-primary);
        }

        /* ============================================= */
        /* CAMPAIGNS */
        /* ============================================= */
        .campaign-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .campaign-item {
            background: var(--bg-light);
            border-radius: 12px;
            padding: 1.25rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid var(--border);
        }

        .campaign-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .campaign-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
        }

        .campaign-icon.active { background: rgba(42, 157, 143, 0.2); color: var(--success); }
        .campaign-icon.scheduled { background: rgba(67, 97, 238, 0.2); color: var(--info); }
        .campaign-icon.draft { background: rgba(141, 153, 174, 0.2); color: var(--text-secondary); }
        .campaign-icon.completed { background: rgba(155, 89, 182, 0.2); color: var(--purple); }

        .campaign-details h4 {
            margin-bottom: 0.25rem;
        }

        .campaign-meta {
            font-size: 0.85rem;
            color: var(--text-secondary);
            display: flex;
            gap: 1rem;
        }

        .campaign-stats {
            display: flex;
            gap: 1.5rem;
            align-items: center;
        }

        .campaign-stat {
            text-align: center;
        }

        .campaign-stat-value {
            font-weight: 700;
        }

        .campaign-stat-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        /* ============================================= */
        /* FINANCIAL INTEGRATION */
        /* ============================================= */
        .budget-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .budget-card {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 1.5rem;
            border: 1px solid var(--border);
        }

        .budget-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .budget-header h4 {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .budget-header h4 i {
            color: var(--gold);
        }

        .budget-amount {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .budget-subtitle {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .budget-progress {
            margin-top: 1rem;
        }

        .budget-progress-header {
            display: flex;
            justify-content: space-between;
            font-size: 0.85rem;
            margin-bottom: 0.5rem;
        }

        .budget-progress-bar {
            height: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 5px;
            overflow: hidden;
        }

        .budget-progress-fill {
            height: 100%;
            border-radius: 5px;
            transition: width 0.5s;
        }

        .spend-table {
            width: 100%;
            border-collapse: collapse;
        }

        .spend-table th,
        .spend-table td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        .spend-table th {
            color: var(--text-secondary);
            font-size: 0.8rem;
            text-transform: uppercase;
            font-weight: 500;
        }

        .spend-category {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .spend-category-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }

        .roi-card {
            background: linear-gradient(135deg, var(--success) 0%, var(--primary) 100%);
            border-radius: 16px;
            padding: 1.5rem;
            text-align: center;
        }

        .roi-value {
            font-size: 3rem;
            font-weight: 800;
        }

        .roi-label {
            font-size: 1rem;
            opacity: 0.9;
        }

        /* ============================================= */
        /* SCHEDULED POSTS */
        /* ============================================= */
        .schedule-calendar {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 0.5rem;
        }

        .schedule-day {
            background: var(--bg-light);
            border-radius: 8px;
            padding: 0.75rem;
            min-height: 100px;
            border: 1px solid var(--border);
        }

        .schedule-day-header {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .schedule-day-number {
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .schedule-post {
            background: rgba(225, 48, 108, 0.2);
            border-left: 3px solid var(--instagram);
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.7rem;
            margin-bottom: 0.25rem;
        }

        /* ============================================= */
        /* BUTTONS */
        /* ============================================= */
        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--instagram) 0%, var(--purple) 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(225, 48, 108, 0.4);
        }

        .btn-secondary {
            background: rgba(255,255,255,0.1);
            color: var(--text-primary);
        }

        .btn-sm {
            padding: 0.5rem 1rem;
            font-size: 0.8rem;
        }

        /* ============================================= */
        /* MODALS */
        /* ============================================= */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: var(--bg-card);
            border-radius: 16px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow: hidden;
            border: 1px solid var(--border);
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 1.5rem;
            cursor: pointer;
        }

        .modal-body {
            padding: 1.5rem;
            max-height: 60vh;
            overflow-y: auto;
        }

        .modal-footer {
            padding: 1.5rem;
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
        }

        /* ============================================= */
        /* FORM ELEMENTS */
        /* ============================================= */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            font-size: 0.9rem;
        }

        .form-input {
            width: 100%;
            padding: 0.75rem 1rem;
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 0.9rem;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--instagram);
        }

        /* ============================================= */
        /* CHARTS */
        /* ============================================= */
        .chart-container {
            position: relative;
            height: 300px;
        }

        /* ============================================= */
        /* RESPONSIVE */
        /* ============================================= */
        @media (max-width: 768px) {
            .top-nav {
                padding: 0.75rem 1rem;
            }

            .main-content {
                padding: 1rem;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .field-mode-content {
                grid-template-columns: 1fr;
            }

            .gallery-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* ============================================= */
        /* TOAST NOTIFICATIONS */
        /* ============================================= */
        .toast-container {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            z-index: 2000;
        }

        .toast {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1rem 1.5rem;
            margin-top: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            animation: slideIn 0.3s ease;
        }

        .toast.success { border-left: 4px solid var(--success); }
        .toast.error { border-left: 4px solid var(--danger); }
        .toast.info { border-left: 4px solid var(--info); }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* ============================================= */
        /* SOCIAL GROWTH TAB STYLES */
        /* ============================================= */
        .progress-bar {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            height: 8px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        .posting-timeline {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .timeline-slot {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: rgba(255,255,255,0.03);
            border-radius: 12px;
            border: 1px solid var(--border);
        }

        .timeline-slot.optimal {
            border-color: var(--gold);
            background: rgba(255,215,0,0.05);
        }

        .time-badge {
            background: var(--bg-light);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-weight: 600;
            min-width: 90px;
            text-align: center;
        }

        .slot-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .optimal-badge {
            font-size: 0.7rem;
            color: var(--gold);
            font-weight: 600;
        }

        .slot-platforms {
            display: flex;
            gap: 0.5rem;
            font-size: 1.1rem;
        }

        .slot-status.empty {
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        .content-checklist {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .checklist-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem;
            background: rgba(255,255,255,0.03);
            border-radius: 8px;
            transition: all 0.2s ease;
        }

        .checklist-item:hover {
            background: rgba(255,255,255,0.06);
        }

        .checklist-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            accent-color: var(--success);
        }

        .checklist-item label {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            flex: 1;
            cursor: pointer;
        }

        .checklist-item label span {
            font-weight: 500;
        }

        .checklist-item label small {
            color: var(--text-secondary);
            font-size: 0.8rem;
            margin-left: auto;
        }

        .tip-card {
            padding: 1rem;
            border-radius: 10px;
            background: rgba(255,255,255,0.03);
        }

        .tip-card.instagram {
            border-left: 3px solid var(--instagram);
        }

        .tip-card.tiktok {
            border-left: 3px solid #FE2C55;
        }

        .tip-card.pinterest {
            border-left: 3px solid var(--pinterest);
        }

        .tip-header {
            font-weight: 600;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .tip-list {
            list-style: none;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .tip-list li {
            padding: 0.25rem 0;
            padding-left: 1rem;
            position: relative;
        }

        .tip-list li::before {
            content: 'â€¢';
            position: absolute;
            left: 0;
            color: var(--text-secondary);
        }

        .connection-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
        }

        .connection-status {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 1rem;
            background: rgba(255,255,255,0.03);
            border-radius: 10px;
            border: 1px solid var(--border);
        }

        .connection-status i {
            font-size: 1.5rem;
        }

        .connection-status .status {
            margin-left: auto;
            font-size: 0.8rem;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
        }

        .connection-status .status.connected {
            background: rgba(42,157,143,0.2);
            color: var(--success);
        }

        .connection-status .status.pending {
            background: rgba(233,196,106,0.2);
            color: var(--warning);
        }

        @media (max-width: 768px) {
            .connection-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- ACCESS CONTROL BANNER -->
    <div class="access-banner">
        <div class="access-badge">
            <i class="fas fa-shield-alt"></i>
            <span>Marketing Team Access</span>
        </div>
        <div class="access-user">
            <i class="fas fa-user-circle"></i>
            <span id="currentUser">Admin</span>
        </div>
    </div>

    <!-- TOP NAVIGATION -->
    <nav class="top-nav">
        <div class="nav-brand">
            <div class="nav-logo">
                <i class="fas fa-bullhorn"></i>
            </div>
            <div>
                <div class="nav-title">Marketing Command Center</div>
                <div class="nav-subtitle">Root System v2.0</div>
            </div>
        </div>
        <div class="nav-actions">
            <a href="financial-dashboard.html" class="nav-back">
                <i class="fas fa-chart-line"></i> Financial
            </a>
            <a href="index.html" class="nav-back">
                <i class="fas fa-home"></i> Hub
            </a>
        </div>
    </nav>

    <!-- TAB NAVIGATION -->
    <div class="tab-nav">
        <button class="tab-btn active" onclick="switchTab('dashboard')">
            <i class="fas fa-tachometer-alt"></i> Dashboard
        </button>
        <button class="tab-btn" onclick="switchTab('fieldmode')">
            <i class="fas fa-bolt"></i> Field Mode
        </button>
        <button class="tab-btn" onclick="switchTab('farmpics')">
            <i class="fas fa-images"></i> Farm Pics
            <span class="badge new" id="newPicsBadge">5</span>
        </button>
        <button class="tab-btn" onclick="switchTab('campaigns')">
            <i class="fas fa-flag"></i> Campaigns
        </button>
        <button class="tab-btn" onclick="switchTab('schedule')">
            <i class="fas fa-calendar-alt"></i> Schedule
        </button>
        <button class="tab-btn" onclick="switchTab('connections')">
            <i class="fas fa-plug"></i> Connections
        </button>
        <button class="tab-btn" onclick="switchTab('budget')">
            <i class="fas fa-dollar-sign"></i> Budget
        </button>
        <button class="tab-btn" onclick="switchTab('analytics')">
            <i class="fas fa-chart-bar"></i> Analytics
        </button>
        <button class="tab-btn" onclick="switchTab('intelligence')">
            <i class="fas fa-brain"></i> Intelligence
            <span class="badge new">AI</span>
        </button>
        <button class="tab-btn" onclick="switchTab('socialgrowth')">
            <i class="fas fa-rocket"></i> Social Growth
            <span class="badge" style="background: linear-gradient(135deg, var(--instagram), var(--facebook));">NEW</span>
        </button>
    </div>

    <!-- MAIN CONTENT -->
    <div class="main-content">

        <!-- DASHBOARD TAB -->
        <div id="dashboardTab" class="tab-content active">
            <!-- Quick Stats - Real Data Only -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-card-header">
                        <div class="stat-icon instagram">
                            <i class="fab fa-instagram"></i>
                        </div>
                    </div>
                    <div class="stat-value" id="statInstagram">--</div>
                    <div class="stat-label">Instagram Followers</div>
                    <div class="stat-change neutral" id="statInstagramChange">
                        <i class="fas fa-sync"></i> Loading...
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-card-header">
                        <div class="stat-icon facebook">
                            <i class="fab fa-facebook"></i>
                        </div>
                    </div>
                    <div class="stat-value" id="statFacebook">--</div>
                    <div class="stat-label">Facebook Followers</div>
                    <div class="stat-change neutral" id="statFacebookChange">
                        <i class="fas fa-sync"></i> Loading...
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-card-header">
                        <div class="stat-icon" style="background: rgba(0,0,0,0.3);">
                            <i class="fab fa-tiktok"></i>
                        </div>
                    </div>
                    <div class="stat-value" id="statTiktok">--</div>
                    <div class="stat-label">TikTok Followers</div>
                    <div class="stat-change neutral" id="statTiktokChange">
                        <i class="fas fa-sync"></i> Loading...
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-card-header">
                        <div class="stat-icon purple">
                            <i class="fas fa-robot"></i>
                        </div>
                    </div>
                    <div class="stat-value" id="statAyrshare">--</div>
                    <div class="stat-label">Ayrshare Status</div>
                    <div class="stat-change neutral" id="statAyrshareChange">
                        <i class="fas fa-sync"></i> Checking...
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-card-header">
                        <div class="stat-icon green">
                            <i class="fas fa-share-alt"></i>
                        </div>
                    </div>
                    <div class="stat-value" id="statPosts">0</div>
                    <div class="stat-label">Posts This Month</div>
                    <div class="stat-change neutral" id="statPostsChange">
                        <i class="fas fa-info-circle"></i> From Ayrshare
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-card-header">
                        <div class="stat-icon green">
                            <i class="fas fa-chart-line"></i>
                        </div>
                    </div>
                    <div class="stat-value" id="statROI">--</div>
                    <div class="stat-label">Marketing ROI</div>
                    <div class="stat-change neutral" id="statROIChange">
                        <i class="fas fa-info-circle"></i> Needs data
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="card">
                <div class="card-header">
                    <h3><i class="fas fa-bolt"></i> Quick Actions</h3>
                </div>
                <div class="card-body" style="display: flex; gap: 1rem; flex-wrap: wrap;">
                    <button class="btn btn-primary" onclick="switchTab('fieldmode')">
                        <i class="fas fa-camera"></i> Field Mode Post
                    </button>
                    <button class="btn btn-secondary" onclick="openCampaignModal()">
                        <i class="fas fa-plus"></i> New Campaign
                    </button>
                    <button class="btn btn-secondary" onclick="switchTab('farmpics')">
                        <i class="fas fa-images"></i> Farm Pics
                    </button>
                    <button class="btn btn-secondary" onclick="sendSMSBlast()">
                        <i class="fas fa-paper-plane"></i> SMS Blast
                    </button>
                    <button class="btn btn-secondary" onclick="openEmailComposer()">
                        <i class="fas fa-envelope"></i> Send Newsletter
                    </button>
                </div>
            </div>

            <!-- Recent Activity & Pending Items -->
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-clock"></i> Recent Posts</h3>
                        <button class="btn btn-sm btn-secondary">View All</button>
                    </div>
                    <div class="card-body" id="recentPostsList">
                        <div style="text-align: center; padding: 2rem; color: var(--text-secondary);">
                            <i class="fas fa-inbox" style="font-size: 2rem; margin-bottom: 1rem; opacity: 0.5;"></i>
                            <p>No posts yet</p>
                            <p style="font-size: 0.8rem;">Posts made through Ayrshare will appear here</p>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-tasks"></i> Pending Approvals</h3>
                    </div>
                    <div class="card-body">
                        <div class="campaign-list">
                            <div class="campaign-item">
                                <div class="campaign-info">
                                    <div class="campaign-icon scheduled">
                                        <i class="fas fa-image"></i>
                                    </div>
                                    <div class="campaign-details">
                                        <h4>5 New Farm Pics</h4>
                                        <div class="campaign-meta">
                                            <span>From: Maria, Jake, Lisa</span>
                                        </div>
                                    </div>
                                </div>
                                <button class="btn btn-sm btn-primary" onclick="switchTab('farmpics')">Review</button>
                            </div>
                            <div class="campaign-item">
                                <div class="campaign-info">
                                    <div class="campaign-icon draft">
                                        <i class="fas fa-file-alt"></i>
                                    </div>
                                    <div class="campaign-details">
                                        <h4>Surplus Tomato Email</h4>
                                        <div class="campaign-meta">
                                            <span>Auto-generated from inventory</span>
                                        </div>
                                    </div>
                                </div>
                                <button class="btn btn-sm btn-primary" onclick="approveSurplusEmail()">Approve</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- FIELD MODE TAB -->
        <div id="fieldmodeTab" class="tab-content">
            <div class="field-mode-container">
                <div class="field-mode-header">
                    <div class="field-mode-title">
                        <div>
                            <h2><i class="fas fa-bolt"></i> Field Mode</h2>
                            <div class="subtitle">Capture & Blast in 45 seconds</div>
                        </div>
                    </div>
                    <div class="timer-badge" id="postTimer">
                        <i class="fas fa-stopwatch"></i> Ready
                    </div>
                </div>

                <div class="field-mode-content">
                    <!-- Upload Zone -->
                    <div class="upload-zone" id="uploadZone" onclick="document.getElementById('fileInput').click()">
                        <input type="file" id="fileInput" accept="image/*,video/*" style="display: none" onchange="handleFileSelect(event)">
                        <img id="uploadPreview" class="upload-preview" src="" alt="Preview">
                        <i class="fas fa-cloud-upload-alt" id="uploadIcon"></i>
                        <h4 id="uploadText">Drop media here or tap to upload</h4>
                        <p id="uploadSubtext">Photos and videos up to 100MB</p>
                    </div>

                    <!-- Post Form -->
                    <div class="post-form">
                        <button class="voice-note-btn" id="voiceNoteBtn" onclick="toggleVoiceRecording()">
                            <i class="fas fa-microphone"></i>
                            <span>Record Voice Note</span>
                        </button>

                        <div>
                            <textarea class="caption-input" id="captionInput" placeholder="What's happening on the farm?" oninput="updateCharCount()"></textarea>
                            <div class="char-count" id="charCount">
                                <span id="charTiktok"><i class="fab fa-tiktok"></i> 0/2200</span>
                                <span id="charInsta"><i class="fab fa-instagram"></i> 0/2200</span>
                                <span id="charFb"><i class="fab fa-facebook"></i> 0/63206</span>
                                <span id="charYt"><i class="fab fa-youtube"></i> 0/5000</span>
                            </div>
                            <div class="post-controls">
                                <button class="ai-caption-btn" onclick="generateAICaption()">
                                    <i class="fas fa-magic"></i> AI Caption
                                </button>
                                <button class="schedule-toggle" id="scheduleToggle" onclick="toggleScheduleMode()">
                                    <i class="fas fa-clock"></i> Schedule Post
                                </button>
                                <input type="datetime-local" class="schedule-datetime" id="scheduleDateTime">
                                <button class="draft-btn" id="draftBtn" onclick="saveDraft()">
                                    <i class="fas fa-save"></i> Save Draft
                                </button>
                                <button class="draft-btn" id="loadDraftBtn" onclick="loadDraft()" style="display: none;">
                                    <i class="fas fa-file-import"></i> Load Draft
                                </button>
                            </div>
                        </div>

                        <div>
                            <label style="font-size: 0.9rem; margin-bottom: 0.5rem; display: block;">Publish to: <span style="font-size: 0.75rem; color: var(--text-secondary);">(TikTok-first for max engagement)</span></label>
                            <div class="platform-toggles">
                                <div class="platform-toggle active" onclick="togglePlatform(this, 'tiktok')" style="border: 2px solid var(--success);">
                                    <i class="fab fa-tiktok"></i>
                                    <span>TikTok</span>
                                    <span style="font-size: 0.6rem; background: var(--success); padding: 0.1rem 0.3rem; border-radius: 4px; margin-left: 0.25rem;">2.8% eng</span>
                                    <div class="toggle-check"><i class="fas fa-check"></i></div>
                                </div>
                                <div class="platform-toggle active" onclick="togglePlatform(this, 'instagram')">
                                    <i class="fab fa-instagram" style="color: var(--instagram);"></i>
                                    <span>Instagram</span>
                                    <div class="toggle-check"><i class="fas fa-check"></i></div>
                                </div>
                                <div class="platform-toggle active" onclick="togglePlatform(this, 'facebook')">
                                    <i class="fab fa-facebook" style="color: var(--facebook);"></i>
                                    <span>Facebook</span>
                                    <div class="toggle-check"><i class="fas fa-check"></i></div>
                                </div>
                                <div class="platform-toggle active" onclick="togglePlatform(this, 'youtube')">
                                    <i class="fab fa-youtube" style="color: var(--youtube);"></i>
                                    <span>YouTube</span>
                                    <div class="toggle-check"><i class="fas fa-check"></i></div>
                                </div>
                                <div class="platform-toggle" onclick="togglePlatform(this, 'pinterest')">
                                    <i class="fab fa-pinterest" style="color: var(--pinterest);"></i>
                                    <span>Pinterest</span>
                                    <div class="toggle-check"><i class="fas fa-check"></i></div>
                                </div>
                                <div class="platform-toggle active" onclick="togglePlatform(this, 'appfeed')">
                                    <i class="fas fa-mobile-alt" style="color: var(--success);"></i>
                                    <span>App Feed</span>
                                    <div class="toggle-check"><i class="fas fa-check"></i></div>
                                </div>
                                <div class="platform-toggle" onclick="togglePlatform(this, 'sms')">
                                    <i class="fas fa-sms" style="color: var(--purple);"></i>
                                    <span>SMS VIPs</span>
                                    <div class="toggle-check"><i class="fas fa-check"></i></div>
                                </div>
                            </div>
                            <div style="margin-top: 0.75rem; padding: 0.75rem; background: rgba(0,0,0,0.3); border-radius: 8px; border-left: 3px solid var(--success);">
                                <div style="font-size: 0.8rem; color: var(--success); font-weight: 600; margin-bottom: 0.25rem;">
                                    <i class="fas fa-lightbulb"></i> TikTok Tip
                                </div>
                                <div style="font-size: 0.75rem; color: var(--text-secondary);">
                                    Be authentic! Imperfect, real behind-the-scenes content outperforms polished videos. #FarmTok has 5B+ views.
                                </div>
                            </div>
                        </div>

                        <button class="blast-btn" id="blastBtn" onclick="publishAll()" disabled>
                            <i class="fas fa-paper-plane"></i>
                            PUBLISH ALL
                        </button>
                    </div>
                </div>
            </div>

            <!-- Emergency Harvest Button -->
            <div class="card" style="background: linear-gradient(135deg, var(--danger) 0%, var(--accent) 100%);">
                <div class="card-body" style="text-align: center;">
                    <h3 style="margin-bottom: 0.5rem;"><i class="fas fa-exclamation-triangle"></i> Emergency Harvest Alert</h3>
                    <p style="margin-bottom: 1rem; opacity: 0.9;">Send immediate push notification to all users</p>
                    <button class="btn" style="background: white; color: var(--danger); font-weight: 700;" onclick="triggerEmergencyHarvest()">
                        <i class="fas fa-bell"></i> TRIGGER EMERGENCY ALERT
                    </button>
                </div>
            </div>
        </div>

        <!-- FARM PICS TAB -->
        <div id="farmpicsTab" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h3><i class="fas fa-images"></i> Farm Pics Library</h3>
                    <div style="display: flex; gap: 0.5rem;">
                        <button class="btn btn-sm btn-secondary" onclick="approveAllPics()">
                            <i class="fas fa-check-double"></i> Approve All New
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="gallery-filters">
                        <button class="filter-btn active" onclick="filterGallery('all', this)">All</button>
                        <button class="filter-btn" onclick="filterGallery('new', this)">
                            New <span style="background: var(--instagram); padding: 0.1rem 0.4rem; border-radius: 10px; font-size: 0.7rem; margin-left: 0.25rem;">5</span>
                        </button>
                        <button class="filter-btn" onclick="filterGallery('approved', this)">Approved</button>
                        <button class="filter-btn" onclick="filterGallery('used', this)">Used</button>
                        <button class="filter-btn" onclick="filterGallery('greenhouse', this)">Greenhouse</button>
                        <button class="filter-btn" onclick="filterGallery('harvest', this)">Harvest</button>
                        <button class="filter-btn" onclick="filterGallery('team', this)">Team</button>
                    </div>

                    <div class="gallery-grid" id="farmPicsGallery">
                        <!-- Gallery items will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>

        <!-- CAMPAIGNS TAB -->
        <div id="campaignsTab" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h3><i class="fas fa-flag"></i> Marketing Campaigns</h3>
                    <button class="btn btn-primary" onclick="openCampaignModal()">
                        <i class="fas fa-plus"></i> New Campaign
                    </button>
                </div>
                <div class="card-body">
                    <div class="campaign-list" id="campaignList">
                        <!-- Campaigns will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>

        <!-- SCHEDULE TAB -->
        <div id="scheduleTab" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h3><i class="fas fa-calendar-alt"></i> Content Calendar</h3>
                    <div style="display: flex; gap: 0.5rem;">
                        <button class="btn btn-sm btn-secondary" onclick="previousWeek()">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <span id="calendarWeek" style="padding: 0.5rem 1rem;">Jan 13 - Jan 19, 2026</span>
                        <button class="btn btn-sm btn-secondary" onclick="nextWeek()">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="schedule-calendar" id="scheduleCalendar">
                        <!-- Calendar will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>

        <!-- CONNECTIONS TAB -->
        <div id="connectionsTab" class="tab-content">
            <!-- Connections Header -->
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                <div>
                    <h2 style="margin: 0; font-size: 1.25rem;">Connected Platforms</h2>
                    <p style="margin: 0.25rem 0 0 0; color: var(--text-secondary); font-size: 0.85rem;">
                        Update follower counts weekly to track growth
                    </p>
                </div>
                <button class="btn btn-primary" onclick="openFollowerCountModal()">
                    <i class="fas fa-edit"></i> Update Counts
                </button>
            </div>
            <div class="connections-grid">
                <div class="connection-card" data-platform="instagram">
                    <div class="connection-header">
                        <div class="connection-platform instagram">
                            <i class="fab fa-instagram"></i>
                            <div>
                                <div style="font-weight: 600;">Instagram</div>
                                <div style="font-size: 0.8rem; color: var(--text-secondary);">@tinyseedfarm</div>
                            </div>
                        </div>
                        <div class="connection-status">
                            <div class="dot connected"></div>
                            Connected
                        </div>
                    </div>
                    <div class="connection-stats">
                        <div class="connection-stat">
                            <div class="connection-stat-value" id="igFollowers">--</div>
                            <div class="connection-stat-label">Followers</div>
                        </div>
                        <div class="connection-stat">
                            <div class="connection-stat-value">--</div>
                            <div class="connection-stat-label">Engagement</div>
                        </div>
                        <div class="connection-stat">
                            <div class="connection-stat-value">--</div>
                            <div class="connection-stat-label">Posts</div>
                        </div>
                    </div>
                    <div style="font-size: 0.7rem; color: var(--text-secondary); padding: 0.5rem; text-align: center;">
                        <i class="fas fa-info-circle"></i> Engagement data requires Ayrshare Premium
                    </div>
                </div>

                <div class="connection-card" data-platform="facebook">
                    <div class="connection-header">
                        <div class="connection-platform facebook">
                            <i class="fab fa-facebook"></i>
                            <div>
                                <div style="font-weight: 600;">Facebook</div>
                                <div style="font-size: 0.8rem; color: var(--text-secondary);">Tiny Seed Farm</div>
                            </div>
                        </div>
                        <div class="connection-status" id="fbStatus">
                            <div class="dot connected"></div>
                            Connected
                        </div>
                    </div>
                    <div class="connection-stats">
                        <div class="connection-stat">
                            <div class="connection-stat-value" id="fbFollowers">--</div>
                            <div class="connection-stat-label">Followers</div>
                        </div>
                        <div class="connection-stat">
                            <div class="connection-stat-value">--</div>
                            <div class="connection-stat-label">Engagement</div>
                        </div>
                        <div class="connection-stat">
                            <div class="connection-stat-value">--</div>
                            <div class="connection-stat-label">Posts</div>
                        </div>
                    </div>
                    <div style="font-size: 0.7rem; color: var(--text-secondary); padding: 0.5rem; text-align: center;">
                        <i class="fas fa-info-circle"></i> Engagement data requires Ayrshare Premium
                    </div>
                </div>

                <div class="connection-card" data-platform="tiktok">
                    <div class="connection-header">
                        <div class="connection-platform tiktok">
                            <i class="fab fa-tiktok"></i>
                            <div>
                                <div style="font-weight: 600;">TikTok</div>
                                <div style="font-size: 0.8rem; color: var(--text-secondary);">@TinySeedEnergy</div>
                            </div>
                        </div>
                        <div class="connection-status" id="tiktokStatus">
                            <div class="dot connected"></div>
                            Connected
                        </div>
                    </div>
                    <div class="connection-stats">
                        <div class="connection-stat">
                            <div class="connection-stat-value" id="tiktokFollowers">--</div>
                            <div class="connection-stat-label">Followers</div>
                        </div>
                        <div class="connection-stat">
                            <div class="connection-stat-value">--</div>
                            <div class="connection-stat-label">Engagement</div>
                        </div>
                        <div class="connection-stat">
                            <div class="connection-stat-value">--</div>
                            <div class="connection-stat-label">Videos</div>
                        </div>
                    </div>
                    <button class="connection-btn connect" onclick="connectTikTok()">Connect TikTok</button>
                </div>

                <div class="connection-card" data-platform="ayrshare">
                    <div class="connection-header">
                        <div class="connection-platform" style="color: var(--purple);">
                            <i class="fas fa-robot"></i>
                            <div>
                                <div style="font-weight: 600;">Ayrshare</div>
                                <div style="font-size: 0.8rem; color: var(--text-secondary);">Multi-platform API</div>
                            </div>
                        </div>
                        <div class="connection-status" id="ayrshareStatus">
                            <div class="dot connected"></div>
                            Active
                        </div>
                    </div>
                    <div class="connection-stats">
                        <div class="connection-stat">
                            <div class="connection-stat-value" id="ayrshareConnected">--</div>
                            <div class="connection-stat-label">Platforms</div>
                        </div>
                        <div class="connection-stat">
                            <div class="connection-stat-value" id="aysharePosts">0</div>
                            <div class="connection-stat-label">Posts</div>
                        </div>
                        <div class="connection-stat">
                            <div class="connection-stat-value">$29</div>
                            <div class="connection-stat-label">Cost/mo</div>
                        </div>
                    </div>
                    <a href="https://app.ayrshare.com" target="_blank" class="connection-btn disconnect">Manage</a>
                </div>

                <div class="connection-card" data-platform="twilio">
                    <div class="connection-header">
                        <div class="connection-platform" style="color: var(--success);">
                            <i class="fas fa-sms"></i>
                            <div>
                                <div style="font-weight: 600;">Twilio SMS</div>
                                <div style="font-size: 0.8rem; color: var(--text-secondary);">VIP Notifications</div>
                            </div>
                        </div>
                        <div class="connection-status">
                            <div class="dot disconnected"></div>
                            Not Setup
                        </div>
                    </div>
                    <div class="connection-stats">
                        <div class="connection-stat">
                            <div class="connection-stat-value">--</div>
                            <div class="connection-stat-label">Subscribers</div>
                        </div>
                        <div class="connection-stat">
                            <div class="connection-stat-value">--</div>
                            <div class="connection-stat-label">Conv Rate</div>
                        </div>
                        <div class="connection-stat">
                            <div class="connection-stat-value">--</div>
                            <div class="connection-stat-label">Cost/mo</div>
                        </div>
                    </div>
                    <button class="connection-btn connect">Setup Twilio</button>
                </div>

                <div class="connection-card" data-platform="klaviyo">
                    <div class="connection-header">
                        <div class="connection-platform" style="color: var(--info);">
                            <i class="fas fa-envelope"></i>
                            <div>
                                <div style="font-weight: 600;">Email Marketing</div>
                                <div style="font-size: 0.8rem; color: var(--text-secondary);">Klaviyo / Mailchimp</div>
                            </div>
                        </div>
                        <div class="connection-status">
                            <div class="dot disconnected"></div>
                            Not Setup
                        </div>
                    </div>
                    <div class="connection-stats">
                        <div class="connection-stat">
                            <div class="connection-stat-value">--</div>
                            <div class="connection-stat-label">Subscribers</div>
                        </div>
                        <div class="connection-stat">
                            <div class="connection-stat-value">--</div>
                            <div class="connection-stat-label">Open Rate</div>
                        </div>
                        <div class="connection-stat">
                            <div class="connection-stat-value">--</div>
                            <div class="connection-stat-label">Cost/mo</div>
                        </div>
                    </div>
                    <button class="connection-btn connect">Setup Email</button>
                </div>

                <div class="connection-card" data-platform="youtube">
                    <div class="connection-header">
                        <div class="connection-platform" style="color: var(--youtube);">
                            <i class="fab fa-youtube"></i>
                            <div>
                                <div style="font-weight: 600;">YouTube</div>
                                <div style="font-size: 0.8rem; color: var(--text-secondary);">Tiny Seed Farm</div>
                            </div>
                        </div>
                        <div class="connection-status">
                            <div class="dot disconnected"></div>
                            Disconnected
                        </div>
                    </div>
                    <div class="connection-stats">
                        <div class="connection-stat">
                            <div class="connection-stat-value">--</div>
                            <div class="connection-stat-label">Subscribers</div>
                        </div>
                        <div class="connection-stat">
                            <div class="connection-stat-value">--</div>
                            <div class="connection-stat-label">Views</div>
                        </div>
                        <div class="connection-stat">
                            <div class="connection-stat-value">--</div>
                            <div class="connection-stat-label">Videos</div>
                        </div>
                    </div>
                    <button class="connection-btn connect" onclick="connectYouTube()">Connect YouTube</button>
                </div>

                <div class="connection-card" data-platform="pinterest">
                    <div class="connection-header">
                        <div class="connection-platform" style="color: var(--pinterest);">
                            <i class="fab fa-pinterest"></i>
                            <div>
                                <div style="font-weight: 600;">Pinterest</div>
                                <div style="font-size: 0.8rem; color: var(--text-secondary);">tinyseedfarm</div>
                            </div>
                        </div>
                        <div class="connection-status">
                            <div class="dot disconnected"></div>
                            Disconnected
                        </div>
                    </div>
                    <div class="connection-stats">
                        <div class="connection-stat">
                            <div class="connection-stat-value">--</div>
                            <div class="connection-stat-label">Followers</div>
                        </div>
                        <div class="connection-stat">
                            <div class="connection-stat-value">--</div>
                            <div class="connection-stat-label">Monthly Views</div>
                        </div>
                        <div class="connection-stat">
                            <div class="connection-stat-value">--</div>
                            <div class="connection-stat-label">Pins</div>
                        </div>
                    </div>
                    <button class="connection-btn connect" onclick="connectPinterest()">Connect Pinterest</button>
                </div>

                <div class="connection-card" data-platform="threads">
                    <div class="connection-header">
                        <div class="connection-platform" style="color: var(--threads);">
                            <i class="fab fa-threads"></i>
                            <div>
                                <div style="font-weight: 600;">Threads</div>
                                <div style="font-size: 0.8rem; color: var(--text-secondary);">@tinyseedfarm</div>
                            </div>
                        </div>
                        <div class="connection-status">
                            <div class="dot disconnected"></div>
                            Not Setup
                        </div>
                    </div>
                    <div class="connection-stats">
                        <div class="connection-stat">
                            <div class="connection-stat-value">--</div>
                            <div class="connection-stat-label">Followers</div>
                        </div>
                        <div class="connection-stat">
                            <div class="connection-stat-value">--</div>
                            <div class="connection-stat-label">Engagement</div>
                        </div>
                        <div class="connection-stat">
                            <div class="connection-stat-value">Free</div>
                            <div class="connection-stat-label">Cost</div>
                        </div>
                    </div>
                    <button class="connection-btn connect" onclick="connectThreads()">Connect Threads</button>
                </div>
            </div>

            <!-- Platform Priority Guide -->
            <div class="card" style="margin-top: 1.5rem; background: linear-gradient(135deg, rgba(42, 157, 143, 0.2) 0%, rgba(155, 89, 182, 0.2) 100%);">
                <div class="card-header">
                    <h3><i class="fas fa-chart-bar"></i> Platform Engagement Guide (2025 Data)</h3>
                </div>
                <div class="card-body">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem;">
                        <div style="text-align: center; padding: 1rem; background: rgba(0,0,0,0.2); border-radius: 8px;">
                            <i class="fab fa-tiktok" style="font-size: 1.5rem; margin-bottom: 0.5rem;"></i>
                            <div style="font-size: 1.25rem; font-weight: 700; color: var(--success);">2.80%</div>
                            <div style="font-size: 0.75rem; color: var(--text-secondary);">Highest Engagement</div>
                            <div style="font-size: 0.65rem; color: var(--gold); margin-top: 0.25rem;">#FarmTok = 5B+ views</div>
                        </div>
                        <div style="text-align: center; padding: 1rem; background: rgba(0,0,0,0.2); border-radius: 8px;">
                            <i class="fab fa-instagram" style="font-size: 1.5rem; color: var(--instagram); margin-bottom: 0.5rem;"></i>
                            <div style="font-size: 1.25rem; font-weight: 700;">0.50%</div>
                            <div style="font-size: 0.75rem; color: var(--text-secondary);">General Rate</div>
                            <div style="font-size: 0.65rem; color: var(--success); margin-top: 0.25rem;">+38% for agriculture</div>
                        </div>
                        <div style="text-align: center; padding: 1rem; background: rgba(0,0,0,0.2); border-radius: 8px;">
                            <i class="fab fa-facebook" style="font-size: 1.5rem; color: var(--facebook); margin-bottom: 0.5rem;"></i>
                            <div style="font-size: 1.25rem; font-weight: 700;">0.20%</div>
                            <div style="font-size: 0.75rem; color: var(--text-secondary);">General Rate</div>
                            <div style="font-size: 0.65rem; color: var(--warning); margin-top: 0.25rem;">Best for 40+ demo</div>
                        </div>
                        <div style="text-align: center; padding: 1rem; background: rgba(0,0,0,0.2); border-radius: 8px;">
                            <i class="fab fa-youtube" style="font-size: 1.5rem; color: var(--youtube); margin-bottom: 0.5rem;"></i>
                            <div style="font-size: 1.25rem; font-weight: 700;">Long-form</div>
                            <div style="font-size: 0.75rem; color: var(--text-secondary);">Evergreen Content</div>
                            <div style="font-size: 0.65rem; color: var(--info); margin-top: 0.25rem;">Farm tours & how-tos</div>
                        </div>
                        <div style="text-align: center; padding: 1rem; background: rgba(0,0,0,0.2); border-radius: 8px;">
                            <i class="fab fa-pinterest" style="font-size: 1.5rem; color: var(--pinterest); margin-bottom: 0.5rem;"></i>
                            <div style="font-size: 1.25rem; font-weight: 700;">High Intent</div>
                            <div style="font-size: 0.75rem; color: var(--text-secondary);">Drives Traffic</div>
                            <div style="font-size: 0.65rem; color: var(--success); margin-top: 0.25rem;">Recipe & garden pins</div>
                        </div>
                    </div>
                    <div style="margin-top: 1rem; padding: 0.75rem; background: rgba(0,0,0,0.3); border-radius: 8px; font-size: 0.8rem; color: var(--text-secondary);">
                        <i class="fas fa-info-circle" style="color: var(--info);"></i>
                        <strong>Recommendation:</strong> Post 3-5x/week. Educational content gets 45% higher engagement than product-only posts.
                    </div>
                </div>
            </div>
        </div>

        <!-- BUDGET TAB -->
        <div id="budgetTab" class="tab-content">
            <div class="budget-overview">
                <div class="budget-card">
                    <div class="budget-header">
                        <h4><i class="fas fa-wallet"></i> Marketing Budget</h4>
                        <button class="btn btn-sm btn-secondary" onclick="openBudgetSettings()">
                            <i class="fas fa-cog"></i>
                        </button>
                    </div>
                    <div class="budget-amount" id="budgetAmount">$0</div>
                    <div class="budget-subtitle">Monthly Allocation</div>
                    <div class="budget-progress">
                        <div class="budget-progress-header">
                            <span id="budgetSpent">Spent: $0</span>
                            <span id="budgetRemaining">Remaining: $0</span>
                        </div>
                        <div class="budget-progress-bar">
                            <div class="budget-progress-fill" id="budgetProgressBar" style="width: 0%; background: linear-gradient(90deg, var(--success), var(--warning));"></div>
                        </div>
                    </div>
                    <div style="margin-top: 1rem; font-size: 0.8rem; color: var(--text-secondary);">
                        <i class="fas fa-info-circle"></i> Set a monthly budget to track spending
                    </div>
                </div>

                <div class="budget-card">
                    <div class="budget-header">
                        <h4><i class="fas fa-receipt"></i> Current Subscriptions</h4>
                    </div>
                    <div style="margin-top: 1rem;">
                        <div style="display: flex; justify-content: space-between; padding: 0.75rem 0; border-bottom: 1px solid var(--border);">
                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                <i class="fas fa-robot" style="color: var(--purple);"></i>
                                <span>Ayrshare Premium</span>
                            </div>
                            <span style="color: var(--success);">$29/mo</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 0.75rem 0; color: var(--text-secondary);">
                            <span>Other services</span>
                            <span>Not setup</span>
                        </div>
                    </div>
                </div>

                <div class="roi-card" style="background: linear-gradient(135deg, rgba(141, 153, 174, 0.2) 0%, rgba(141, 153, 174, 0.1) 100%);">
                    <div class="roi-value" id="budgetROI">--</div>
                    <div class="roi-label">Return on Marketing Investment</div>
                    <div style="margin-top: 1rem; font-size: 0.9rem; opacity: 0.9;">
                        ROI calculated after spending and revenue tracked
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h3><i class="fas fa-receipt"></i> Spending History</h3>
                </div>
                <div class="card-body" style="text-align: center; padding: 3rem;">
                    <i class="fas fa-receipt" style="font-size: 3rem; color: var(--text-secondary); opacity: 0.3; margin-bottom: 1rem;"></i>
                    <h4 style="margin-bottom: 0.5rem;">No Spending Tracked Yet</h4>
                    <p style="color: var(--text-secondary); font-size: 0.9rem;">
                        Marketing expenses will appear here once tracked.<br>
                        Future: Link to Financial Command Center for automatic tracking.
                    </p>
                </div>
            </div>
        </div>

        <!-- ANALYTICS TAB -->
        <div id="analyticsTab" class="tab-content">
            <!-- Analytics Stats - Will populate from Ayrshare API -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-card-header">
                        <div class="stat-icon green">
                            <i class="fas fa-eye"></i>
                        </div>
                    </div>
                    <div class="stat-value" id="analyticsReach">--</div>
                    <div class="stat-label">Total Reach (30 days)</div>
                    <div class="stat-change neutral">
                        <i class="fas fa-info-circle"></i> Requires Ayrshare Premium
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-card-header">
                        <div class="stat-icon purple">
                            <i class="fas fa-heart"></i>
                        </div>
                    </div>
                    <div class="stat-value" id="analyticsEngagements">--</div>
                    <div class="stat-label">Total Engagements</div>
                    <div class="stat-change neutral">
                        <i class="fas fa-info-circle"></i> Post to start tracking
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-card-header">
                        <div class="stat-icon gold">
                            <i class="fas fa-user-plus"></i>
                        </div>
                    </div>
                    <div class="stat-value" id="analyticsCustomers">0</div>
                    <div class="stat-label">New Followers</div>
                    <div class="stat-change neutral">
                        <i class="fas fa-info-circle"></i> Tracked after posting
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-card-header">
                        <div class="stat-icon instagram">
                            <i class="fas fa-paper-plane"></i>
                        </div>
                    </div>
                    <div class="stat-value" id="analyticsPosts">0</div>
                    <div class="stat-label">Posts This Month</div>
                    <div class="stat-change neutral">
                        <i class="fas fa-info-circle"></i> Via Ayrshare
                    </div>
                </div>
            </div>

            <!-- No Data Message -->
            <div class="card">
                <div class="card-header">
                    <h3><i class="fas fa-chart-area"></i> Analytics Dashboard</h3>
                </div>
                <div class="card-body" style="text-align: center; padding: 3rem;">
                    <i class="fas fa-chart-line" style="font-size: 4rem; color: var(--purple); opacity: 0.3; margin-bottom: 1.5rem;"></i>
                    <h3 style="margin-bottom: 0.5rem;">No Analytics Data Yet</h3>
                    <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">
                        Start posting through Ayrshare to collect engagement data.<br>
                        Analytics will appear here once you have post activity.
                    </p>
                    <button class="btn btn-primary" onclick="switchTab('fieldmode')">
                        <i class="fas fa-plus"></i> Create Your First Post
                    </button>
                </div>
            </div>

            <!-- How Analytics Works -->
            <div class="card" style="background: linear-gradient(135deg, rgba(155, 89, 182, 0.1) 0%, rgba(225, 48, 108, 0.1) 100%);">
                <div class="card-header">
                    <h3><i class="fas fa-info-circle"></i> How Analytics Works</h3>
                </div>
                <div class="card-body">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem;">
                        <div style="text-align: center; padding: 1rem;">
                            <div style="font-size: 2rem; margin-bottom: 0.5rem;">1</div>
                            <h4 style="margin-bottom: 0.5rem;">Post Content</h4>
                            <p style="font-size: 0.85rem; color: var(--text-secondary);">Use Field Mode to post to connected platforms via Ayrshare</p>
                        </div>
                        <div style="text-align: center; padding: 1rem;">
                            <div style="font-size: 2rem; margin-bottom: 0.5rem;">2</div>
                            <h4 style="margin-bottom: 0.5rem;">Collect Data</h4>
                            <p style="font-size: 0.85rem; color: var(--text-secondary);">Ayrshare tracks likes, comments, shares, and reach</p>
                        </div>
                        <div style="text-align: center; padding: 1rem;">
                            <div style="font-size: 2rem; margin-bottom: 0.5rem;">3</div>
                            <h4 style="margin-bottom: 0.5rem;">View Insights</h4>
                            <p style="font-size: 0.85rem; color: var(--text-secondary);">Analytics populate here and on Ayrshare dashboard</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- INTELLIGENCE TAB - AI-Powered Marketing -->
        <div id="intelligenceTab" class="tab-content">
            <!-- Intelligence Summary Cards -->
            <div class="stats-grid">
                <div class="stat-card" style="border-left: 4px solid var(--gold);">
                    <div class="stat-card-header">
                        <div class="stat-icon" style="background: rgba(255, 215, 0, 0.2);">
                            <i class="fas fa-brain" style="color: var(--gold);"></i>
                        </div>
                    </div>
                    <div class="stat-value" id="intelTotalCustomers">--</div>
                    <div class="stat-label">Customers Analyzed</div>
                    <div class="stat-change neutral">
                        <i class="fas fa-sync"></i> Loading intelligence...
                    </div>
                </div>
                <div class="stat-card" style="border-left: 4px solid var(--danger);">
                    <div class="stat-card-header">
                        <div class="stat-icon" style="background: rgba(230, 57, 70, 0.2);">
                            <i class="fas fa-exclamation-triangle" style="color: var(--danger);"></i>
                        </div>
                    </div>
                    <div class="stat-value" id="intelAtRisk">--</div>
                    <div class="stat-label">At Risk of Churning</div>
                    <div class="stat-change negative" id="intelAtRiskDesc">
                        <i class="fas fa-arrow-down"></i> Action needed
                    </div>
                </div>
                <div class="stat-card" style="border-left: 4px solid var(--success);">
                    <div class="stat-card-header">
                        <div class="stat-icon" style="background: rgba(42, 157, 143, 0.2);">
                            <i class="fas fa-crown" style="color: var(--success);"></i>
                        </div>
                    </div>
                    <div class="stat-value" id="intelChampions">--</div>
                    <div class="stat-label">Champions (Top Tier)</div>
                    <div class="stat-change positive" id="intelChampionsDesc">
                        <i class="fas fa-star"></i> High value
                    </div>
                </div>
                <div class="stat-card" style="border-left: 4px solid var(--info);">
                    <div class="stat-card-header">
                        <div class="stat-icon" style="background: rgba(67, 97, 238, 0.2);">
                            <i class="fas fa-dollar-sign" style="color: var(--info);"></i>
                        </div>
                    </div>
                    <div class="stat-value" id="intelAvgCLV">$--</div>
                    <div class="stat-label">Avg Customer Value</div>
                    <div class="stat-change neutral" id="intelAvgCLVDesc">
                        <i class="fas fa-chart-line"></i> Lifetime value
                    </div>
                </div>
            </div>

            <!-- Next Best Actions -->
            <div class="section-card" style="margin-top: 1.5rem;">
                <div class="card-header" style="background: linear-gradient(135deg, var(--purple) 0%, var(--info) 100%);">
                    <h3><i class="fas fa-lightbulb"></i> Next Best Actions</h3>
                    <span style="font-size: 0.85rem; opacity: 0.9;">AI-recommended actions to maximize customer value</span>
                </div>
                <div class="card-content" id="nextBestActionsContainer">
                    <div style="text-align: center; padding: 2rem; color: var(--text-secondary);">
                        <i class="fas fa-spinner fa-spin" style="font-size: 2rem;"></i>
                        <p style="margin-top: 1rem;">Analyzing customer data...</p>
                    </div>
                </div>
            </div>

            <!-- Customer Segments -->
            <div class="section-card" style="margin-top: 1.5rem;">
                <div class="card-header" style="background: linear-gradient(135deg, var(--success) 0%, var(--teal) 100%);">
                    <h3><i class="fas fa-users"></i> Customer Segments (RFM Analysis)</h3>
                    <button class="btn btn-secondary" onclick="refreshCustomerIntelligence()" style="padding: 0.5rem 1rem; font-size: 0.85rem;">
                        <i class="fas fa-sync"></i> Refresh
                    </button>
                </div>
                <div class="card-content">
                    <div id="customerSegmentsContainer" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                        <!-- Segments will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Attribution Report -->
            <div class="section-card" style="margin-top: 1.5rem;">
                <div class="card-header" style="background: linear-gradient(135deg, var(--secondary) 0%, var(--accent) 100%);">
                    <h3><i class="fas fa-route"></i> Attribution Report</h3>
                    <span style="font-size: 0.85rem; opacity: 0.9;">Multi-touch attribution with time-decay model</span>
                </div>
                <div class="card-content" id="attributionContainer">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
                        <div style="background: rgba(255,255,255,0.05); padding: 1rem; border-radius: 8px;">
                            <div style="font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Top Converting Channel</div>
                            <div style="font-size: 1.5rem; font-weight: 700;" id="attrTopChannel">Loading...</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.05); padding: 1rem; border-radius: 8px;">
                            <div style="font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Postcard Campaign</div>
                            <div style="font-size: 1.5rem; font-weight: 700;" id="attrPostcard">--</div>
                            <div style="font-size: 0.75rem; color: var(--text-secondary);">conversions</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.05); padding: 1rem; border-radius: 8px;">
                            <div style="font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Social Media</div>
                            <div style="font-size: 1.5rem; font-weight: 700;" id="attrSocial">--</div>
                            <div style="font-size: 0.75rem; color: var(--text-secondary);">conversions</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.05); padding: 1rem; border-radius: 8px;">
                            <div style="font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Email Marketing</div>
                            <div style="font-size: 1.5rem; font-weight: 700;" id="attrEmail">--</div>
                            <div style="font-size: 0.75rem; color: var(--text-secondary);">conversions</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Instagram Direct Posting (No Ayrshare) -->
            <div class="section-card" style="margin-top: 1.5rem;">
                <div class="card-header" style="background: linear-gradient(135deg, var(--instagram) 0%, var(--purple) 100%);">
                    <h3><i class="fab fa-instagram"></i> Instagram Direct (Graph API)</h3>
                    <span style="font-size: 0.85rem; opacity: 0.9;">Free posting - No Ayrshare needed</span>
                </div>
                <div class="card-content">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem;">
                        <!-- Account 1 -->
                        <div style="background: rgba(255,255,255,0.05); padding: 1.5rem; border-radius: 12px;">
                            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                                <i class="fab fa-instagram" style="font-size: 2rem; color: var(--instagram);"></i>
                                <div>
                                    <div style="font-weight: 600;">@tinyseedfarm</div>
                                    <div style="font-size: 0.85rem; color: var(--text-secondary);">Main Account</div>
                                </div>
                                <span id="insta1Status" style="margin-left: auto; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.75rem; background: rgba(255,255,255,0.1);">Not Connected</span>
                            </div>
                            <button class="btn btn-primary" onclick="configureInstagram('tinyseedfarm')" style="width: 100%;">
                                <i class="fas fa-plug"></i> Configure API
                            </button>
                        </div>
                        <!-- Account 2 -->
                        <div style="background: rgba(255,255,255,0.05); padding: 1.5rem; border-radius: 12px;">
                            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                                <i class="fab fa-instagram" style="font-size: 2rem; color: var(--instagram);"></i>
                                <div>
                                    <div style="font-weight: 600;">@tinyseedflowers</div>
                                    <div style="font-size: 0.85rem; color: var(--text-secondary);">Flowers Account</div>
                                </div>
                                <span id="insta2Status" style="margin-left: auto; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.75rem; background: rgba(255,255,255,0.1);">Not Connected</span>
                            </div>
                            <button class="btn btn-primary" onclick="configureInstagram('tinyseedflowers')" style="width: 100%;">
                                <i class="fas fa-plug"></i> Configure API
                            </button>
                        </div>
                        <!-- Account 3 -->
                        <div style="background: rgba(255,255,255,0.05); padding: 1.5rem; border-radius: 12px;">
                            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                                <i class="fab fa-instagram" style="font-size: 2rem; color: var(--instagram);"></i>
                                <div>
                                    <div style="font-weight: 600;">@tinyseedcsa</div>
                                    <div style="font-size: 0.85rem; color: var(--text-secondary);">CSA Account</div>
                                </div>
                                <span id="insta3Status" style="margin-left: auto; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.75rem; background: rgba(255,255,255,0.1);">Not Connected</span>
                            </div>
                            <button class="btn btn-primary" onclick="configureInstagram('tinyseedcsa')" style="width: 100%;">
                                <i class="fas fa-plug"></i> Configure API
                            </button>
                        </div>
                    </div>
                    <div style="margin-top: 1.5rem; padding: 1rem; background: rgba(67, 97, 238, 0.1); border-radius: 8px; border-left: 4px solid var(--info);">
                        <h4 style="margin-bottom: 0.5rem;"><i class="fas fa-info-circle"></i> Setup Instructions</h4>
                        <ol style="padding-left: 1.5rem; font-size: 0.9rem; color: var(--text-secondary); line-height: 1.8;">
                            <li>Go to <a href="https://developers.facebook.com" target="_blank" style="color: var(--info);">developers.facebook.com</a></li>
                            <li>Create a Meta App with Instagram Graph API</li>
                            <li>Connect your Instagram Business account</li>
                            <li>Generate a long-lived access token</li>
                            <li>Click "Configure API" above and enter the token</li>
                        </ol>
                        <p style="margin-top: 1rem; font-size: 0.85rem;"><strong>Savings:</strong> $1,200/year vs Ayrshare Premium</p>
                    </div>
                </div>
            </div>

            <!-- Neighbor Signups from Postcard Campaign -->
            <div class="section-card" style="margin-top: 1.5rem;">
                <div class="card-header" style="background: linear-gradient(135deg, #FFB81C 0%, #F4A261 100%);">
                    <h3><i class="fas fa-mailbox"></i> Neighbor Campaign Signups</h3>
                    <button class="btn btn-secondary" onclick="loadNeighborSignups()" style="padding: 0.5rem 1rem; font-size: 0.85rem;">
                        <i class="fas fa-sync"></i> Refresh
                    </button>
                </div>
                <div class="card-content" id="neighborSignupsContainer">
                    <div style="text-align: center; padding: 2rem; color: var(--text-secondary);">
                        <i class="fas fa-spinner fa-spin" style="font-size: 2rem;"></i>
                        <p style="margin-top: 1rem;">Loading signups...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- SOCIAL GROWTH TAB - Multi-Platform Growth Engine -->
        <div id="socialgrowthTab" class="tab-content">
            <!-- Growth Goals Dashboard -->
            <div class="stats-grid">
                <div class="stat-card" style="border-left: 4px solid var(--instagram);">
                    <div class="stat-card-header">
                        <div class="stat-icon" style="background: linear-gradient(135deg, var(--instagram), #833AB4);">
                            <i class="fab fa-instagram"></i>
                        </div>
                        <span class="badge" style="background: var(--instagram);">@tinyseedfarm</span>
                    </div>
                    <div class="stat-value" id="igFarmFollowers">--</div>
                    <div class="stat-label">of 10,000 goal</div>
                    <div class="progress-bar" style="margin-top: 0.5rem;">
                        <div class="progress-fill" id="igFarmProgress" style="width: 0%; background: var(--instagram);"></div>
                    </div>
                </div>
                <div class="stat-card" style="border-left: 4px solid #E1306C;">
                    <div class="stat-card-header">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #E1306C, #F77737);">
                            <i class="fab fa-instagram"></i>
                        </div>
                        <span class="badge" style="background: #E1306C;">@tinyseedfleurs</span>
                    </div>
                    <div class="stat-value" id="igFleursFollowers">--</div>
                    <div class="stat-label">of 10,000 goal</div>
                    <div class="progress-bar" style="margin-top: 0.5rem;">
                        <div class="progress-fill" id="igFleursProgress" style="width: 0%; background: #E1306C;"></div>
                    </div>
                </div>
                <div class="stat-card" style="border-left: 4px solid #833AB4;">
                    <div class="stat-card-header">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #833AB4, #405DE6);">
                            <i class="fab fa-instagram"></i>
                        </div>
                        <span class="badge" style="background: #833AB4;">@tinyseedfungi</span>
                    </div>
                    <div class="stat-value" id="igFungiFollowers">--</div>
                    <div class="stat-label">of 5,000 goal</div>
                    <div class="progress-bar" style="margin-top: 0.5rem;">
                        <div class="progress-fill" id="igFungiProgress" style="width: 0%; background: #833AB4;"></div>
                    </div>
                </div>
                <div class="stat-card" style="border-left: 4px solid var(--facebook);">
                    <div class="stat-card-header">
                        <div class="stat-icon" style="background: var(--facebook);">
                            <i class="fab fa-facebook"></i>
                        </div>
                        <span class="badge" style="background: var(--facebook);">Facebook</span>
                    </div>
                    <div class="stat-value" id="fbFollowers">--</div>
                    <div class="stat-label">Page Followers</div>
                    <div class="stat-change neutral" id="fbGrowth">
                        <i class="fas fa-sync"></i> Connect to track
                    </div>
                </div>
            </div>

            <!-- Platform Cards Row 2 -->
            <div class="stats-grid" style="margin-top: 1rem;">
                <div class="stat-card" style="border-left: 4px solid #000;">
                    <div class="stat-card-header">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #25F4EE, #FE2C55);">
                            <i class="fab fa-tiktok"></i>
                        </div>
                        <span class="badge" style="background: linear-gradient(135deg, #25F4EE, #FE2C55);">TikTok</span>
                    </div>
                    <div class="stat-value" id="tiktokFollowers">--</div>
                    <div class="stat-label">#FarmTok potential</div>
                    <div class="stat-change positive">
                        <i class="fas fa-fire"></i> 5B+ views on #FarmTok
                    </div>
                </div>
                <div class="stat-card" style="border-left: 4px solid var(--pinterest);">
                    <div class="stat-card-header">
                        <div class="stat-icon" style="background: var(--pinterest);">
                            <i class="fab fa-pinterest"></i>
                        </div>
                        <span class="badge" style="background: var(--pinterest);">Pinterest</span>
                    </div>
                    <div class="stat-value" id="pinterestFollowers">--</div>
                    <div class="stat-label">Monthly Views</div>
                    <div class="stat-change positive">
                        <i class="fas fa-search"></i> SEO Traffic Engine
                    </div>
                </div>
                <div class="stat-card" style="border-left: 4px solid var(--youtube);">
                    <div class="stat-card-header">
                        <div class="stat-icon" style="background: var(--youtube);">
                            <i class="fab fa-youtube"></i>
                        </div>
                        <span class="badge" style="background: var(--youtube);">YouTube</span>
                    </div>
                    <div class="stat-value" id="youtubeSubscribers">--</div>
                    <div class="stat-label">Subscribers</div>
                    <div class="stat-change neutral">
                        <i class="fas fa-video"></i> Shorts + Long-form
                    </div>
                </div>
                <div class="stat-card" style="border-left: 4px solid #000;">
                    <div class="stat-card-header">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #000, #333);">
                            <i class="fas fa-at"></i>
                        </div>
                        <span class="badge" style="background: #333;">Threads</span>
                    </div>
                    <div class="stat-value" id="threadsFollowers">--</div>
                    <div class="stat-label">Followers</div>
                    <div class="stat-change positive">
                        <i class="fab fa-instagram"></i> Auto-synced from IG
                    </div>
                </div>
            </div>

            <!-- Today's Posting Schedule -->
            <div class="card" style="margin-top: 1.5rem;">
                <div class="card-header">
                    <h3><i class="fas fa-calendar-day"></i> Today's Posting Schedule</h3>
                    <button class="btn btn-primary btn-sm" onclick="openPostComposer()">
                        <i class="fas fa-plus"></i> Create Post
                    </button>
                </div>
                <div class="card-content">
                    <div class="posting-timeline" id="todaySchedule">
                        <div class="timeline-slot optimal">
                            <div class="time-badge">4:00 PM</div>
                            <div class="slot-content">
                                <span class="optimal-badge"><i class="fas fa-star"></i> OPTIMAL TIME</span>
                                <div class="slot-platforms">
                                    <i class="fab fa-instagram" style="color: var(--instagram);"></i>
                                    <i class="fab fa-facebook" style="color: var(--facebook);"></i>
                                </div>
                                <span class="slot-status empty">No post scheduled</span>
                            </div>
                            <button class="btn btn-sm" onclick="schedulePost('16:00')">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                        <div class="timeline-slot optimal">
                            <div class="time-badge">9:00 PM</div>
                            <div class="slot-content">
                                <span class="optimal-badge"><i class="fas fa-star"></i> OPTIMAL TIME</span>
                                <div class="slot-platforms">
                                    <i class="fab fa-instagram" style="color: var(--instagram);"></i>
                                    <i class="fab fa-tiktok"></i>
                                </div>
                                <span class="slot-status empty">No post scheduled</span>
                            </div>
                            <button class="btn btn-sm" onclick="schedulePost('21:00')">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Content Strategy & Coaching -->
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-top: 1.5rem;">
                <!-- Weekly Content Plan -->
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-tasks"></i> Weekly Content Checklist</h3>
                        <span class="badge" id="weeklyProgress">0/7</span>
                    </div>
                    <div class="card-content">
                        <div class="content-checklist" id="weeklyChecklist">
                            <div class="checklist-item" data-type="reel">
                                <input type="checkbox" id="reel1" onchange="updateWeeklyProgress()">
                                <label for="reel1">
                                    <i class="fas fa-video" style="color: var(--instagram);"></i>
                                    <span>Reel #1</span>
                                    <small>Behind-the-scenes or harvest</small>
                                </label>
                            </div>
                            <div class="checklist-item" data-type="reel">
                                <input type="checkbox" id="reel2" onchange="updateWeeklyProgress()">
                                <label for="reel2">
                                    <i class="fas fa-video" style="color: var(--instagram);"></i>
                                    <span>Reel #2</span>
                                    <small>Educational or tutorial</small>
                                </label>
                            </div>
                            <div class="checklist-item" data-type="carousel">
                                <input type="checkbox" id="carousel1" onchange="updateWeeklyProgress()">
                                <label for="carousel1">
                                    <i class="fas fa-images" style="color: var(--purple);"></i>
                                    <span>Carousel #1</span>
                                    <small>Product showcase or tips</small>
                                </label>
                            </div>
                            <div class="checklist-item" data-type="carousel">
                                <input type="checkbox" id="carousel2" onchange="updateWeeklyProgress()">
                                <label for="carousel2">
                                    <i class="fas fa-images" style="color: var(--purple);"></i>
                                    <span>Carousel #2</span>
                                    <small>Before/after or process</small>
                                </label>
                            </div>
                            <div class="checklist-item" data-type="story">
                                <input type="checkbox" id="stories" onchange="updateWeeklyProgress()">
                                <label for="stories">
                                    <i class="fas fa-circle-notch" style="color: var(--secondary);"></i>
                                    <span>Daily Stories</span>
                                    <small>Post stories every day</small>
                                </label>
                            </div>
                            <div class="checklist-item" data-type="tiktok">
                                <input type="checkbox" id="tiktok1" onchange="updateWeeklyProgress()">
                                <label for="tiktok1">
                                    <i class="fab fa-tiktok" style="color: #FE2C55;"></i>
                                    <span>TikTok Post</span>
                                    <small>#FarmTok content</small>
                                </label>
                            </div>
                            <div class="checklist-item" data-type="pinterest">
                                <input type="checkbox" id="pinterest1" onchange="updateWeeklyProgress()">
                                <label for="pinterest1">
                                    <i class="fab fa-pinterest" style="color: var(--pinterest);"></i>
                                    <span>5+ Pins</span>
                                    <small>Flower arrangements, farm scenes</small>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Algorithm Coach -->
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-lightbulb"></i> Algorithm Coach</h3>
                        <span class="badge" style="background: var(--gold); color: #000;">TIPS</span>
                    </div>
                    <div class="card-content" id="algorithmTips">
                        <div class="tip-card instagram">
                            <div class="tip-header">
                                <i class="fab fa-instagram"></i> Instagram 2025-2026
                            </div>
                            <ul class="tip-list">
                                <li><strong>Watch Time</strong> is #1 ranking factor</li>
                                <li><strong>Shares & DMs</strong> matter more than likes</li>
                                <li><strong>5 hashtags max</strong> (algorithm change!)</li>
                                <li>Post at <strong>4-5 PM</strong> or <strong>9 PM</strong></li>
                                <li>Best days: <strong>Wednesday & Thursday</strong></li>
                            </ul>
                        </div>
                        <div class="tip-card tiktok" style="margin-top: 1rem;">
                            <div class="tip-header">
                                <i class="fab fa-tiktok"></i> TikTok #FarmTok
                            </div>
                            <ul class="tip-list">
                                <li>New accounts CAN go viral immediately</li>
                                <li>Post <strong>1-4x daily</strong> for growth</li>
                                <li>Best: <strong>Saturday 9 AM</strong></li>
                                <li>5-7 sec for tips, 27-35 for tutorials</li>
                                <li>Use #FarmTok #Agriculture #FarmLife</li>
                            </ul>
                        </div>
                        <div class="tip-card pinterest" style="margin-top: 1rem;">
                            <div class="tip-header">
                                <i class="fab fa-pinterest"></i> Pinterest SEO
                            </div>
                            <ul class="tip-list">
                                <li>Pins drive traffic for <strong>YEARS</strong></li>
                                <li>Perfect for @tinyseedfleurs flowers</li>
                                <li>Create 5-10 themed boards</li>
                                <li>Links ARE encouraged (unlike FB)</li>
                                <li>83% of users make purchases!</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Growth Projection -->
            <div class="card" style="margin-top: 1.5rem;">
                <div class="card-header">
                    <h3><i class="fas fa-chart-line"></i> Growth Projection to Goals</h3>
                    <div style="display: flex; gap: 0.5rem;">
                        <button class="btn btn-sm" onclick="refreshGrowthData()">
                            <i class="fas fa-sync"></i> Refresh
                        </button>
                    </div>
                </div>
                <div class="card-content">
                    <canvas id="growthProjectionChart" height="250"></canvas>
                </div>
            </div>

            <!-- Platform Connection Status -->
            <div class="card" style="margin-top: 1.5rem;">
                <div class="card-header">
                    <h3><i class="fas fa-plug"></i> Platform Connections</h3>
                    <a href="#" onclick="switchTab('connections'); return false;" class="btn btn-sm">
                        <i class="fas fa-cog"></i> Manage
                    </a>
                </div>
                <div class="card-content">
                    <div class="connection-grid">
                        <div class="connection-status" id="igFarmConnection">
                            <i class="fab fa-instagram" style="color: var(--instagram);"></i>
                            <span>@tinyseedfarm</span>
                            <span class="status pending"><i class="fas fa-clock"></i> Connect</span>
                        </div>
                        <div class="connection-status" id="igFleursConnection">
                            <i class="fab fa-instagram" style="color: var(--instagram);"></i>
                            <span>@tinyseedfleurs</span>
                            <span class="status pending"><i class="fas fa-clock"></i> Connect</span>
                        </div>
                        <div class="connection-status" id="igFungiConnection">
                            <i class="fab fa-instagram" style="color: var(--instagram);"></i>
                            <span>@tinyseedfungi</span>
                            <span class="status pending"><i class="fas fa-clock"></i> Connect</span>
                        </div>
                        <div class="connection-status" id="fbConnection">
                            <i class="fab fa-facebook" style="color: var(--facebook);"></i>
                            <span>Facebook Page</span>
                            <span class="status pending"><i class="fas fa-clock"></i> Connect</span>
                        </div>
                        <div class="connection-status" id="tiktokConnection">
                            <i class="fab fa-tiktok"></i>
                            <span>TikTok</span>
                            <span class="status pending"><i class="fas fa-clock"></i> Connect</span>
                        </div>
                        <div class="connection-status" id="pinterestConnection">
                            <i class="fab fa-pinterest" style="color: var(--pinterest);"></i>
                            <span>Pinterest</span>
                            <span class="status pending"><i class="fas fa-clock"></i> Connect</span>
                        </div>
                    </div>
                    <div style="margin-top: 1rem; padding: 1rem; background: rgba(255,215,0,0.1); border-radius: 8px; border-left: 4px solid var(--gold);">
                        <strong><i class="fas fa-lightbulb" style="color: var(--gold);"></i> Recommended Tool:</strong>
                        <p style="margin-top: 0.5rem; color: var(--text-secondary);">
                            <strong>Buffer</strong> ($6/mo per channel) - Best for managing all platforms in one dashboard.
                            <br><span style="font-size: 0.85rem;">Or use <strong>Publer FREE</strong> for 3 Instagram accounts only.</span>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- TOAST CONTAINER -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- CAMPAIGN MODAL -->
    <div class="modal-overlay" id="campaignModal">
        <div class="modal">
            <div class="modal-header">
                <h2>Create Campaign</h2>
                <button class="modal-close" onclick="closeCampaignModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Campaign Name</label>
                    <input type="text" class="form-input" placeholder="e.g., Spring CSA Launch">
                </div>
                <div class="form-group">
                    <label class="form-label">Campaign Type</label>
                    <select class="form-input">
                        <option>Product Launch</option>
                        <option>Flash Sale</option>
                        <option>Seasonal Promotion</option>
                        <option>CSA Recruitment</option>
                        <option>Event</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Start Date</label>
                    <input type="date" class="form-input">
                </div>
                <div class="form-group">
                    <label class="form-label">End Date</label>
                    <input type="date" class="form-input">
                </div>
                <div class="form-group">
                    <label class="form-label">Budget</label>
                    <input type="number" class="form-input" placeholder="$0.00">
                </div>
                <div class="form-group">
                    <label class="form-label">Channels</label>
                    <div class="platform-toggles">
                        <div class="platform-toggle active">
                            <i class="fab fa-instagram" style="color: var(--instagram);"></i>
                            <span>Instagram</span>
                        </div>
                        <div class="platform-toggle active">
                            <i class="fab fa-facebook" style="color: var(--facebook);"></i>
                            <span>Facebook</span>
                        </div>
                        <div class="platform-toggle">
                            <i class="fas fa-envelope" style="color: var(--info);"></i>
                            <span>Email</span>
                        </div>
                        <div class="platform-toggle">
                            <i class="fas fa-sms" style="color: var(--success);"></i>
                            <span>SMS</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeCampaignModal()">Cancel</button>
                <button class="btn btn-primary" onclick="createCampaign()">Create Campaign</button>
            </div>
        </div>
    </div>

    <!-- SMS MARKETING MODAL -->
    <div class="modal-overlay" id="smsModal">
        <div class="modal" style="max-width: 550px;">
            <div class="modal-header" style="background: linear-gradient(135deg, var(--success) 0%, var(--teal) 100%);">
                <h2><i class="fas fa-sms"></i> SMS Marketing Blast</h2>
                <button class="modal-close" onclick="closeSMSModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div style="background: rgba(42, 157, 143, 0.2); padding: 0.75rem; border-radius: 8px; margin-bottom: 1rem; font-size: 0.85rem;">
                    <i class="fas fa-info-circle" style="color: var(--success);"></i>
                    <strong>Twilio Connected:</strong> +1 (412) 866-2259
                    <span style="float: right; color: var(--text-secondary);">~$0.0079/SMS</span>
                </div>

                <div class="form-group">
                    <label class="form-label">Recipient List</label>
                    <select class="form-input" id="smsRecipientList">
                        <option value="vip">VIP Customers (487 subscribers)</option>
                        <option value="csa">CSA Members (156 active)</option>
                        <option value="wholesale">Wholesale/Restaurant (23 contacts)</option>
                        <option value="market">Farmer's Market Signups (312)</option>
                        <option value="all">All Subscribers (892)</option>
                        <option value="custom">Custom List...</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">Message <span style="font-size: 0.75rem; color: var(--text-secondary);">(160 chars = 1 SMS segment)</span></label>
                    <textarea class="form-input" id="smsMessage" rows="4" maxlength="320" placeholder="Fresh harvest alert! ðŸ¥¬ Just picked: heirloom tomatoes, sweet corn, and basil. Reply STOP to unsubscribe." oninput="updateSMSCount()"></textarea>
                    <div style="display: flex; justify-content: space-between; margin-top: 0.5rem; font-size: 0.8rem;">
                        <span id="smsCharCount" style="color: var(--text-secondary);">0/160 characters</span>
                        <span id="smsSegments" style="color: var(--success);">1 segment</span>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Quick Templates</label>
                    <div style="display: flex; flex-wrap: wrap; gap: 0.5rem;">
                        <button class="btn btn-sm btn-secondary" onclick="useSMSTemplate('harvest')">ðŸ¥¬ Fresh Harvest</button>
                        <button class="btn btn-sm btn-secondary" onclick="useSMSTemplate('market')">ðŸª Market Day</button>
                        <button class="btn btn-sm btn-secondary" onclick="useSMSTemplate('csa')">ðŸ“¦ CSA Pickup</button>
                        <button class="btn btn-sm btn-secondary" onclick="useSMSTemplate('flash')">âš¡ Flash Sale</button>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Send Options</label>
                    <div style="display: flex; gap: 1rem;">
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                            <input type="radio" name="smsTiming" value="now" checked>
                            <span>Send Now</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                            <input type="radio" name="smsTiming" value="schedule">
                            <span>Schedule</span>
                        </label>
                    </div>
                    <input type="datetime-local" class="form-input" id="smsScheduleTime" style="margin-top: 0.5rem; display: none;">
                </div>

                <div style="background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 8px; margin-top: 1rem;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                        <span>Recipients:</span>
                        <span id="smsRecipientCount">487</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                        <span>Estimated Cost:</span>
                        <span id="smsCost" style="color: var(--warning);">$3.85</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span>Marketing Budget:</span>
                        <span style="color: var(--success);">$373 remaining</span>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeSMSModal()">Cancel</button>
                <button class="btn btn-primary" onclick="sendSMSCampaign()" style="background: linear-gradient(135deg, var(--success) 0%, var(--teal) 100%);">
                    <i class="fas fa-paper-plane"></i> Send SMS Blast
                </button>
            </div>
        </div>
    </div>

    <!-- FOLLOWER COUNT UPDATE MODAL -->
    <div class="modal-overlay" id="followerCountModal">
        <div class="modal" style="max-width: 500px;">
            <div class="modal-header" style="background: linear-gradient(135deg, var(--instagram) 0%, var(--purple) 100%);">
                <h2><i class="fas fa-users"></i> Update Follower Counts</h2>
                <button class="modal-close" onclick="closeFollowerCountModal()">&times;</button>
            </div>
            <div class="modal-body">
                <p style="color: var(--text-secondary); font-size: 0.85rem; margin-bottom: 1.5rem;">
                    Enter your current follower counts. Check each platform's app for accurate numbers.
                </p>

                <div class="form-group">
                    <label class="form-label" style="display: flex; align-items: center; gap: 0.5rem;">
                        <i class="fab fa-instagram" style="color: var(--instagram);"></i> Instagram
                    </label>
                    <input type="number" class="form-input" id="fcInstagram" placeholder="e.g., 1250" min="0">
                </div>

                <div class="form-group">
                    <label class="form-label" style="display: flex; align-items: center; gap: 0.5rem;">
                        <i class="fab fa-facebook" style="color: var(--facebook);"></i> Facebook
                    </label>
                    <input type="number" class="form-input" id="fcFacebook" placeholder="e.g., 850" min="0">
                </div>

                <div class="form-group">
                    <label class="form-label" style="display: flex; align-items: center; gap: 0.5rem;">
                        <i class="fab fa-tiktok"></i> TikTok
                    </label>
                    <input type="number" class="form-input" id="fcTiktok" placeholder="e.g., 500" min="0">
                </div>

                <div class="form-group">
                    <label class="form-label" style="display: flex; align-items: center; gap: 0.5rem;">
                        <i class="fab fa-youtube" style="color: var(--youtube);"></i> YouTube
                    </label>
                    <input type="number" class="form-input" id="fcYoutube" placeholder="e.g., 100" min="0">
                </div>

                <div class="form-group">
                    <label class="form-label" style="display: flex; align-items: center; gap: 0.5rem;">
                        <i class="fab fa-pinterest" style="color: var(--pinterest);"></i> Pinterest
                    </label>
                    <input type="number" class="form-input" id="fcPinterest" placeholder="e.g., 200" min="0">
                </div>

                <div style="background: rgba(155, 89, 182, 0.1); padding: 0.75rem; border-radius: 8px; font-size: 0.8rem; color: var(--text-secondary);">
                    <i class="fas fa-lightbulb" style="color: var(--gold);"></i>
                    <strong>Tip:</strong> Update weekly to track your growth over time!
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeFollowerCountModal()">Cancel</button>
                <button class="btn btn-primary" onclick="saveFollowerCounts()" style="background: linear-gradient(135deg, var(--instagram) 0%, var(--purple) 100%);">
                    <i class="fas fa-save"></i> Save Counts
                </button>
            </div>
        </div>
    </div>

    <!-- JAVASCRIPT -->
    <script>
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // API CONFIGURATION - using centralized api-config.js
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        const API_URL = TINY_SEED_API.MAIN_API;
        const APPS_SCRIPT_URL = API_URL; // Alias for social posting functions

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // TAB NAVIGATION
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        function switchTab(tabId) {
            // Update tab buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.closest('.tab-btn').classList.add('active');

            // Update tab content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(tabId + 'Tab').classList.add('active');
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // FIELD MODE FUNCTIONALITY
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        let selectedFile = null;
        let selectedPlatforms = ['instagram', 'facebook', 'tiktok', 'appfeed'];
        let isRecording = false;
        let mediaRecorder = null;

        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                selectedFile = file;
                const reader = new FileReader();
                reader.onload = function(e) {
                    const preview = document.getElementById('uploadPreview');
                    preview.src = e.target.result;
                    preview.classList.add('visible');
                    document.getElementById('uploadIcon').style.display = 'none';
                    document.getElementById('uploadText').textContent = file.name;
                    document.getElementById('uploadSubtext').textContent = `${(file.size / 1024 / 1024).toFixed(2)} MB`;
                    updateBlastButton();
                };
                reader.readAsDataURL(file);
            }
        }

        // Drag and drop
        const uploadZone = document.getElementById('uploadZone');
        uploadZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadZone.classList.add('dragover');
        });
        uploadZone.addEventListener('dragleave', () => {
            uploadZone.classList.remove('dragover');
        });
        uploadZone.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadZone.classList.remove('dragover');
            const file = e.dataTransfer.files[0];
            if (file) {
                document.getElementById('fileInput').files = e.dataTransfer.files;
                handleFileSelect({ target: { files: [file] } });
            }
        });

        function togglePlatform(element, platform) {
            element.classList.toggle('active');
            if (element.classList.contains('active')) {
                selectedPlatforms.push(platform);
            } else {
                selectedPlatforms = selectedPlatforms.filter(p => p !== platform);
            }
        }

        async function toggleVoiceRecording() {
            const btn = document.getElementById('voiceNoteBtn');

            if (!isRecording) {
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                    mediaRecorder = new MediaRecorder(stream);
                    const chunks = [];

                    mediaRecorder.ondataavailable = (e) => chunks.push(e.data);
                    mediaRecorder.onstop = async () => {
                        const blob = new Blob(chunks, { type: 'audio/webm' });
                        // Here we would send to Whisper API for transcription
                        showToast('Voice note recorded! AI transcription coming...', 'success');
                        // Simulate AI transcription
                        setTimeout(() => {
                            document.getElementById('captionInput').value =
                                "Fresh tomatoes just came in! These beauties are ready for your salsa weekend. Come grab them while they last!";
                        }, 1500);
                    };

                    mediaRecorder.start();
                    isRecording = true;
                    btn.classList.add('recording');
                    btn.querySelector('span').textContent = 'Recording... Tap to stop';
                } catch (err) {
                    showToast('Could not access microphone', 'error');
                }
            } else {
                mediaRecorder.stop();
                isRecording = false;
                btn.classList.remove('recording');
                btn.querySelector('span').textContent = 'Record Voice Note';
            }
        }

        async function generateAICaption() {
            showToast('Generating AI caption...', 'info');
            // Simulate AI caption generation
            setTimeout(() => {
                const captions = [
                    "Fresh from the field! These gorgeous tomatoes are peak season perfection. Limited quantities available - order now before they're gone! ðŸ…",
                    "Nature's candy is here! Our heirloom tomatoes are bursting with flavor. Perfect for your weekend cooking adventures.",
                    "Straight from our hands to your table. These beauties were picked this morning and are ready to make your recipes shine!"
                ];
                document.getElementById('captionInput').value = captions[Math.floor(Math.random() * captions.length)];
                showToast('Caption generated!', 'success');
                updateBlastButton();
            }, 1000);
        }

        function updateBlastButton() {
            const btn = document.getElementById('blastBtn');
            const hasFile = selectedFile !== null;
            const hasCaption = document.getElementById('captionInput').value.trim().length > 0;
            const hasPlatforms = selectedPlatforms.length > 0;

            btn.disabled = !(hasFile && hasCaption && hasPlatforms);
        }

        document.getElementById('captionInput').addEventListener('input', updateBlastButton);

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // CHARACTER COUNT
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        const charLimits = {
            tiktok: 2200,
            instagram: 2200,
            facebook: 63206,
            youtube: 5000,
            pinterest: 500
        };

        function updateCharCount() {
            const text = document.getElementById('captionInput').value;
            const len = text.length;

            // Update each platform count
            const platforms = [
                { id: 'charTiktok', icon: 'fab fa-tiktok', limit: charLimits.tiktok },
                { id: 'charInsta', icon: 'fab fa-instagram', limit: charLimits.instagram },
                { id: 'charFb', icon: 'fab fa-facebook', limit: charLimits.facebook },
                { id: 'charYt', icon: 'fab fa-youtube', limit: charLimits.youtube }
            ];

            platforms.forEach(p => {
                const el = document.getElementById(p.id);
                if (el) {
                    el.innerHTML = `<i class="${p.icon}"></i> ${len}/${p.limit}`;
                    if (len > p.limit) {
                        el.classList.add('over-limit');
                    } else {
                        el.classList.remove('over-limit');
                    }
                }
            });
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // SCHEDULE MODE
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        let isScheduled = false;

        function toggleScheduleMode() {
            isScheduled = !isScheduled;
            const toggle = document.getElementById('scheduleToggle');
            const datetime = document.getElementById('scheduleDateTime');
            const blastBtn = document.getElementById('blastBtn');

            if (isScheduled) {
                toggle.classList.add('active');
                toggle.innerHTML = '<i class="fas fa-clock"></i> Scheduled';
                datetime.classList.add('visible');
                blastBtn.innerHTML = '<i class="fas fa-calendar-check"></i> SCHEDULE POST';

                // Default to tomorrow at 9am
                const tomorrow = new Date();
                tomorrow.setDate(tomorrow.getDate() + 1);
                tomorrow.setHours(9, 0, 0, 0);
                datetime.value = tomorrow.toISOString().slice(0, 16);
            } else {
                toggle.classList.remove('active');
                toggle.innerHTML = '<i class="fas fa-clock"></i> Schedule Post';
                datetime.classList.remove('visible');
                blastBtn.innerHTML = '<i class="fas fa-paper-plane"></i> PUBLISH ALL';
            }
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // DRAFT SAVING
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        const DRAFT_KEY = 'tinyseed_post_draft';

        function saveDraft() {
            const caption = document.getElementById('captionInput').value;
            const scheduleTime = document.getElementById('scheduleDateTime').value;

            if (!caption.trim()) {
                showToast('Nothing to save!', 'warning');
                return;
            }

            const draft = {
                caption: caption,
                platforms: selectedPlatforms,
                isScheduled: isScheduled,
                scheduleTime: scheduleTime,
                savedAt: new Date().toISOString()
            };

            localStorage.setItem(DRAFT_KEY, JSON.stringify(draft));
            showToast('Draft saved!', 'success');

            // Update button to show draft exists
            document.getElementById('draftBtn').classList.add('has-draft');
        }

        function loadDraft() {
            const saved = localStorage.getItem(DRAFT_KEY);
            if (!saved) {
                showToast('No draft found', 'warning');
                return;
            }

            try {
                const draft = JSON.parse(saved);

                // Load caption
                document.getElementById('captionInput').value = draft.caption || '';
                updateCharCount();
                updateBlastButton();

                // Load schedule mode
                if (draft.isScheduled && !isScheduled) {
                    toggleScheduleMode();
                }
                if (draft.scheduleTime) {
                    document.getElementById('scheduleDateTime').value = draft.scheduleTime;
                }

                // Load platform selections
                if (draft.platforms) {
                    // Reset all toggles first
                    document.querySelectorAll('.platform-toggle').forEach(el => {
                        el.classList.remove('active');
                    });
                    selectedPlatforms = [];

                    // Set saved platforms
                    draft.platforms.forEach(platform => {
                        const toggle = document.querySelector(`.platform-toggle[onclick*="'${platform}'"]`);
                        if (toggle) {
                            toggle.classList.add('active');
                            selectedPlatforms.push(platform);
                        }
                    });
                }

                const savedTime = new Date(draft.savedAt).toLocaleString();
                showToast(`Draft loaded (saved ${savedTime})`, 'success');

            } catch (e) {
                showToast('Error loading draft', 'error');
                console.error('Draft load error:', e);
            }
        }

        function deleteDraft() {
            localStorage.removeItem(DRAFT_KEY);
            document.getElementById('draftBtn').classList.remove('has-draft');
            document.getElementById('loadDraftBtn').style.display = 'none';
        }

        function checkForDraft() {
            const saved = localStorage.getItem(DRAFT_KEY);
            if (saved) {
                document.getElementById('draftBtn').classList.add('has-draft');
                document.getElementById('loadDraftBtn').style.display = 'flex';
            }
        }

        // Check for drafts on page load
        checkForDraft();

        async function publishAll() {
            const btn = document.getElementById('blastBtn');
            const timer = document.getElementById('postTimer');
            const startTime = Date.now();
            const caption = document.getElementById('captionInput').value;
            const scheduleTime = isScheduled ? document.getElementById('scheduleDateTime').value : null;

            btn.disabled = true;
            btn.innerHTML = isScheduled
                ? '<i class="fas fa-spinner fa-spin"></i> Scheduling...'
                : '<i class="fas fa-spinner fa-spin"></i> Publishing...';
            timer.innerHTML = '<i class="fas fa-stopwatch"></i> Working...';

            // Filter social platforms (exclude appfeed, sms which are internal)
            const socialPlatforms = selectedPlatforms.filter(p =>
                ['tiktok', 'instagram', 'facebook', 'youtube', 'pinterest', 'threads'].includes(p)
            );

            try {
                // Call Ayrshare API if we have social platforms
                if (socialPlatforms.length > 0) {
                    const response = await fetch(APPS_SCRIPT_URL, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            action: 'publishSocialPost',
                            caption: caption,
                            platforms: socialPlatforms,
                            scheduleDate: scheduleTime ? new Date(scheduleTime).toISOString() : null
                        })
                    });
                    const result = await response.json();

                    if (!result.success) {
                        throw new Error(result.error || 'Failed to publish');
                    }
                }

                // Handle app feed separately (our internal system)
                if (selectedPlatforms.includes('appfeed')) {
                    // Post to our app feed
                    await fetch(APPS_SCRIPT_URL, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            action: 'postToAppFeed',
                            content: caption
                        })
                    });
                }

                const elapsed = ((Date.now() - startTime) / 1000).toFixed(1);
                timer.innerHTML = `<i class="fas fa-check"></i> ${elapsed}s`;
                timer.style.background = 'var(--success)';

                if (isScheduled) {
                    const scheduleDate = new Date(scheduleTime);
                    btn.innerHTML = '<i class="fas fa-calendar-check"></i> SCHEDULED!';
                    showToast(`Scheduled for ${scheduleDate.toLocaleString()} on ${selectedPlatforms.length} platforms!`, 'success');
                } else {
                    btn.innerHTML = '<i class="fas fa-check"></i> PUBLISHED!';
                    showToast(`Posted to ${selectedPlatforms.length} platforms in ${elapsed} seconds!`, 'success');
                }

                // Log to marketing spend
                logMarketingActivity('social_post', {
                    platforms: selectedPlatforms,
                    time: elapsed,
                    caption: caption.substring(0, 50),
                    scheduled: isScheduled,
                    scheduleTime: scheduleTime
                });

                // Delete draft after successful publish
                deleteDraft();

            } catch (error) {
                console.error('Publish error:', error);
                showToast('Error: ' + error.message, 'error');
                btn.innerHTML = '<i class="fas fa-exclamation-triangle"></i> FAILED';
                timer.innerHTML = '<i class="fas fa-times"></i> Error';
                timer.style.background = 'var(--danger)';
            }

            // Reset after 3 seconds
            setTimeout(() => {
                btn.innerHTML = isScheduled
                    ? '<i class="fas fa-calendar-check"></i> SCHEDULE POST'
                    : '<i class="fas fa-paper-plane"></i> PUBLISH ALL';
                timer.innerHTML = '<i class="fas fa-stopwatch"></i> Ready';
                timer.style.background = 'var(--success)';
                selectedFile = null;
                document.getElementById('uploadPreview').classList.remove('visible');
                document.getElementById('uploadIcon').style.display = 'block';
                document.getElementById('uploadText').textContent = 'Drop media here or tap to upload';
                document.getElementById('uploadSubtext').textContent = 'Photos and videos up to 100MB';
                document.getElementById('captionInput').value = '';
                updateCharCount();
                updateBlastButton();
                // Reset schedule mode
                if (isScheduled) toggleScheduleMode();
            }, 3000);
        }

        function triggerEmergencyHarvest() {
            if (confirm('This will send an IMMEDIATE push notification to ALL users. Are you sure?')) {
                showToast('Emergency harvest alert sent to all users!', 'success');
                logMarketingActivity('emergency_alert', { timestamp: new Date().toISOString() });
            }
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // FARM PICS GALLERY
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        // Farm pics - loaded from API
        let farmPicsData = [];

        function renderFarmPics(filter = 'all') {
            const gallery = document.getElementById('farmPicsGallery');
            let filtered = farmPicsData;

            if (filter !== 'all') {
                if (['new', 'approved', 'used'].includes(filter)) {
                    filtered = farmPicsData.filter(pic => pic.status === filter);
                } else {
                    filtered = farmPicsData.filter(pic => pic.category === filter);
                }
            }

            gallery.innerHTML = filtered.map(pic => `
                <div class="gallery-item" data-id="${pic.id}">
                    <img src="${pic.url}" alt="Farm pic by ${pic.author}">
                    <div class="gallery-item-overlay">
                        <div class="gallery-item-meta">
                            <div class="gallery-item-author">
                                <i class="fas fa-user-circle"></i>
                                ${pic.author}
                            </div>
                            <span class="gallery-item-status ${pic.status}">${pic.status}</span>
                        </div>
                    </div>
                    <div class="gallery-item-actions">
                        ${pic.status === 'new' ? `
                            <button class="gallery-action-btn approve" onclick="approvePic(${pic.id})" title="Approve">
                                <i class="fas fa-check"></i>
                            </button>
                        ` : ''}
                        <button class="gallery-action-btn use" onclick="usePicInPost(${pic.id})" title="Use in post">
                            <i class="fas fa-share"></i>
                        </button>
                        <button class="gallery-action-btn delete" onclick="deletePic(${pic.id})" title="Delete">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function filterGallery(filter, btn) {
            document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            renderFarmPics(filter);
        }

        function approvePic(id) {
            const pic = farmPicsData.find(p => p.id === id);
            if (pic) {
                pic.status = 'approved';
                renderFarmPics();
                updateNewPicsBadge();
                showToast('Photo approved!', 'success');
            }
        }

        function approveAllPics() {
            farmPicsData.forEach(pic => {
                if (pic.status === 'new') pic.status = 'approved';
            });
            renderFarmPics();
            updateNewPicsBadge();
            showToast('All new photos approved!', 'success');
        }

        function usePicInPost(id) {
            const pic = farmPicsData.find(p => p.id === id);
            if (pic) {
                pic.status = 'used';
                switchTab('fieldmode');
                // Simulate loading the image
                const preview = document.getElementById('uploadPreview');
                preview.src = pic.url;
                preview.classList.add('visible');
                document.getElementById('uploadIcon').style.display = 'none';
                document.getElementById('uploadText').textContent = 'Farm pic by ' + pic.author;
                selectedFile = { name: 'farm_pic_' + id + '.jpg' }; // Fake file object
                updateBlastButton();
                showToast('Photo loaded into Field Mode!', 'info');
            }
        }

        function deletePic(id) {
            if (confirm('Delete this photo?')) {
                const index = farmPicsData.findIndex(p => p.id === id);
                if (index > -1) {
                    farmPicsData.splice(index, 1);
                    renderFarmPics();
                    updateNewPicsBadge();
                    showToast('Photo deleted', 'info');
                }
            }
        }

        function updateNewPicsBadge() {
            const newCount = farmPicsData.filter(p => p.status === 'new').length;
            document.getElementById('newPicsBadge').textContent = newCount;
            document.getElementById('newPicsBadge').style.display = newCount > 0 ? 'inline' : 'none';
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // CAMPAIGNS
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        // Campaigns - loaded from API
        let campaignsData = [];

        function renderCampaigns() {
            const list = document.getElementById('campaignList');
            list.innerHTML = campaignsData.map(campaign => `
                <div class="campaign-item">
                    <div class="campaign-info">
                        <div class="campaign-icon ${campaign.status}">
                            <i class="fas fa-${campaign.status === 'active' ? 'play' : campaign.status === 'scheduled' ? 'clock' : campaign.status === 'completed' ? 'check' : 'file'}"></i>
                        </div>
                        <div class="campaign-details">
                            <h4>${campaign.name}</h4>
                            <div class="campaign-meta">
                                <span>${campaign.type}</span>
                                <span>${campaign.startDate} - ${campaign.endDate}</span>
                                <span>$${campaign.spent}/$${campaign.budget}</span>
                            </div>
                        </div>
                    </div>
                    <div class="campaign-stats">
                        <div class="campaign-stat">
                            <div class="campaign-stat-value">${campaign.reach.toLocaleString()}</div>
                            <div class="campaign-stat-label">Reach</div>
                        </div>
                        <div class="campaign-stat">
                            <div class="campaign-stat-value">${campaign.conversions}</div>
                            <div class="campaign-stat-label">Conversions</div>
                        </div>
                        <button class="btn btn-sm btn-secondary">
                            <i class="fas fa-ellipsis-h"></i>
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function openCampaignModal() {
            document.getElementById('campaignModal').classList.add('active');
        }

        function closeCampaignModal() {
            document.getElementById('campaignModal').classList.remove('active');
        }

        function createCampaign() {
            showToast('Campaign created!', 'success');
            closeCampaignModal();
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // SCHEDULE CALENDAR
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        function renderScheduleCalendar() {
            const calendar = document.getElementById('scheduleCalendar');
            const days = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];
            const posts = {
                13: ['Week Preview'],
                14: ['In the Field'],
                15: ['Recipe Drop'],
                16: ['Behind Scenes'],
                17: ['Weekend Preview'],
                18: ['Market Day Live'],
                19: []
            };

            calendar.innerHTML = days.map((day, i) => {
                const date = 13 + i;
                const dayPosts = posts[date] || [];
                return `
                    <div class="schedule-day">
                        <div class="schedule-day-header">${day}</div>
                        <div class="schedule-day-number">${date}</div>
                        ${dayPosts.map(post => `<div class="schedule-post">${post}</div>`).join('')}
                    </div>
                `;
            }).join('');
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // CHARTS
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        function initCharts() {
            // Charts will be initialized when real data is available
            // Currently no chart data to display
            console.log('Charts: No data available yet');
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // FINANCIAL INTEGRATION
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        async function logMarketingActivity(type, data) {
            try {
                await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        action: 'logMarketingActivity',
                        type: type,
                        data: data,
                        timestamp: new Date().toISOString()
                    })
                });
            } catch (error) {
                console.log('Marketing activity logged locally:', type, data);
            }
        }

        async function getMarketingBudget() {
            try {
                const response = await fetch(`${API_URL}?action=getMarketingBudget`);
                return await response.json();
            } catch (error) {
                // Return zeros - no fake data
                return { allocated: 0, spent: 0, remaining: 0 };
            }
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // UTILITY FUNCTIONS
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        function showToast(message, type = 'info') {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
                <span>${message}</span>
            `;
            container.appendChild(toast);
            setTimeout(() => toast.remove(), 4000);
        }

        function sendSMSBlast() {
            document.getElementById('smsModal').classList.add('active');
            updateSMSCount();
            updateSMSCost();

            // Setup timing toggle
            document.querySelectorAll('input[name="smsTiming"]').forEach(radio => {
                radio.addEventListener('change', (e) => {
                    document.getElementById('smsScheduleTime').style.display =
                        e.target.value === 'schedule' ? 'block' : 'none';
                });
            });

            // Setup recipient list change
            document.getElementById('smsRecipientList').addEventListener('change', updateSMSCost);
        }

        function closeSMSModal() {
            document.getElementById('smsModal').classList.remove('active');
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // FOLLOWER COUNT UPDATE
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        function openFollowerCountModal() {
            // Pre-fill with current values if available
            loadCurrentFollowerCounts();
            document.getElementById('followerCountModal').classList.add('active');
        }

        function closeFollowerCountModal() {
            document.getElementById('followerCountModal').classList.remove('active');
        }

        async function loadCurrentFollowerCounts() {
            try {
                const response = await fetch(`${API_URL}?action=getSocialConnections`);
                const result = await response.json();

                if (result.success && result.connections) {
                    result.connections.forEach(conn => {
                        const platform = conn.Platform.toLowerCase();
                        const followers = conn.Followers || 0;

                        const inputId = {
                            'instagram': 'fcInstagram',
                            'facebook': 'fcFacebook',
                            'tiktok': 'fcTiktok',
                            'youtube': 'fcYoutube',
                            'pinterest': 'fcPinterest'
                        }[platform];

                        if (inputId && followers > 0) {
                            document.getElementById(inputId).value = followers;
                        }
                    });
                }
            } catch (error) {
                console.log('Could not load current counts:', error);
            }
        }

        async function saveFollowerCounts() {
            const counts = {
                instagram: parseInt(document.getElementById('fcInstagram').value) || 0,
                facebook: parseInt(document.getElementById('fcFacebook').value) || 0,
                tiktok: parseInt(document.getElementById('fcTiktok').value) || 0,
                youtube: parseInt(document.getElementById('fcYoutube').value) || 0,
                pinterest: parseInt(document.getElementById('fcPinterest').value) || 0
            };

            // Show saving state
            const saveBtn = document.querySelector('#followerCountModal .btn-primary');
            const originalText = saveBtn.innerHTML;
            saveBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Saving...';
            saveBtn.disabled = true;

            try {
                // Use GET to avoid CORS preflight issues
                const params = new URLSearchParams({
                    action: 'updateFollowerCounts',
                    instagram: counts.instagram,
                    facebook: counts.facebook,
                    tiktok: counts.tiktok,
                    youtube: counts.youtube,
                    pinterest: counts.pinterest
                });

                const response = await fetch(`${API_URL}?${params.toString()}`);
                const result = await response.json();

                if (result.success) {
                    showToast('Follower counts updated!', 'success');
                    closeFollowerCountModal();

                    // Refresh the connections display
                    loadSocialConnections();
                } else {
                    showToast('Failed to save: ' + (result.error || 'Unknown error'), 'error');
                }
            } catch (error) {
                showToast('Error saving counts: ' + error.message, 'error');
            } finally {
                saveBtn.innerHTML = originalText;
                saveBtn.disabled = false;
            }
        }

        function updateSMSCount() {
            const message = document.getElementById('smsMessage').value;
            const charCount = message.length;
            const segments = Math.ceil(charCount / 160) || 1;

            document.getElementById('smsCharCount').textContent = `${charCount}/160 characters`;
            document.getElementById('smsSegments').textContent = `${segments} segment${segments > 1 ? 's' : ''}`;
            document.getElementById('smsSegments').style.color = segments > 1 ? 'var(--warning)' : 'var(--success)';

            updateSMSCost();
        }

        function updateSMSCost() {
            const recipientCounts = {
                'vip': 487,
                'csa': 156,
                'wholesale': 23,
                'market': 312,
                'all': 892,
                'custom': 0
            };

            const list = document.getElementById('smsRecipientList').value;
            const recipients = recipientCounts[list] || 0;
            const message = document.getElementById('smsMessage').value;
            const segments = Math.ceil(message.length / 160) || 1;
            const costPerSMS = 0.0079;
            const totalCost = (recipients * segments * costPerSMS).toFixed(2);

            document.getElementById('smsRecipientCount').textContent = recipients;
            document.getElementById('smsCost').textContent = `$${totalCost}`;
        }

        function useSMSTemplate(type) {
            const templates = {
                'harvest': 'ðŸ¥¬ FRESH HARVEST! Just picked today: heirloom tomatoes, sweet corn, basil & more! Order now for delivery or market pickup. TinySeedFarm.com Reply STOP to opt out',
                'market': 'ðŸª See you TODAY at the farmers market! Fresh produce, seasonal specials & your favorites. East Liberty 9am-1pm. Reply STOP to opt out',
                'csa': 'ðŸ“¦ CSA REMINDER: Your box is ready for pickup today 3-7pm! This week: tomatoes, peppers, zucchini, herbs. Reply STOP to opt out',
                'flash': 'âš¡ FLASH SALE! 25% off all greens today only. Too much rain = happy lettuce! Order by 2pm for same-day. Code: GREENS25. Reply STOP to opt out'
            };

            document.getElementById('smsMessage').value = templates[type] || '';
            updateSMSCount();
        }

        async function sendSMSCampaign() {
            const list = document.getElementById('smsRecipientList').value;
            const message = document.getElementById('smsMessage').value;
            const timing = document.querySelector('input[name="smsTiming"]:checked').value;
            const scheduleTime = document.getElementById('smsScheduleTime').value;

            if (!message.trim()) {
                showToast('Please enter a message', 'error');
                return;
            }

            // Confirm send
            const recipientCount = document.getElementById('smsRecipientCount').textContent;
            const cost = document.getElementById('smsCost').textContent;

            if (!confirm(`Send SMS to ${recipientCount} recipients?\nEstimated cost: ${cost}`)) {
                return;
            }

            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'text/plain' },
                    body: JSON.stringify({
                        action: 'sendSMSCampaign',
                        list: list,
                        message: message,
                        scheduleTime: timing === 'schedule' ? scheduleTime : null
                    })
                });

                const result = await response.json();

                if (result.success) {
                    showToast(`SMS campaign sent to ${result.sent || recipientCount} recipients!`, 'success');
                    closeSMSModal();

                    // Log to marketing spend
                    await fetch(API_URL, {
                        method: 'POST',
                        headers: { 'Content-Type': 'text/plain' },
                        body: JSON.stringify({
                            action: 'logMarketingSpend',
                            category: 'sms',
                            description: `SMS Blast - ${list} list`,
                            amount: parseFloat(cost.replace('$', '')),
                            date: new Date().toISOString().split('T')[0]
                        })
                    });
                } else {
                    showToast(result.error || 'Failed to send SMS campaign', 'error');
                }
            } catch (error) {
                console.error('SMS Campaign Error:', error);
                showToast('Error sending SMS campaign', 'error');
            }
        }

        function openEmailComposer() {
            showToast('Opening email composer...', 'info');
        }

        function approveSurplusEmail() {
            showToast('Surplus email approved and sent!', 'success');
        }

        function connectTikTok() {
            // TikTok connection via Ayrshare
            showToast('Redirecting to Ayrshare to connect TikTok...', 'info');
            setTimeout(() => {
                window.open('https://app.ayrshare.com/dashboard', '_blank');
            }, 1000);
        }

        function connectYouTube() {
            // YouTube connection via Ayrshare
            showToast('Redirecting to Ayrshare to connect YouTube...', 'info');
            setTimeout(() => {
                window.open('https://app.ayrshare.com/dashboard', '_blank');
            }, 1000);
        }

        function connectPinterest() {
            // Pinterest connection via Ayrshare
            showToast('Redirecting to Ayrshare to connect Pinterest...', 'info');
            setTimeout(() => {
                window.open('https://app.ayrshare.com/dashboard', '_blank');
            }, 1000);
        }

        function connectThreads() {
            // Threads connection via Ayrshare (Instagram companion)
            showToast('Threads requires Instagram connection first. Redirecting to Ayrshare...', 'info');
            setTimeout(() => {
                window.open('https://app.ayrshare.com/dashboard', '_blank');
            }, 1000);
        }

        function openBudgetSettings() {
            showToast('Budget settings modal coming soon!', 'info');
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // API DATA LOADING
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        async function loadFarmPics() {
            try {
                const response = await fetch(`${API_URL}?action=getFarmPics`);
                const result = await response.json();
                if (result.success && result.farmPics) {
                    farmPicsData = result.farmPics.map(pic => ({
                        id: pic.Pic_ID || pic.id,
                        url: pic.Image_URL || pic.url || 'https://via.placeholder.com/400x300?text=No+Image',
                        author: pic.Employee_Name || pic.author || 'Unknown',
                        status: (pic.Status || pic.status || 'new').toLowerCase(),
                        category: (pic.Category || pic.category || 'general').toLowerCase(),
                        date: formatRelativeDate(pic.Submitted_At || pic.date)
                    }));
                }
                renderFarmPics();
                updateNewPicsBadge();
            } catch (error) {
                console.error('Error loading farm pics:', error);
                renderFarmPics(); // Render empty state
            }
        }

        async function loadCampaigns() {
            try {
                const response = await fetch(`${API_URL}?action=getMarketingCampaigns`);
                const result = await response.json();
                if (result.success && result.campaigns) {
                    campaignsData = result.campaigns.map(c => ({
                        id: c.Campaign_ID || c.id,
                        name: c.Name || c.name || 'Untitled Campaign',
                        type: c.Type || c.type || 'General',
                        status: (c.Status || c.status || 'draft').toLowerCase(),
                        startDate: formatShortDate(c.Start_Date || c.startDate),
                        endDate: formatShortDate(c.End_Date || c.endDate),
                        budget: parseFloat(c.Budget || c.budget) || 0,
                        spent: parseFloat(c.Spent || c.spent) || 0,
                        reach: parseInt(c.Reach || c.reach) || 0,
                        conversions: parseInt(c.Conversions || c.conversions) || 0
                    }));
                }
                renderCampaigns();
            } catch (error) {
                console.error('Error loading campaigns:', error);
                renderCampaigns(); // Render empty state
            }
        }

        async function loadSocialConnections() {
            try {
                const response = await fetch(`${API_URL}?action=getSocialConnections`);
                const result = await response.json();
                if (result.success && result.connections) {
                    updateConnectionsUI(result.connections, result.ayrshareEnabled);
                }
            } catch (error) {
                console.error('Error loading social connections:', error);
            }
        }

        async function loadDashboardStats() {
            try {
                const response = await fetch(`${API_URL}?action=getMarketingAnalytics`);
                const result = await response.json();
                if (result.success) {
                    updateDashboardStats(result);
                }
            } catch (error) {
                console.error('Error loading dashboard stats:', error);
            }
        }

        function updateConnectionsUI(connections, ayrshareEnabled) {
            // Update connection cards based on API data
            connections.forEach(conn => {
                const platform = conn.Platform || conn.platform;
                const status = conn.Status || conn.status;
                const followers = conn.Followers || conn.followers || 0;

                // Find and update the connection card for this platform
                const card = document.querySelector(`[data-platform="${platform}"]`);
                if (card) {
                    const statusEl = card.querySelector('.connection-status');
                    const followersEl = card.querySelector('.connection-stat-value');
                    if (statusEl) {
                        statusEl.className = 'connection-status ' + (status === 'connected' ? 'connected' : 'disconnected');
                        statusEl.innerHTML = status === 'connected'
                            ? '<i class="fas fa-check-circle"></i> Connected'
                            : '<i class="fas fa-times-circle"></i> Not Connected';
                    }
                    if (followersEl && followers > 0) {
                        followersEl.textContent = formatNumber(followers);
                    }
                }
            });

            // Update Ayrshare status
            const ayrshareStatus = document.getElementById('ayrshareStatus');
            if (ayrshareStatus) {
                ayrshareStatus.className = 'connection-status ' + (ayrshareEnabled ? 'connected' : 'disconnected');
                ayrshareStatus.innerHTML = ayrshareEnabled
                    ? '<i class="fas fa-check-circle"></i> Active'
                    : '<i class="fas fa-times-circle"></i> Not Configured';
            }
        }

        function updateDashboardStats(data) {
            // Update stats if elements exist
            if (data.instagramFollowers !== undefined) {
                const el = document.getElementById('statInstagramFollowers');
                if (el) el.textContent = formatNumber(data.instagramFollowers);
            }
            if (data.facebookFollowers !== undefined) {
                const el = document.getElementById('statFacebookFollowers');
                if (el) el.textContent = formatNumber(data.facebookFollowers);
            }
        }

        // Helper functions
        function formatRelativeDate(dateStr) {
            if (!dateStr) return 'Unknown';
            const date = new Date(dateStr);
            const now = new Date();
            const diffDays = Math.floor((now - date) / (1000 * 60 * 60 * 24));

            if (diffDays === 0) return 'Today';
            if (diffDays === 1) return 'Yesterday';
            if (diffDays < 7) return `${diffDays} days ago`;
            if (diffDays < 14) return '1 week ago';
            return `${Math.floor(diffDays / 7)} weeks ago`;
        }

        function formatShortDate(dateStr) {
            if (!dateStr) return '';
            const date = new Date(dateStr);
            return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
        }

        function formatNumber(num) {
            if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
            if (num >= 1000) return (num / 1000).toFixed(1) + 'K';
            return num.toLocaleString();
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // MARKETING INTELLIGENCE FUNCTIONS
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        async function loadIntelligenceDashboard() {
            try {
                const response = await fetch(`${API_URL}?action=getMarketingDashboard`);
                const data = await response.json();

                if (data.success && data.data) {
                    const intel = data.data;

                    // Update summary cards
                    document.getElementById('intelTotalCustomers').textContent = intel.totalCustomers || 0;
                    document.getElementById('intelAtRisk').textContent = intel.atRiskCount || 0;
                    document.getElementById('intelChampions').textContent = intel.championCount || 0;
                    document.getElementById('intelAvgCLV').textContent = '$' + (intel.avgCLV || 0).toFixed(0);

                    // Update segments
                    if (intel.segments) {
                        renderCustomerSegments(intel.segments);
                    }

                    // Update attribution
                    if (intel.attribution) {
                        renderAttribution(intel.attribution);
                    }
                }
            } catch (error) {
                console.error('Error loading intelligence dashboard:', error);
            }
        }

        function renderCustomerSegments(segments) {
            const container = document.getElementById('customerSegmentsContainer');
            if (!container) return;

            const segmentColors = {
                'Champions': 'var(--success)',
                'Loyal': 'var(--info)',
                'New': 'var(--purple)',
                'At Risk': 'var(--warning)',
                'Needs Attention': 'var(--secondary)',
                'Lost': 'var(--danger)'
            };

            const segmentIcons = {
                'Champions': 'fa-crown',
                'Loyal': 'fa-heart',
                'New': 'fa-star',
                'At Risk': 'fa-exclamation-triangle',
                'Needs Attention': 'fa-user-clock',
                'Lost': 'fa-user-slash'
            };

            let html = '';
            for (const [segment, count] of Object.entries(segments)) {
                const color = segmentColors[segment] || 'var(--text-secondary)';
                const icon = segmentIcons[segment] || 'fa-users';
                html += `
                    <div style="background: rgba(255,255,255,0.05); padding: 1.25rem; border-radius: 10px; border-left: 4px solid ${color};">
                        <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.5rem;">
                            <i class="fas ${icon}" style="color: ${color}; font-size: 1.25rem;"></i>
                            <span style="font-weight: 600;">${segment}</span>
                        </div>
                        <div style="font-size: 2rem; font-weight: 700; color: ${color};">${count}</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">customers</div>
                    </div>
                `;
            }
            container.innerHTML = html || '<p style="color: var(--text-secondary);">No segment data available</p>';
        }

        async function loadNextBestActions() {
            const container = document.getElementById('nextBestActionsContainer');
            if (!container) return;

            try {
                const response = await fetch(`${API_URL}?action=getNextBestAction&limit=10`);
                const data = await response.json();

                if (data.success && data.actions && data.actions.length > 0) {
                    const priorityColors = {
                        'critical': 'var(--danger)',
                        'high': 'var(--warning)',
                        'medium': 'var(--info)',
                        'low': 'var(--success)'
                    };

                    const actionIcons = {
                        'RETENTION_EMERGENCY': 'fa-ambulance',
                        'REENGAGEMENT_CAMPAIGN': 'fa-redo',
                        'REFERRAL_REQUEST': 'fa-share-alt',
                        'ONBOARDING_SEQUENCE': 'fa-user-plus',
                        'CSA_UPSELL': 'fa-arrow-up',
                        'SEASONAL_REACTIVATION': 'fa-calendar-check'
                    };

                    let html = '<div style="display: grid; gap: 1rem;">';
                    for (const action of data.actions) {
                        const color = priorityColors[action.priority] || 'var(--text-secondary)';
                        const icon = actionIcons[action.actionType] || 'fa-lightbulb';
                        html += `
                            <div style="background: rgba(255,255,255,0.05); padding: 1rem; border-radius: 10px; border-left: 4px solid ${color}; display: flex; align-items: center; gap: 1rem;">
                                <i class="fas ${icon}" style="color: ${color}; font-size: 1.5rem;"></i>
                                <div style="flex: 1;">
                                    <div style="font-weight: 600;">${action.customerName || 'Unknown Customer'}</div>
                                    <div style="font-size: 0.85rem; color: var(--text-secondary);">${action.message || action.actionType}</div>
                                </div>
                                <span style="padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.75rem; background: ${color}; color: #fff; text-transform: uppercase;">${action.priority}</span>
                            </div>
                        `;
                    }
                    html += '</div>';
                    container.innerHTML = html;
                } else {
                    container.innerHTML = '<div style="text-align: center; padding: 2rem; color: var(--text-secondary);"><i class="fas fa-check-circle" style="font-size: 2rem; color: var(--success);"></i><p style="margin-top: 1rem;">All customers are happy! No urgent actions needed.</p></div>';
                }
            } catch (error) {
                console.error('Error loading next best actions:', error);
                container.innerHTML = '<div style="text-align: center; padding: 2rem; color: var(--text-secondary);"><i class="fas fa-exclamation-circle" style="font-size: 2rem; color: var(--danger);"></i><p style="margin-top: 1rem;">Error loading actions. Deploy the updated Apps Script.</p></div>';
            }
        }

        function renderAttribution(attribution) {
            if (!attribution) return;

            // Find top channel
            let topChannel = 'No data';
            let topValue = 0;
            for (const [channel, value] of Object.entries(attribution)) {
                if (value > topValue) {
                    topValue = value;
                    topChannel = channel.charAt(0).toUpperCase() + channel.slice(1);
                }
            }

            document.getElementById('attrTopChannel').textContent = topChannel;
            document.getElementById('attrPostcard').textContent = attribution.postcard || 0;
            document.getElementById('attrSocial').textContent = attribution.social || 0;
            document.getElementById('attrEmail').textContent = attribution.email || 0;
        }

        async function loadNeighborSignups() {
            const container = document.getElementById('neighborSignupsContainer');
            if (!container) return;

            try {
                const response = await fetch(`${API_URL}?action=getNeighborSignups`);
                const data = await response.json();

                if (data.success && data.signups) {
                    const signups = data.signups;
                    const byNeighborhood = data.byNeighborhood || {};

                    let html = `
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; margin-bottom: 1.5rem;">
                    `;

                    // Neighborhood breakdown cards
                    for (const [neighborhood, count] of Object.entries(byNeighborhood)) {
                        html += `
                            <div style="background: rgba(255,255,255,0.05); padding: 1rem; border-radius: 8px; text-align: center;">
                                <div style="font-size: 1.5rem; font-weight: 700; color: #FFB81C;">${count}</div>
                                <div style="font-size: 0.8rem; color: var(--text-secondary);">${neighborhood}</div>
                            </div>
                        `;
                    }
                    html += '</div>';

                    // Total count
                    html += `<div style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 1rem;"><strong>Total Signups:</strong> ${signups.length}</div>`;

                    // Recent signups table
                    if (signups.length > 0) {
                        html += `
                            <table style="width: 100%; border-collapse: collapse; font-size: 0.85rem;">
                                <thead>
                                    <tr style="border-bottom: 1px solid var(--border);">
                                        <th style="text-align: left; padding: 0.75rem;">Name</th>
                                        <th style="text-align: left; padding: 0.75rem;">Email</th>
                                        <th style="text-align: left; padding: 0.75rem;">Neighborhood</th>
                                        <th style="text-align: left; padding: 0.75rem;">Date</th>
                                    </tr>
                                </thead>
                                <tbody>
                        `;
                        for (const signup of signups.slice(0, 10)) {
                            html += `
                                <tr style="border-bottom: 1px solid var(--border);">
                                    <td style="padding: 0.75rem;">${signup.name || '--'}</td>
                                    <td style="padding: 0.75rem;">${signup.email || '--'}</td>
                                    <td style="padding: 0.75rem;">${signup.neighborhood || '--'}</td>
                                    <td style="padding: 0.75rem;">${signup.timestamp ? new Date(signup.timestamp).toLocaleDateString() : '--'}</td>
                                </tr>
                            `;
                        }
                        html += '</tbody></table>';
                    }

                    container.innerHTML = html;
                } else {
                    container.innerHTML = '<div style="text-align: center; padding: 2rem; color: var(--text-secondary);"><i class="fas fa-inbox" style="font-size: 2rem;"></i><p style="margin-top: 1rem;">No signups yet. Send those postcards!</p></div>';
                }
            } catch (error) {
                console.error('Error loading neighbor signups:', error);
                container.innerHTML = '<div style="text-align: center; padding: 2rem; color: var(--text-secondary);"><i class="fas fa-exclamation-circle" style="font-size: 2rem; color: var(--danger);"></i><p style="margin-top: 1rem;">Error loading signups. Deploy the updated Apps Script.</p></div>';
            }
        }

        async function refreshCustomerIntelligence() {
            showToast('Refreshing intelligence data...', 'info');
            await loadIntelligenceDashboard();
            await loadNextBestActions();
            showToast('Intelligence refreshed!', 'success');
        }

        function configureInstagram(accountName) {
            const token = prompt(`Enter Instagram Graph API Access Token for @${accountName}:`);
            if (!token) return;

            const businessId = prompt(`Enter Instagram Business Account ID for @${accountName}:`);
            if (!businessId) return;

            fetch(API_URL, {
                method: 'POST',
                body: JSON.stringify({
                    action: 'configureInstagramAccount',
                    accountName: accountName,
                    accessToken: token,
                    businessAccountId: businessId
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showToast(`@${accountName} connected successfully!`, 'success');
                    // Update status badge
                    const statusMap = {
                        'tinyseedfarm': 'insta1Status',
                        'tinyseedflowers': 'insta2Status',
                        'tinyseedcsa': 'insta3Status'
                    };
                    const badge = document.getElementById(statusMap[accountName]);
                    if (badge) {
                        badge.textContent = 'Connected';
                        badge.style.background = 'var(--success)';
                    }
                } else {
                    showToast('Error: ' + (data.error || 'Connection failed'), 'error');
                }
            })
            .catch(error => {
                showToast('Error connecting: ' + error.message, 'error');
            });
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // SOCIAL GROWTH ENGINE
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        // Follower goals
        const FOLLOWER_GOALS = {
            igFarm: { current: 0, goal: 10000, handle: '@tinyseedfarm' },
            igFleurs: { current: 0, goal: 10000, handle: '@tinyseedfleurs' },
            igFungi: { current: 0, goal: 5000, handle: '@tinyseedfungi' },
            facebook: { current: 0, goal: 5000, handle: 'Tiny Seed Farm' },
            tiktok: { current: 0, goal: 10000, handle: '@tinyseedfarm' },
            pinterest: { current: 0, goal: 1000, handle: 'Tiny Seed' },
            youtube: { current: 0, goal: 1000, handle: 'Tiny Seed Farm' },
            threads: { current: 0, goal: 5000, handle: '@tinyseedfarm' }
        };

        // Weekly checklist progress stored in localStorage
        function updateWeeklyProgress() {
            const checkboxes = document.querySelectorAll('.content-checklist input[type="checkbox"]');
            const checked = Array.from(checkboxes).filter(cb => cb.checked).length;
            const total = checkboxes.length;
            document.getElementById('weeklyProgress').textContent = `${checked}/${total}`;

            // Save to localStorage
            const state = {};
            checkboxes.forEach(cb => {
                state[cb.id] = cb.checked;
            });
            localStorage.setItem('weeklyChecklist', JSON.stringify(state));
            localStorage.setItem('weeklyChecklistDate', new Date().toISOString().split('T')[0]);
        }

        function loadWeeklyChecklist() {
            const savedDate = localStorage.getItem('weeklyChecklistDate');
            const today = new Date();
            const dayOfWeek = today.getDay();

            // Reset on Sunday (start of new week)
            if (dayOfWeek === 0 && savedDate !== today.toISOString().split('T')[0]) {
                localStorage.removeItem('weeklyChecklist');
                localStorage.setItem('weeklyChecklistDate', today.toISOString().split('T')[0]);
            }

            const saved = localStorage.getItem('weeklyChecklist');
            if (saved) {
                const state = JSON.parse(saved);
                Object.keys(state).forEach(id => {
                    const checkbox = document.getElementById(id);
                    if (checkbox) checkbox.checked = state[id];
                });
            }
            updateWeeklyProgress();
        }

        async function loadSocialGrowthData() {
            // Try to load from API if connected
            try {
                const response = await fetch(`${API_URL}?action=getSocialStats`);
                const data = await response.json();

                if (data.success && data.stats) {
                    // Update Instagram accounts
                    if (data.stats.instagram) {
                        Object.keys(data.stats.instagram).forEach(handle => {
                            const followers = data.stats.instagram[handle].followers || 0;
                            if (handle.includes('farm')) {
                                FOLLOWER_GOALS.igFarm.current = followers;
                            } else if (handle.includes('fleur')) {
                                FOLLOWER_GOALS.igFleurs.current = followers;
                            } else if (handle.includes('fungi')) {
                                FOLLOWER_GOALS.igFungi.current = followers;
                            }
                        });
                    }
                    updateGrowthDisplays();
                }
            } catch (error) {
                console.log('Social stats not yet connected:', error.message);
                // Show manual entry UI
                showManualEntryPrompt();
            }
        }

        function showManualEntryPrompt() {
            // Load from localStorage if available
            const saved = localStorage.getItem('socialGrowthData');
            if (saved) {
                const data = JSON.parse(saved);
                Object.keys(data).forEach(key => {
                    if (FOLLOWER_GOALS[key]) {
                        FOLLOWER_GOALS[key].current = data[key];
                    }
                });
                updateGrowthDisplays();
            }
        }

        function updateGrowthDisplays() {
            // Update Instagram @tinyseedfarm
            const igFarm = FOLLOWER_GOALS.igFarm;
            document.getElementById('igFarmFollowers').textContent = igFarm.current.toLocaleString();
            document.getElementById('igFarmProgress').style.width = `${(igFarm.current / igFarm.goal) * 100}%`;

            // Update Instagram @tinyseedfleurs
            const igFleurs = FOLLOWER_GOALS.igFleurs;
            document.getElementById('igFleursFollowers').textContent = igFleurs.current.toLocaleString();
            document.getElementById('igFleursProgress').style.width = `${(igFleurs.current / igFleurs.goal) * 100}%`;

            // Update Instagram @tinyseedfungi
            const igFungi = FOLLOWER_GOALS.igFungi;
            document.getElementById('igFungiFollowers').textContent = igFungi.current.toLocaleString();
            document.getElementById('igFungiProgress').style.width = `${(igFungi.current / igFungi.goal) * 100}%`;

            // Update other platforms
            document.getElementById('fbFollowers').textContent = FOLLOWER_GOALS.facebook.current.toLocaleString() || '--';
            document.getElementById('tiktokFollowers').textContent = FOLLOWER_GOALS.tiktok.current.toLocaleString() || '--';
            document.getElementById('pinterestFollowers').textContent = FOLLOWER_GOALS.pinterest.current.toLocaleString() || '--';
            document.getElementById('youtubeSubscribers').textContent = FOLLOWER_GOALS.youtube.current.toLocaleString() || '--';
            document.getElementById('threadsFollowers').textContent = FOLLOWER_GOALS.threads.current.toLocaleString() || '--';
        }

        function openPostComposer() {
            showToast('Post composer coming soon! Use Buffer or Publer for now.', 'info');
            // Future: Open a modal to compose cross-platform posts
        }

        function schedulePost(time) {
            showToast(`Scheduling post for ${time}. Use Buffer or Publer for now.`, 'info');
        }

        function refreshGrowthData() {
            showToast('Refreshing growth data...', 'info');
            loadSocialGrowthData();
            initGrowthChart();
        }

        let growthChart = null;

        function initGrowthChart() {
            const ctx = document.getElementById('growthProjectionChart');
            if (!ctx) return;

            if (growthChart) {
                growthChart.destroy();
            }

            // Calculate projection data
            const months = ['Now', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];

            // Assuming 5% monthly growth (good benchmark)
            const growthRate = 0.05;

            const igFarmData = [FOLLOWER_GOALS.igFarm.current || 500];
            const igFleursData = [FOLLOWER_GOALS.igFleurs.current || 300];
            const igFungiData = [FOLLOWER_GOALS.igFungi.current || 100];

            for (let i = 1; i < 12; i++) {
                igFarmData.push(Math.round(igFarmData[i-1] * (1 + growthRate)));
                igFleursData.push(Math.round(igFleursData[i-1] * (1 + growthRate)));
                igFungiData.push(Math.round(igFungiData[i-1] * (1 + growthRate)));
            }

            growthChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: months,
                    datasets: [
                        {
                            label: '@tinyseedfarm (Goal: 10K)',
                            data: igFarmData,
                            borderColor: '#E1306C',
                            backgroundColor: 'rgba(225, 48, 108, 0.1)',
                            fill: true,
                            tension: 0.4
                        },
                        {
                            label: '@tinyseedfleurs (Goal: 10K)',
                            data: igFleursData,
                            borderColor: '#F77737',
                            backgroundColor: 'rgba(247, 119, 55, 0.1)',
                            fill: true,
                            tension: 0.4
                        },
                        {
                            label: '@tinyseedfungi (Goal: 5K)',
                            data: igFungiData,
                            borderColor: '#833AB4',
                            backgroundColor: 'rgba(131, 58, 180, 0.1)',
                            fill: true,
                            tension: 0.4
                        },
                        {
                            label: '10K Goal Line',
                            data: Array(12).fill(10000),
                            borderColor: 'rgba(255, 215, 0, 0.5)',
                            borderDash: [5, 5],
                            pointRadius: 0,
                            fill: false
                        },
                        {
                            label: '5K Goal Line',
                            data: Array(12).fill(5000),
                            borderColor: 'rgba(255, 215, 0, 0.3)',
                            borderDash: [5, 5],
                            pointRadius: 0,
                            fill: false
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: { color: '#8d99ae' }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.raw.toLocaleString();
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 12000,
                            grid: { color: 'rgba(255,255,255,0.1)' },
                            ticks: { color: '#8d99ae' }
                        },
                        x: {
                            grid: { color: 'rgba(255,255,255,0.05)' },
                            ticks: { color: '#8d99ae' }
                        }
                    }
                }
            });
        }

        function updateFollowerCount(platform, count) {
            if (FOLLOWER_GOALS[platform]) {
                FOLLOWER_GOALS[platform].current = parseInt(count) || 0;

                // Save to localStorage
                const data = {};
                Object.keys(FOLLOWER_GOALS).forEach(key => {
                    data[key] = FOLLOWER_GOALS[key].current;
                });
                localStorage.setItem('socialGrowthData', JSON.stringify(data));

                updateGrowthDisplays();
                initGrowthChart();
                showToast('Follower count updated!', 'success');
            }
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // INITIALIZATION
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        document.addEventListener('DOMContentLoaded', async function() {
            // Show loading state
            console.log('Loading Marketing Command Center data...');

            // Load all data from API
            await Promise.all([
                loadFarmPics(),
                loadCampaigns(),
                loadSocialConnections(),
                loadDashboardStats(),
                loadIntelligenceDashboard(),
                loadNextBestActions(),
                loadNeighborSignups()
            ]);

            // Initialize UI components
            renderScheduleCalendar();
            initCharts();
            checkForDraft();

            // Initialize Social Growth Engine
            loadWeeklyChecklist();
            loadSocialGrowthData();
            initGrowthChart();

            console.log('Marketing Command Center loaded with Intelligence & Social Growth!');
        });
    </script>
</body>
</html>
