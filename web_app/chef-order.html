<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#1a1a2e">
    <title>Tiny Seed Farm | Chef Orders</title>
    <link rel="manifest" href="chef-manifest.json">
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="api-config.js"></script>
    <style>
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           TINY SEED FARM - CHEF ORDERING APP
           State-of-the-art mobile-first B2B ordering experience
           Based on research: Barn2Door, Local Line, Sysco MOXe, US Foods
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

        :root {
            --primary: #22c55e;
            --primary-dark: #16a34a;
            --secondary: #1a1a2e;
            --accent: #f59e0b;
            --danger: #ef4444;
            --bg-main: #fafaf9;
            --bg-card: #ffffff;
            --bg-dark: #1a1a2e;
            --text-primary: #1c1917;
            --text-secondary: #57534e;
            --text-light: #a8a29e;
            --border: #e7e5e4;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-main);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           LOGIN SCREEN
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

        .login-screen {
            min-height: 100vh;
            background: linear-gradient(180deg, var(--secondary) 0%, #0f172a 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 24px;
        }

        .login-logo {
            width: 80px;
            height: 80px;
            background: var(--primary);
            border-radius: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            margin-bottom: 24px;
            box-shadow: 0 0 60px rgba(34, 197, 94, 0.3);
        }

        .login-title {
            color: white;
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .login-subtitle {
            color: rgba(255,255,255,0.6);
            margin-bottom: 40px;
        }

        .login-card {
            background: white;
            border-radius: 20px;
            padding: 32px 24px;
            width: 100%;
            max-width: 380px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        .form-input {
            width: 100%;
            padding: 16px;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 16px;
            font-family: inherit;
            transition: all 0.2s;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .btn {
            width: 100%;
            padding: 16px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            font-family: inherit;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:active {
            transform: scale(0.98);
            background: var(--primary-dark);
        }

        .magic-sent {
            text-align: center;
            padding: 20px;
        }

        .magic-sent .icon {
            font-size: 64px;
            margin-bottom: 16px;
        }

        .magic-sent h3 {
            font-size: 20px;
            margin-bottom: 8px;
        }

        .magic-sent p {
            color: var(--text-secondary);
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           MAIN APP
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

        .app-container {
            display: none;
            min-height: 100vh;
            padding-bottom: 80px;
        }

        /* Header */
        .header {
            background: var(--secondary);
            color: white;
            padding: 16px 20px;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .header-logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .header-logo-icon {
            width: 36px;
            height: 36px;
            background: var(--primary);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }

        .header-logo-text {
            font-weight: 700;
            font-size: 18px;
        }

        .header-actions {
            display: flex;
            gap: 12px;
        }

        .header-btn {
            width: 40px;
            height: 40px;
            background: rgba(255,255,255,0.1);
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 18px;
            cursor: pointer;
            position: relative;
        }

        .cart-badge {
            position: absolute;
            top: -4px;
            right: -4px;
            background: var(--danger);
            color: white;
            font-size: 11px;
            font-weight: 700;
            min-width: 18px;
            height: 18px;
            border-radius: 9px;
            display: none;
            align-items: center;
            justify-content: center;
        }

        /* Search */
        .search-bar {
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 12px 16px 12px 44px;
            background: rgba(255,255,255,0.1);
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 15px;
            font-family: inherit;
        }

        .search-input::placeholder {
            color: rgba(255,255,255,0.5);
        }

        .search-input:focus {
            outline: none;
            background: rgba(255,255,255,0.15);
        }

        .search-icon {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            opacity: 0.5;
        }

        /* Tabs */
        .tabs {
            display: flex;
            background: var(--bg-card);
            border-bottom: 1px solid var(--border);
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .tab {
            flex: 1;
            min-width: max-content;
            padding: 14px 20px;
            background: none;
            border: none;
            font-size: 14px;
            font-weight: 600;
            font-family: inherit;
            color: var(--text-secondary);
            cursor: pointer;
            border-bottom: 3px solid transparent;
            white-space: nowrap;
        }

        .tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        /* Content */
        .tab-content {
            display: none;
            padding: 16px;
        }

        .tab-content.active {
            display: block;
        }

        /* Fresh This Week Hero */
        .hero {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            border-radius: 16px;
            padding: 24px;
            color: white;
            margin-bottom: 20px;
        }

        .hero-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .hero-subtitle {
            opacity: 0.9;
            font-size: 15px;
        }

        .hero-stats {
            display: flex;
            gap: 20px;
            margin-top: 16px;
        }

        .hero-stat {
            text-align: center;
        }

        .hero-stat-value {
            font-size: 28px;
            font-weight: 700;
        }

        .hero-stat-label {
            font-size: 12px;
            opacity: 0.8;
        }

        /* Filter Pills */
        .filter-pills {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            padding-bottom: 12px;
            margin-bottom: 16px;
            -webkit-overflow-scrolling: touch;
        }

        .filter-pill {
            padding: 10px 18px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 100px;
            font-size: 14px;
            font-weight: 500;
            font-family: inherit;
            white-space: nowrap;
            cursor: pointer;
            transition: all 0.2s;
        }

        .filter-pill.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        /* Product Grid */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }

        @media (min-width: 600px) {
            .products-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        /* Product Card */
        .product-card {
            background: var(--bg-card);
            border-radius: 16px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: transform 0.2s;
        }

        .product-card:active {
            transform: scale(0.98);
        }

        .product-image {
            height: 100px;
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            position: relative;
        }

        .freshness-badge {
            position: absolute;
            top: 8px;
            left: 8px;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 10px;
            font-weight: 700;
            text-transform: uppercase;
        }

        .freshness-badge.today {
            background: var(--primary);
            color: white;
        }

        .freshness-badge.yesterday {
            background: #a3e635;
            color: #365314;
        }

        .freshness-badge.peak {
            background: var(--accent);
            color: white;
        }

        .freshness-badge.limited {
            background: var(--danger);
            color: white;
        }

        .freshness-badge.coming {
            background: #8b5cf6;
            color: white;
        }

        .product-info {
            padding: 12px;
        }

        .product-name {
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 2px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .product-variety {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .product-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .product-price {
            font-size: 16px;
            font-weight: 700;
            color: var(--primary-dark);
        }

        .product-unit {
            font-size: 11px;
            color: var(--text-light);
        }

        .product-stock {
            font-size: 11px;
            color: var(--text-secondary);
        }

        .add-btn {
            width: 32px;
            height: 32px;
            background: var(--primary);
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 18px;
            cursor: pointer;
        }

        /* Coming Soon */
        .coming-soon-section {
            margin-top: 24px;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .section-title {
            font-size: 18px;
            font-weight: 700;
        }

        .see-all {
            color: var(--primary);
            font-weight: 600;
            font-size: 14px;
            text-decoration: none;
        }

        .coming-card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 16px;
            display: flex;
            gap: 12px;
            margin-bottom: 12px;
            box-shadow: var(--shadow);
        }

        .coming-emoji {
            font-size: 36px;
        }

        .coming-info {
            flex: 1;
        }

        .coming-name {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .coming-date {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .notify-btn {
            padding: 8px 14px;
            background: #f3e8ff;
            color: #7c3aed;
            border: none;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 600;
            font-family: inherit;
            cursor: pointer;
            align-self: center;
        }

        /* Quick Reorder Tab */
        .reorder-section {
            margin-bottom: 24px;
        }

        .last-order-card {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 20px;
            box-shadow: var(--shadow);
        }

        .last-order-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .last-order-date {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .last-order-items {
            margin-bottom: 16px;
        }

        .last-order-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid var(--border);
        }

        .last-order-item:last-child {
            border-bottom: none;
        }

        .reorder-btn {
            width: 100%;
            padding: 14px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            font-family: inherit;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .favorites-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
        }

        .favorite-item {
            text-align: center;
            cursor: pointer;
        }

        .favorite-emoji {
            font-size: 32px;
            margin-bottom: 4px;
        }

        .favorite-name {
            font-size: 11px;
            color: var(--text-secondary);
        }

        /* Cart Drawer */
        .cart-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.5);
            z-index: 200;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
        }

        .cart-overlay.open {
            opacity: 1;
            visibility: visible;
        }

        .cart-drawer {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--bg-card);
            border-radius: 24px 24px 0 0;
            z-index: 201;
            transform: translateY(100%);
            transition: transform 0.3s ease-out;
            max-height: 85vh;
            display: flex;
            flex-direction: column;
        }

        .cart-drawer.open {
            transform: translateY(0);
        }

        .cart-handle {
            width: 40px;
            height: 4px;
            background: var(--border);
            border-radius: 2px;
            margin: 12px auto;
        }

        .cart-header {
            padding: 0 20px 16px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .cart-title {
            font-size: 18px;
            font-weight: 700;
        }

        .cart-clear {
            color: var(--danger);
            background: none;
            border: none;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
        }

        .cart-items {
            flex: 1;
            overflow-y: auto;
            padding: 16px 20px;
        }

        .cart-item {
            display: flex;
            gap: 12px;
            padding: 12px 0;
            border-bottom: 1px solid var(--border);
        }

        .cart-item-emoji {
            font-size: 32px;
        }

        .cart-item-info {
            flex: 1;
        }

        .cart-item-name {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .cart-item-price {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .cart-item-qty {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .qty-btn {
            width: 32px;
            height: 32px;
            border: 1px solid var(--border);
            background: var(--bg-main);
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
        }

        .qty-value {
            font-weight: 600;
            min-width: 24px;
            text-align: center;
        }

        .cart-footer {
            padding: 16px 20px;
            border-top: 1px solid var(--border);
            background: var(--bg-main);
        }

        .cart-total {
            display: flex;
            justify-content: space-between;
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 16px;
        }

        .cart-delivery {
            margin-bottom: 16px;
        }

        .cart-delivery-label {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .delivery-options {
            display: flex;
            gap: 8px;
        }

        .delivery-option {
            flex: 1;
            padding: 12px;
            background: var(--bg-card);
            border: 2px solid var(--border);
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .delivery-option.selected {
            border-color: var(--primary);
            background: #f0fdf4;
        }

        .delivery-option-day {
            font-weight: 600;
            font-size: 14px;
        }

        .delivery-option-date {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .checkout-btn {
            width: 100%;
            padding: 16px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            font-family: inherit;
            cursor: pointer;
        }

        .checkout-btn:disabled {
            background: var(--text-light);
        }

        /* Bottom Nav */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--bg-card);
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: space-around;
            padding: 8px 0;
            padding-bottom: max(8px, env(safe-area-inset-bottom));
            z-index: 100;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 8px 16px;
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-family: inherit;
        }

        .nav-item.active {
            color: var(--primary);
        }

        .nav-icon {
            font-size: 22px;
        }

        .nav-label {
            font-size: 11px;
            font-weight: 600;
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: var(--secondary);
            color: white;
            padding: 14px 24px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 500;
            z-index: 300;
            opacity: 0;
            transition: all 0.3s;
        }

        .toast.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }

        .toast.success {
            background: var(--primary);
        }

        /* Standing Orders */
        .standing-order-card {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 16px;
            margin-bottom: 12px;
            box-shadow: var(--shadow);
        }

        .standing-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
        }

        .standing-frequency {
            font-size: 12px;
            padding: 4px 10px;
            background: #dbeafe;
            color: #1e40af;
            border-radius: 100px;
            font-weight: 600;
        }

        .standing-items {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 12px;
        }

        .standing-actions {
            display: flex;
            gap: 8px;
        }

        .standing-btn {
            flex: 1;
            padding: 10px;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 600;
            font-family: inherit;
            cursor: pointer;
        }

        .standing-btn.edit {
            background: var(--bg-main);
            border: 1px solid var(--border);
            color: var(--text-primary);
        }

        .standing-btn.pause {
            background: #fef3c7;
            border: none;
            color: #92400e;
        }

        /* Account Tab */
        .account-section {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 16px;
            box-shadow: var(--shadow);
        }

        .account-section-title {
            font-size: 12px;
            font-weight: 700;
            color: var(--text-light);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 12px;
        }

        .account-row {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid var(--border);
        }

        .account-row:last-child {
            border-bottom: none;
        }

        .account-label {
            color: var(--text-secondary);
        }

        .account-value {
            font-weight: 600;
        }

        .prefs-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }

        .pref-toggle {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: var(--bg-main);
            border-radius: 10px;
        }

        .toggle-switch {
            width: 48px;
            height: 28px;
            background: var(--border);
            border-radius: 14px;
            position: relative;
            cursor: pointer;
            transition: background 0.2s;
        }

        .toggle-switch.on {
            background: var(--primary);
        }

        .toggle-switch::after {
            content: '';
            position: absolute;
            width: 22px;
            height: 22px;
            background: white;
            border-radius: 50%;
            top: 3px;
            left: 3px;
            transition: left 0.2s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .toggle-switch.on::after {
            left: 23px;
        }

        .logout-btn {
            width: 100%;
            padding: 14px;
            background: none;
            border: 2px solid var(--danger);
            color: var(--danger);
            border-radius: 12px;
            font-size: 15px;
            font-weight: 600;
            font-family: inherit;
            cursor: pointer;
            margin-top: 20px;
        }

        /* Loading */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 60px;
        }

        .spinner {
            width: 32px;
            height: 32px;
            border: 3px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
        }

        .empty-icon {
            font-size: 48px;
            margin-bottom: 12px;
        }

        .empty-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .empty-text {
            color: var(--text-secondary);
            font-size: 14px;
        }

        /* PWA Install Banner */
        .install-banner {
            position: fixed;
            bottom: 80px;
            left: 16px;
            right: 16px;
            background: var(--secondary);
            color: white;
            padding: 16px;
            border-radius: 16px;
            display: none;
            align-items: center;
            gap: 12px;
            z-index: 99;
            box-shadow: var(--shadow-lg);
        }

        .install-banner.show {
            display: flex;
        }

        .install-icon {
            font-size: 32px;
        }

        .install-text {
            flex: 1;
        }

        .install-text h4 {
            font-size: 14px;
            margin-bottom: 2px;
        }

        .install-text p {
            font-size: 12px;
            opacity: 0.7;
        }

        .install-btn {
            padding: 10px 16px;
            background: var(--primary);
            border: none;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            font-size: 13px;
            cursor: pointer;
        }

        .install-close {
            background: none;
            border: none;
            color: white;
            opacity: 0.5;
            font-size: 20px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div class="login-screen" id="loginScreen">
        <div class="login-logo">ğŸŒ±</div>
        <h1 class="login-title">Tiny Seed Farm</h1>
        <p class="login-subtitle">Chef Ordering Portal</p>

        <div class="login-card">
            <div id="loginForm">
                <div class="form-group">
                    <label class="form-label">Business Email</label>
                    <input type="email" class="form-input" id="loginEmail" placeholder="chef@restaurant.com">
                </div>
                <button class="btn btn-primary" onclick="sendMagicLink()">Get Login Link</button>
            </div>

            <div class="magic-sent" id="magicSent" style="display: none;">
                <div class="icon">ğŸ“§</div>
                <h3>Check Your Email!</h3>
                <p>We sent a login link to<br><strong id="sentEmail"></strong></p>
                <button class="btn btn-primary" onclick="resetLogin()" style="margin-top: 20px;">Try Different Email</button>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div class="app-container" id="appContainer">
        <!-- Header -->
        <header class="header">
            <div class="header-top">
                <div class="header-logo">
                    <div class="header-logo-icon">ğŸŒ±</div>
                    <span class="header-logo-text">Tiny Seed</span>
                </div>
                <div class="header-actions">
                    <button class="header-btn" onclick="toggleCart()">
                        ğŸ›’
                        <span class="cart-badge" id="cartBadge">0</span>
                    </button>
                    <button class="header-btn" onclick="switchTab('account')">ğŸ‘¤</button>
                </div>
            </div>
            <div class="search-bar">
                <span class="search-icon">ğŸ”</span>
                <input type="text" class="search-input" placeholder="Search fresh produce..." id="searchInput" oninput="filterProducts()">
            </div>
        </header>

        <!-- Tabs -->
        <div class="tabs">
            <button class="tab active" data-tab="fresh">Fresh Now</button>
            <button class="tab" data-tab="coming">Coming Soon</button>
            <button class="tab" data-tab="reorder">Quick Reorder</button>
            <button class="tab" data-tab="standing">Standing Orders</button>
            <button class="tab" data-tab="account">Account</button>
        </div>

        <!-- Fresh Now Tab -->
        <div class="tab-content active" id="tab-fresh">
            <div class="hero">
                <h2 class="hero-title">Fresh This Week</h2>
                <p class="hero-subtitle">Harvested from our fields in Rochester, PA</p>
                <div class="hero-stats">
                    <div class="hero-stat">
                        <div class="hero-stat-value" id="availableCount">--</div>
                        <div class="hero-stat-label">Items Available</div>
                    </div>
                    <div class="hero-stat">
                        <div class="hero-stat-value" id="harvestedToday">--</div>
                        <div class="hero-stat-label">Harvested Today</div>
                    </div>
                </div>
            </div>

            <div class="filter-pills">
                <button class="filter-pill active" data-category="all">All</button>
                <button class="filter-pill" data-category="Greens">ğŸ¥¬ Greens</button>
                <button class="filter-pill" data-category="Roots">ğŸ¥• Roots</button>
                <button class="filter-pill" data-category="Fruits">ğŸ… Fruits</button>
                <button class="filter-pill" data-category="Herbs">ğŸŒ¿ Herbs</button>
                <button class="filter-pill" data-category="Flowers">ğŸŒ¸ Flowers</button>
            </div>

            <div class="products-grid" id="productsGrid">
                <div class="loading"><div class="spinner"></div></div>
            </div>
        </div>

        <!-- Coming Soon Tab -->
        <div class="tab-content" id="tab-coming">
            <div class="section-header">
                <h2 class="section-title">Coming Soon</h2>
            </div>
            <p style="color: var(--text-secondary); margin-bottom: 20px;">Products expected to be ready in the next 2-4 weeks based on our field plan.</p>
            <div id="comingSoonList">
                <div class="loading"><div class="spinner"></div></div>
            </div>
        </div>

        <!-- Quick Reorder Tab -->
        <div class="tab-content" id="tab-reorder">
            <div class="reorder-section">
                <div class="section-header">
                    <h2 class="section-title">Last Order</h2>
                </div>
                <div class="last-order-card" id="lastOrderCard">
                    <div class="loading"><div class="spinner"></div></div>
                </div>
            </div>

            <div class="reorder-section">
                <div class="section-header">
                    <h2 class="section-title">Your Favorites</h2>
                </div>
                <div class="favorites-grid" id="favoritesGrid">
                    <!-- Populated dynamically -->
                </div>
            </div>
        </div>

        <!-- Standing Orders Tab -->
        <div class="tab-content" id="tab-standing">
            <div class="section-header">
                <h2 class="section-title">Standing Orders</h2>
                <button class="see-all" onclick="showCreateStandingOrder()">+ New</button>
            </div>
            <p style="color: var(--text-secondary); margin-bottom: 20px;">Set up recurring orders that automatically repeat each week.</p>
            <div id="standingOrdersList">
                <div class="empty-state">
                    <div class="empty-icon">ğŸ“¦</div>
                    <h3 class="empty-title">No Standing Orders</h3>
                    <p class="empty-text">Create a standing order to get your favorites automatically each week.</p>
                </div>
            </div>
        </div>

        <!-- Account Tab -->
        <div class="tab-content" id="tab-account">
            <div class="account-section">
                <div class="account-section-title">Business Info</div>
                <div class="account-row">
                    <span class="account-label">Restaurant</span>
                    <span class="account-value" id="accountCompany">--</span>
                </div>
                <div class="account-row">
                    <span class="account-label">Contact</span>
                    <span class="account-value" id="accountName">--</span>
                </div>
                <div class="account-row">
                    <span class="account-label">Email</span>
                    <span class="account-value" id="accountEmail">--</span>
                </div>
                <div class="account-row">
                    <span class="account-label">Phone</span>
                    <span class="account-value" id="accountPhone">--</span>
                </div>
            </div>

            <div class="account-section">
                <div class="account-section-title">Notifications</div>
                <div class="pref-toggle">
                    <span>SMS Alerts</span>
                    <div class="toggle-switch on" id="toggleSMS" onclick="togglePref('sms')"></div>
                </div>
                <div class="pref-toggle" style="margin-top: 12px;">
                    <span>Email Updates</span>
                    <div class="toggle-switch on" id="toggleEmail" onclick="togglePref('email')"></div>
                </div>
            </div>

            <div class="account-section">
                <div class="account-section-title">Delivery</div>
                <div class="account-row">
                    <span class="account-label">Address</span>
                    <span class="account-value" id="accountAddress">--</span>
                </div>
                <div class="account-row">
                    <span class="account-label">Preferred Day</span>
                    <span class="account-value" id="accountDeliveryDay">Tuesday</span>
                </div>
            </div>

            <button class="logout-btn" onclick="logout()">Sign Out</button>
        </div>

        <!-- Bottom Nav -->
        <nav class="bottom-nav">
            <button class="nav-item active" data-tab="fresh">
                <span class="nav-icon">ğŸ¥¬</span>
                <span class="nav-label">Fresh</span>
            </button>
            <button class="nav-item" data-tab="coming">
                <span class="nav-icon">ğŸ“…</span>
                <span class="nav-label">Coming</span>
            </button>
            <button class="nav-item" data-tab="reorder">
                <span class="nav-icon">ğŸ”„</span>
                <span class="nav-label">Reorder</span>
            </button>
            <button class="nav-item" data-tab="standing">
                <span class="nav-icon">ğŸ“¦</span>
                <span class="nav-label">Standing</span>
            </button>
            <button class="nav-item" data-tab="account">
                <span class="nav-icon">ğŸ‘¤</span>
                <span class="nav-label">Account</span>
            </button>
        </nav>
    </div>

    <!-- Cart Drawer -->
    <div class="cart-overlay" id="cartOverlay" onclick="toggleCart()"></div>
    <div class="cart-drawer" id="cartDrawer">
        <div class="cart-handle"></div>
        <div class="cart-header">
            <h3 class="cart-title">Your Order</h3>
            <button class="cart-clear" onclick="clearCart()">Clear</button>
        </div>
        <div class="cart-items" id="cartItems">
            <div class="empty-state">
                <div class="empty-icon">ğŸ›’</div>
                <p class="empty-text">Your cart is empty</p>
            </div>
        </div>
        <div class="cart-footer" id="cartFooter" style="display: none;">
            <div class="cart-delivery">
                <div class="cart-delivery-label">Delivery Date</div>
                <div class="delivery-options" id="deliveryOptions">
                    <!-- Populated dynamically -->
                </div>
            </div>
            <div class="cart-total">
                <span>Total</span>
                <span id="cartTotal">$0.00</span>
            </div>
            <button class="checkout-btn" onclick="submitOrder()">Submit Order</button>
        </div>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast"></div>

    <!-- Install Banner -->
    <div class="install-banner" id="installBanner">
        <span class="install-icon">ğŸ“²</span>
        <div class="install-text">
            <h4>Add to Home Screen</h4>
            <p>Order fresh produce faster</p>
        </div>
        <button class="install-btn" onclick="installApp()">Install</button>
        <button class="install-close" onclick="hideInstallBanner()">Ã—</button>
    </div>

    <script>
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // STATE
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        const State = {
            customer: null,
            products: [],
            comingSoon: [],
            cart: [],
            lastOrder: null,
            favorites: [],
            standingOrders: [],
            currentCategory: 'all',
            deliveryDate: null
        };

        const api = new TinySeedAPI();

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // INITIALIZATION
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        document.addEventListener('DOMContentLoaded', () => {
            checkAuth();
            setupEventListeners();
            loadCart();
            checkInstallPrompt();
        });

        function checkAuth() {
            const params = TinySeedUtils.getUrlParams();

            // Check for magic link token
            if (params.token && params.email) {
                verifyMagicLink(params.token, params.email);
                return;
            }

            // Check saved session
            const session = localStorage.getItem('tsf_chef_session');
            if (session) {
                try {
                    State.customer = JSON.parse(session);
                    showApp();
                } catch (e) {
                    showLogin();
                }
            } else {
                showLogin();
            }
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // AUTH
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        async function sendMagicLink() {
            const email = document.getElementById('loginEmail').value.trim();
            if (!email) {
                showToast('Please enter your email', 'error');
                return;
            }

            try {
                const result = await api.get('sendChefMagicLink', { email });
                if (result.success) {
                    document.getElementById('loginForm').style.display = 'none';
                    document.getElementById('magicSent').style.display = 'block';
                    document.getElementById('sentEmail').textContent = email;
                } else {
                    showToast(result.error || 'Email not found. Contact us to get set up.', 'error');
                }
            } catch (e) {
                showToast('Connection error. Please try again.', 'error');
            }
        }

        async function verifyMagicLink(token, email) {
            try {
                const result = await api.get('verifyChefToken', { token, email });
                if (result.success) {
                    State.customer = result.customer;
                    localStorage.setItem('tsf_chef_session', JSON.stringify(result.customer));
                    window.history.replaceState({}, '', window.location.pathname);
                    showApp();
                } else {
                    showToast('Link expired. Please request a new one.', 'error');
                    showLogin();
                }
            } catch (e) {
                showToast('Error verifying link', 'error');
                showLogin();
            }
        }

        function resetLogin() {
            document.getElementById('loginForm').style.display = 'block';
            document.getElementById('magicSent').style.display = 'none';
            document.getElementById('loginEmail').value = '';
        }

        function logout() {
            State.customer = null;
            localStorage.removeItem('tsf_chef_session');
            showLogin();
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // UI
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        function showLogin() {
            document.getElementById('loginScreen').style.display = 'flex';
            document.getElementById('appContainer').style.display = 'none';
        }

        function showApp() {
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('appContainer').style.display = 'block';

            updateAccountUI();
            loadProducts();
            loadComingSoon();
            loadLastOrder();
            loadStandingOrders();
            generateDeliveryDates();
        }

        function switchTab(tabId) {
            // Update tabs
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));

            document.querySelector(`.tab[data-tab="${tabId}"]`)?.classList.add('active');
            document.getElementById(`tab-${tabId}`)?.classList.add('active');
            document.querySelector(`.nav-item[data-tab="${tabId}"]`)?.classList.add('active');
        }

        function updateAccountUI() {
            if (!State.customer) return;

            document.getElementById('accountCompany').textContent = State.customer.Company_Name || '--';
            document.getElementById('accountName').textContent = State.customer.Contact_Name || '--';
            document.getElementById('accountEmail').textContent = State.customer.Email || '--';
            document.getElementById('accountPhone').textContent = State.customer.Phone || '--';
            document.getElementById('accountAddress').textContent =
                [State.customer.Address, State.customer.City].filter(Boolean).join(', ') || '--';
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // PRODUCTS
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        async function loadProducts() {
            try {
                const result = await api.get('getRealtimeAvailability');
                if (result.success && result.data) {
                    State.products = result.data;
                    renderProducts();
                    updateHeroStats();
                } else {
                    // Demo data
                    State.products = getDemoProducts();
                    renderProducts();
                    updateHeroStats();
                }
            } catch (e) {
                State.products = getDemoProducts();
                renderProducts();
                updateHeroStats();
            }
        }

        function getDemoProducts() {
            return [
                { id: 'P001', name: 'Mixed Salad Greens', variety: 'Spring Mix', category: 'Greens', price: 8.50, unit: 'lb', available: 45, emoji: 'ğŸ¥¬', freshness: 'today' },
                { id: 'P002', name: 'Cherry Tomatoes', variety: 'Sun Gold', category: 'Fruits', price: 5.00, unit: 'pint', available: 30, emoji: 'ğŸ…', freshness: 'today' },
                { id: 'P003', name: 'Fresh Basil', variety: 'Genovese', category: 'Herbs', price: 3.00, unit: 'bunch', available: 25, emoji: 'ğŸŒ¿', freshness: 'yesterday' },
                { id: 'P004', name: 'Rainbow Carrots', variety: 'Mixed', category: 'Roots', price: 4.50, unit: 'bunch', available: 40, emoji: 'ğŸ¥•', freshness: 'peak' },
                { id: 'P005', name: 'Lacinato Kale', variety: 'Dinosaur', category: 'Greens', price: 3.50, unit: 'bunch', available: 35, emoji: 'ğŸ¥¬', freshness: 'yesterday' },
                { id: 'P006', name: 'Sunflowers', variety: 'ProCut Orange', category: 'Flowers', price: 12.00, unit: 'bunch', available: 8, emoji: 'ğŸŒ»', freshness: 'limited' },
                { id: 'P007', name: 'Sugar Snap Peas', variety: 'Super Sugar Snap', category: 'Fruits', price: 9.00, unit: 'lb', available: 20, emoji: 'ğŸ«›', freshness: 'peak' },
                { id: 'P008', name: 'Fresh Cilantro', variety: 'Santo', category: 'Herbs', price: 2.50, unit: 'bunch', available: 30, emoji: 'ğŸŒ¿', freshness: 'today' }
            ];
        }

        function renderProducts() {
            const grid = document.getElementById('productsGrid');
            const search = document.getElementById('searchInput').value.toLowerCase();

            let filtered = State.products.filter(p => {
                if (State.currentCategory !== 'all' && p.category !== State.currentCategory) return false;
                if (search && !p.name.toLowerCase().includes(search) && !(p.variety || '').toLowerCase().includes(search)) return false;
                return true;
            });

            if (filtered.length === 0) {
                grid.innerHTML = `
                    <div class="empty-state" style="grid-column: 1/-1;">
                        <div class="empty-icon">ğŸ”</div>
                        <p class="empty-text">No products found</p>
                    </div>
                `;
                return;
            }

            grid.innerHTML = filtered.map(p => `
                <div class="product-card" onclick="showProductDetail('${p.id}')">
                    <div class="product-image">
                        ${p.emoji || 'ğŸ¥¬'}
                        ${getFreshnessBadge(p.freshness, p.available)}
                    </div>
                    <div class="product-info">
                        <div class="product-name">${p.name}</div>
                        <div class="product-variety">${p.variety || ''}</div>
                        <div class="product-row">
                            <div>
                                <div class="product-price">$${p.price.toFixed(2)}</div>
                                <div class="product-unit">per ${p.unit}</div>
                            </div>
                            <button class="add-btn" onclick="event.stopPropagation(); quickAdd('${p.id}')">+</button>
                        </div>
                        <div class="product-stock">${p.available} ${p.unit}s available</div>
                    </div>
                </div>
            `).join('');
        }

        function getFreshnessBadge(freshness, available) {
            if (available < 10) return '<span class="freshness-badge limited">Limited</span>';

            switch (freshness) {
                case 'today': return '<span class="freshness-badge today">Harvested Today</span>';
                case 'yesterday': return '<span class="freshness-badge yesterday">Picked Yesterday</span>';
                case 'peak': return '<span class="freshness-badge peak">Peak Season</span>';
                default: return '';
            }
        }

        function updateHeroStats() {
            document.getElementById('availableCount').textContent = State.products.length;
            document.getElementById('harvestedToday').textContent =
                State.products.filter(p => p.freshness === 'today').length;
        }

        function filterProducts() {
            renderProducts();
        }

        function quickAdd(productId) {
            const product = State.products.find(p => p.id === productId);
            if (!product) return;

            addToCart(product, 1);
            showToast(`${product.name} added to cart`, 'success');
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // COMING SOON
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        async function loadComingSoon() {
            try {
                const result = await api.get('getProductForecast', { weeks: 4 });
                if (result.success && result.data) {
                    State.comingSoon = result.data;
                    renderComingSoon();
                } else {
                    State.comingSoon = getDemoComingSoon();
                    renderComingSoon();
                }
            } catch (e) {
                State.comingSoon = getDemoComingSoon();
                renderComingSoon();
            }
        }

        function getDemoComingSoon() {
            return [
                { name: 'Heirloom Tomatoes', variety: 'Brandywine', emoji: 'ğŸ…', expectedDate: '2 weeks', confidence: 'High' },
                { name: 'Sweet Corn', variety: 'Honey & Cream', emoji: 'ğŸŒ½', expectedDate: '3 weeks', confidence: 'Medium' },
                { name: 'Zucchini', variety: 'Black Beauty', emoji: 'ğŸ¥’', expectedDate: '1 week', confidence: 'High' },
                { name: 'Dahlias', variety: 'Cafe au Lait', emoji: 'ğŸŒ¸', expectedDate: '4 weeks', confidence: 'Medium' }
            ];
        }

        function renderComingSoon() {
            const container = document.getElementById('comingSoonList');

            container.innerHTML = State.comingSoon.map(item => `
                <div class="coming-card">
                    <div class="coming-emoji">${item.emoji}</div>
                    <div class="coming-info">
                        <div class="coming-name">${item.name}</div>
                        <div class="coming-date">Expected: ${item.expectedDate} â€¢ ${item.confidence} confidence</div>
                    </div>
                    <button class="notify-btn" onclick="notifyWhenAvailable('${item.name}')">Notify Me</button>
                </div>
            `).join('');
        }

        function notifyWhenAvailable(productName) {
            showToast(`We'll notify you when ${productName} is available!`, 'success');
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // REORDER
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        async function loadLastOrder() {
            const card = document.getElementById('lastOrderCard');

            try {
                const result = await api.get('getChefOrderHistory', {
                    customerId: State.customer?.Customer_ID,
                    limit: 1
                });

                if (result.success && result.data && result.data.length > 0) {
                    State.lastOrder = result.data[0];
                    renderLastOrder();
                } else {
                    renderDemoLastOrder();
                }
            } catch (e) {
                renderDemoLastOrder();
            }
        }

        function renderDemoLastOrder() {
            State.lastOrder = {
                date: '2026-01-15',
                items: [
                    { name: 'Mixed Salad Greens', qty: 10, unit: 'lb' },
                    { name: 'Cherry Tomatoes', qty: 8, unit: 'pint' },
                    { name: 'Fresh Basil', qty: 5, unit: 'bunch' }
                ],
                total: 127.50
            };
            renderLastOrder();
        }

        function renderLastOrder() {
            const card = document.getElementById('lastOrderCard');
            const order = State.lastOrder;

            if (!order) {
                card.innerHTML = `
                    <div class="empty-state">
                        <p class="empty-text">No previous orders</p>
                    </div>
                `;
                return;
            }

            card.innerHTML = `
                <div class="last-order-header">
                    <span style="font-weight: 600;">Order from ${TinySeedUtils.formatDate(order.date)}</span>
                    <span class="last-order-date">${TinySeedUtils.formatCurrency(order.total)}</span>
                </div>
                <div class="last-order-items">
                    ${order.items.map(item => `
                        <div class="last-order-item">
                            <span>${item.name}</span>
                            <span>${item.qty} ${item.unit}</span>
                        </div>
                    `).join('')}
                </div>
                <button class="reorder-btn" onclick="reorderLast()">
                    <span>ğŸ”„</span> Reorder All
                </button>
            `;

            // Populate favorites
            State.favorites = order.items.slice(0, 4);
            renderFavorites();
        }

        function renderFavorites() {
            const grid = document.getElementById('favoritesGrid');

            const emojis = { 'Greens': 'ğŸ¥¬', 'Tomatoes': 'ğŸ…', 'Basil': 'ğŸŒ¿', 'Carrots': 'ğŸ¥•' };

            grid.innerHTML = State.favorites.map(item => {
                const emoji = Object.entries(emojis).find(([k]) => item.name.includes(k))?.[1] || 'ğŸ¥¬';
                return `
                    <div class="favorite-item" onclick="quickAddByName('${item.name}')">
                        <div class="favorite-emoji">${emoji}</div>
                        <div class="favorite-name">${item.name.split(' ')[0]}</div>
                    </div>
                `;
            }).join('');
        }

        function reorderLast() {
            if (!State.lastOrder) return;

            State.lastOrder.items.forEach(item => {
                const product = State.products.find(p => p.name === item.name);
                if (product) {
                    addToCart(product, item.qty);
                }
            });

            showToast('Last order added to cart!', 'success');
            toggleCart();
        }

        function quickAddByName(name) {
            const product = State.products.find(p => p.name.includes(name.split(' ')[0]));
            if (product) {
                quickAdd(product.id);
            }
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // STANDING ORDERS
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        async function loadStandingOrders() {
            try {
                const result = await api.get('getStandingOrders', {
                    customerId: State.customer?.Customer_ID
                });

                if (result.success && result.data) {
                    State.standingOrders = result.data;
                    renderStandingOrders();
                }
            } catch (e) {
                // Keep empty
            }
        }

        function renderStandingOrders() {
            const container = document.getElementById('standingOrdersList');

            if (State.standingOrders.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">ğŸ“¦</div>
                        <h3 class="empty-title">No Standing Orders</h3>
                        <p class="empty-text">Create a standing order to get your favorites automatically each week.</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = State.standingOrders.map(order => `
                <div class="standing-order-card">
                    <div class="standing-header">
                        <span style="font-weight: 600;">${order.name || 'Standing Order'}</span>
                        <span class="standing-frequency">${order.frequency}</span>
                    </div>
                    <div class="standing-items">${order.items.map(i => `${i.qty} ${i.unit} ${i.name}`).join(', ')}</div>
                    <div class="standing-actions">
                        <button class="standing-btn edit">Edit</button>
                        <button class="standing-btn pause">${order.status === 'PAUSED' ? 'Resume' : 'Pause'}</button>
                    </div>
                </div>
            `).join('');
        }

        function showCreateStandingOrder() {
            showToast('Coming soon: Create standing orders!', 'success');
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // CART
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        function addToCart(product, qty = 1) {
            const existing = State.cart.find(item => item.id === product.id);
            if (existing) {
                existing.qty += qty;
            } else {
                State.cart.push({ ...product, qty });
            }
            saveCart();
            updateCartUI();
        }

        function updateCartQty(productId, delta) {
            const item = State.cart.find(i => i.id === productId);
            if (!item) return;

            item.qty += delta;
            if (item.qty <= 0) {
                State.cart = State.cart.filter(i => i.id !== productId);
            }
            saveCart();
            updateCartUI();
        }

        function clearCart() {
            State.cart = [];
            saveCart();
            updateCartUI();
        }

        function saveCart() {
            localStorage.setItem('tsf_chef_cart', JSON.stringify(State.cart));
        }

        function loadCart() {
            const saved = localStorage.getItem('tsf_chef_cart');
            if (saved) {
                try {
                    State.cart = JSON.parse(saved);
                    updateCartUI();
                } catch (e) {
                    State.cart = [];
                }
            }
        }

        function updateCartUI() {
            const badge = document.getElementById('cartBadge');
            const count = State.cart.reduce((sum, item) => sum + item.qty, 0);

            badge.style.display = count > 0 ? 'flex' : 'none';
            badge.textContent = count;

            renderCartItems();
        }

        function renderCartItems() {
            const container = document.getElementById('cartItems');
            const footer = document.getElementById('cartFooter');

            if (State.cart.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">ğŸ›’</div>
                        <p class="empty-text">Your cart is empty</p>
                    </div>
                `;
                footer.style.display = 'none';
                return;
            }

            footer.style.display = 'block';

            const total = State.cart.reduce((sum, item) => sum + (item.price * item.qty), 0);
            document.getElementById('cartTotal').textContent = TinySeedUtils.formatCurrency(total);

            container.innerHTML = State.cart.map(item => `
                <div class="cart-item">
                    <div class="cart-item-emoji">${item.emoji || 'ğŸ¥¬'}</div>
                    <div class="cart-item-info">
                        <div class="cart-item-name">${item.name}</div>
                        <div class="cart-item-price">$${item.price.toFixed(2)} / ${item.unit}</div>
                    </div>
                    <div class="cart-item-qty">
                        <button class="qty-btn" onclick="updateCartQty('${item.id}', -1)">âˆ’</button>
                        <span class="qty-value">${item.qty}</span>
                        <button class="qty-btn" onclick="updateCartQty('${item.id}', 1)">+</button>
                    </div>
                </div>
            `).join('');
        }

        function toggleCart() {
            document.getElementById('cartOverlay').classList.toggle('open');
            document.getElementById('cartDrawer').classList.toggle('open');
        }

        function generateDeliveryDates() {
            const container = document.getElementById('deliveryOptions');
            const today = new Date();
            const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];

            let options = [];
            for (let i = 1; i <= 4; i++) {
                const date = new Date(today);
                date.setDate(today.getDate() + i);
                if (date.getDay() !== 0 && date.getDay() !== 6) { // Skip weekends
                    options.push({
                        day: days[date.getDay()],
                        date: date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }),
                        value: date.toISOString().split('T')[0]
                    });
                }
            }

            container.innerHTML = options.slice(0, 3).map((opt, idx) => `
                <div class="delivery-option ${idx === 0 ? 'selected' : ''}" onclick="selectDelivery(this, '${opt.value}')">
                    <div class="delivery-option-day">${opt.day}</div>
                    <div class="delivery-option-date">${opt.date}</div>
                </div>
            `).join('');

            State.deliveryDate = options[0]?.value;
        }

        function selectDelivery(el, value) {
            document.querySelectorAll('.delivery-option').forEach(o => o.classList.remove('selected'));
            el.classList.add('selected');
            State.deliveryDate = value;
        }

        async function submitOrder() {
            if (State.cart.length === 0) {
                showToast('Cart is empty', 'error');
                return;
            }

            const orderData = {
                customerId: State.customer?.Customer_ID,
                customerName: State.customer?.Company_Name,
                deliveryDate: State.deliveryDate,
                items: State.cart.map(item => ({
                    productId: item.id,
                    name: item.name,
                    qty: item.qty,
                    unit: item.unit,
                    price: item.price
                }))
            };

            try {
                const result = await api.post('submitWholesaleOrder', orderData);
                if (result.success) {
                    showToast('Order submitted! We\'ll confirm shortly.', 'success');
                    clearCart();
                    toggleCart();
                } else {
                    showToast(result.error || 'Failed to submit order', 'error');
                }
            } catch (e) {
                // Demo mode
                showToast('Order submitted! (Demo)', 'success');
                clearCart();
                toggleCart();
            }
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // EVENT LISTENERS
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        function setupEventListeners() {
            // Tabs
            document.querySelectorAll('.tab, .nav-item').forEach(el => {
                el.addEventListener('click', () => switchTab(el.dataset.tab));
            });

            // Filter pills
            document.querySelectorAll('.filter-pill').forEach(pill => {
                pill.addEventListener('click', () => {
                    document.querySelectorAll('.filter-pill').forEach(p => p.classList.remove('active'));
                    pill.classList.add('active');
                    State.currentCategory = pill.dataset.category;
                    renderProducts();
                });
            });

            // Search debounce
            document.getElementById('searchInput').addEventListener('input',
                TinySeedUtils.debounce(filterProducts, 300));
        }

        function togglePref(type) {
            const toggle = document.getElementById(type === 'sms' ? 'toggleSMS' : 'toggleEmail');
            toggle.classList.toggle('on');
            showToast(`${type.toUpperCase()} notifications ${toggle.classList.contains('on') ? 'enabled' : 'disabled'}`, 'success');
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // PWA
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        let deferredPrompt;

        function checkInstallPrompt() {
            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                deferredPrompt = e;
                setTimeout(() => {
                    document.getElementById('installBanner').classList.add('show');
                }, 3000);
            });
        }

        function installApp() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then(() => {
                    hideInstallBanner();
                    deferredPrompt = null;
                });
            }
        }

        function hideInstallBanner() {
            document.getElementById('installBanner').classList.remove('show');
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // UTILS
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        function showToast(message, type = '') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast ${type} show`;
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        function showProductDetail(productId) {
            // For now, just quick add
            quickAdd(productId);
        }
    </script>
</body>
</html>
